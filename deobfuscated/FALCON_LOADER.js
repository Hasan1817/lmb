/**
 * ü¶Ö FALCON PRO - Secure Loader
 * This loader fetches the main script securely and hides the source
 * 
 * Features:
 * - Loads main script from encrypted GitHub URL
 * - Hides source location from console/network tab
 * - Device fingerprint verification
 * - Single instance per device enforcement
 */

(async function() {
  'use strict';
  
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // üîê CONFIGURATION - Admin sets authorized fingerprints here
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  
  const CONFIG = {
    // GitHub raw URL (encoded to hide)
    SOURCE_KEY: 'Ly8gQ29uZmlndXJhdGlvbiAodXBkYXRlZCB3aXRoIHVzZXIgZGF0YSkKbGV0IGhpZ2hjb20gPSAiMSI7CmxldCBpdmFjX2lkID0gIjE3IjsKbGV0IHZpc2FfdHlwZSA9ICIxMyI7CmxldCB2aXNpdF9wdXJwb3NlID0gIkZvciBNZWRpY2FsIFRyZWF0bWVudC4iOwpsZXQgd2ViZmlsZV9pZCA9ICJCR0REVkExREEyMjUiOwpsZXQgZmFtaWx5X2NvdW50ID0gIjMiOwpsZXQgZmFtaWx5RGF0YSA9IFt7CiAgbmFtZTogIktBTEEgQ0hBRCIsCiAgd2ViZmlsZV9ubzogIkJHRERWQTFERTIyNSIKfSwgewogIG5hbWU6ICJNT1JKSU5BIiwKICB3ZWJmaWxlX25vOiAiQkdERFZBMURDODI1Igp9LCB7CiAgbmFtZTogIkpPUklOQSIsCiAgd2ViZmlsZV9ubzogIkJHRERWQURDODgyNSIKfV07Ci8vIExvYWQgdXNlciBjb25maWd1cmF0aW9uIGZyb20gbG9jYWxTdG9yYWdlIGlmIGF2YWlsYWJsZQpjb25zdCBzYXZlZENvbmZpZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpdmFjX3VzZXJfY29uZmlnIik7CmlmIChzYXZlZENvbmZpZykgewogIHRyeSB7CiAgICBjb25zdCBjb25maWcgPSBKU09OLnBhcnNlKHNhdmVkQ29uZmlnKTsKICAgIGhpZ2hjb20gPSBjb25maWcuaGlnaGNvbSB8fCBoaWdoY29tOwogICAgaXZhY19pZCA9IGNvbmZpZy5pdmFjX2lkIHx8IGl2YWNfaWQ7CiAgICB2aXNhX3R5cGUgPSBjb25maWcudmlzYV90eXBlIHx8IHZpc2FfdHlwZTsKICAgIHZpc2l0X3B1cnBvc2UgPSBjb25maWcudmlzaXRfcHVycG9zZSB8fCB2aXNpdF9wdXJwb3NlOwogICAgd2ViZmlsZV9pZCA9IGNvbmZpZy53ZWJmaWxlX2lkIHx8IHdlYmZpbGVfaWQ7CiAgICBmYW1pbHlfY291bnQgPSBjb25maWcuZmFtaWx5X2NvdW50IHx8IGZhbWlseV9jb3VudDsKICAgIGZhbWlseURhdGEgPSBjb25maWcuZmFtaWx5RGF0YSB8fCBmYW1pbHlEYXRhOwogICAgY29uc29sZS5sb2coIkxvYWRlZCBzYXZlZCBjb25maWd1cmF0aW9uIGZyb20gbG9jYWxTdG9yYWdlIik7CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5lcnJvcigiRXJyb3IgbG9hZGluZyBzYXZlZCBjb25maWd1cmF0aW9uOiIsIGUpOwogIH0KfQovLyBTaXRlIEtleXMgQ29uZmlndXJhdGlvbgovLyBFZGl0YWJsZSBFbmRwb2ludHMgQ29uZmlndXJhdGlvbgpjb25zdCBlbmRwb2ludHMgPSB7CiAgbG9naW46IHsKICAgIG1vYmlsZVZlcmlmeTogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tLyIsCiAgICBsb2dpbjogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tLyIsCiAgICBsb2dpbk90cDogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tLyIKICB9LAogIHBheW1lbnQ6IHsKICAgIGFwcGxpY2F0aW9uSW5mb1N1Ym1pdDogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIiwKICAgIHBlcnNvbmFsSW5mb1N1Ym1pdDogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIiwKICAgIG92ZXJ2aWV3U3VibWl0OiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgcGF5T3RwU2VudDogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIiwKICAgIHBheU90cFZlcmlmeTogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIiwKICAgIHBheVNsb3RUaW1lOiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgcGF5Tm93OiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgY2FwdGNoYUdlbmVyYXRlOiAiY2FwdGNoYS9nZW5lcmF0ZS1wYXkiLAogICAgY2FwdGNoYVZlcmlmeTogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIgogIH0KfTsKY29uc3QgbmV4dEFjdGlvbkNvbmZpZyA9IHsKICBtb2JpbGVWZXJpZnk6IHsKICAgIG5leHRBY3Rpb246ICI2MDJjNjBjOWUxOGIwYTNkYmJjZDBlZTU1ZjAxYzM4NWY4OGQwNjM4ZTAiLAogICAgcm91dGVyU3RhdGVUcmVlOiAiJTVCJTIyJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjIocm9vdCklMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMl9fUEFHRV9fJTIyJTJDJTdCJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCU1RCU3RCUyQ251bGwlMkNudWxsJTJDdHJ1ZSU1RCIsCiAgICB4QWN0aW9uUmV2YWxpZGF0ZWQ6ICJbW10sMCwwXSIKICB9LAogIGF1dGhlbnRpY2F0ZTogewogICAgbmV4dEFjdGlvbjogIjYwNzhjMTU5ZGVmZDcxNTEyNDk2ZTg5NGMwNDFlYzc2ZGMxOGZlMzA5YiIsCiAgICByb3V0ZXJTdGF0ZVRyZWU6ICIlNUIlMjIlMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMihyb290KSUyMiUyQyU3QiUyMmNoaWxkcmVuJTIyJTNBJTVCJTIyX19QQUdFX18lMjIlMkMlN0IlN0QlMkNudWxsJTJDbnVsbCU1RCU3RCUyQ251bGwlMkNudWxsJTVEJTdEJTJDbnVsbCUyQ251bGwlMkN0cnVlJTVEIiwKICAgIHhBY3Rpb25SZXZhbGlkYXRlZDogIltbXSwwLDBdIgogIH0sCiAgc3VibWl0T3RwOiB7CiAgICBuZXh0QWN0aW9uOiAiNjBhNWY1ZTk2ZmIyNjdmNzE4YzE3ZTk4ZWU4MjFlYWUwYzMzODE5NzdlIiwKICAgIHJvdXRlclN0YXRlVHJlZTogIiU1QiUyMiUyMiUyQyU3QiUyMmNoaWxkcmVuJTIyJTNBJTVCJTIyKHJvb3QpJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjJfX1BBR0VfXyUyMiUyQyU3QiU3RCUyQ251bGwlMkNudWxsJTVEJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCUyQ3RydWUlNUQiLAogICAgeEFjdGlvblJldmFsaWRhdGVkOiAiW1tdLDAsMF0iCiAgfSwKICBhcHBsaWNhdGlvbkluZm86IHsKICAgIG5leHRBY3Rpb246ICI3MDM3N2I2ZTA2YWMwYjliNGZmZTU1ZGJhZTZhNjQ3ODY3NTBjNjI0ODIiLAogICAgcm91dGVyU3RhdGVUcmVlOiAiJTVCJTIyJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjIocm9vdCklMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMmFwcGxpY2F0aW9uJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjJfX1BBR0VfXyUyMiUyQyU3QiU3RCUyQ251bGwlMkNudWxsJTVEJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCUyQ3RydWUlNUQiLAogICAgeEFjdGlvblJldmFsaWRhdGVkOiAiW1tdLDAsMF0iCiAgfSwKICBwZXJzb25hbEluZm86IHsKICAgIG5leHRBY3Rpb246ICI3MDY1OTdjZDVlOTgwMzAyMGQyYzY3YzJkNTQzMjM5NzViMTlmZmY5OTIiLAogICAgcm91dGVyU3RhdGVUcmVlOiAiJTVCJTIyJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjIocm9vdCklMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMmFwcGxpY2F0aW9uJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjJfX1BBR0VfXyUyMiUyQyU3QiU3RCUyQ251bGwlMkNudWxsJTVEJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCUyQ3RydWUlNUQiLAogICAgeEFjdGlvblJldmFsaWRhdGVkOiAiW1tdLDAsMF0iCiAgfSwKICBvdmVydmlld0luZm86IHsKICAgIG5leHRBY3Rpb246ICI2MDliZTg5NGMxMTY5OGE5ZmRjODhiOWM2ZjlmYTgyMTkxNmM3ZmI2NmQiLAogICAgcm91dGVyU3RhdGVUcmVlOiAiJTVCJTIyJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjIocm9vdCklMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMmFwcGxpY2F0aW9uJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjJfX1BBR0VfXyUyMiUyQyU3QiU3RCUyQ251bGwlMkNudWxsJTVEJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCUyQ3RydWUlNUQiLAogICAgeEFjdGlvblJldmFsaWRhdGVkOiAiW1tdLDAsMF0iCiAgfSwKICBzZW5kT3RwSW5mbzogewogICAgbmV4dEFjdGlvbjogIjYwZjE3ZmI4MDM4OTJmYjBiMzJlZGQ2YTg5NzA4MjBhYWVjY2FlYTJhMSIsCiAgICByb3V0ZXJTdGF0ZVRyZWU6ICIlNUIlMjIlMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMihyb290KSUyMiUyQyU3QiUyMmNoaWxkcmVuJTIyJTNBJTVCJTIyYXBwbGljYXRpb24lMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMl9fUEFHRV9fJTIyJTJDJTdCJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCU1RCU3RCUyQ251bGwlMkNudWxsJTJDdHJ1ZSU1RCIsCiAgICB4QWN0aW9uUmV2YWxpZGF0ZWQ6ICJbW10sMCwwXSIKICB9LAogIHZlcmlmeU90cEluZm86IHsKICAgIG5leHRBY3Rpb246ICI2MDdkZDA0NmNlNDEwNGEzMGRiY2RhZTVlZDAyYmRhZTcxNjBlMzk3NDUiLAogICAgcm91dGVyU3RhdGVUcmVlOiAiJTVCJTIyJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjIocm9vdCklMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMmFwcGxpY2F0aW9uJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjJfX1BBR0VfXyUyMiUyQyU3QiU3RCUyQ251bGwlMkNudWxsJTVEJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCUyQ3RydWUlNUQiLAogICAgeEFjdGlvblJldmFsaWRhdGVkOiAiW1tdLDAsMF0iCiAgfSwKICBnZXRTbG90SW5mbzogewogICAgbmV4dEFjdGlvbjogIjYwZmQxZTg3OGQ5NDdlY2ZmNzY4ZTNmYTVkMTA0OWQ1YmY0MmI2ZjU0OCIsCiAgICByb3V0ZXJTdGF0ZVRyZWU6ICIlNUIlMjIlMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMihyb290KSUyMiUyQyU3QiUyMmNoaWxkcmVuJTIyJTNBJTVCJTIyYXBwbGljYXRpb24lMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMl9fUEFHRV9fJTIyJTJDJTdCJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCU1RCU3RCUyQ251bGwlMkNudWxsJTJDdHJ1ZSU1RCIsCiAgICB4QWN0aW9uUmV2YWxpZGF0ZWQ6ICJbW10sMCwwXSIKICB9LAogIGNhcHRjaGFWZXJpZnlJbmZvOiB7CiAgICBuZXh0QWN0aW9uOiAiNzA2NDhkY2Q2MWRkODM1MzYzMDY1ODE0ZjAzMWQyNjAzNGNjMDI5ZGZhIiwKICAgIHJvdXRlclN0YXRlVHJlZTogIiU1QiUyMiUyMiUyQyU3QiUyMmNoaWxkcmVuJTIyJTNBJTVCJTIyKHJvb3QpJTIyJTJDJTdCJTIyY2hpbGRyZW4lMjIlM0ElNUIlMjJhcHBsaWNhdGlvbiUyMiUyQyU3QiUyMmNoaWxkcmVuJTIyJTNBJTVCJTIyX19QQUdFX18lMjIlMkMlN0IlN0QlMkNudWxsJTJDbnVsbCU1RCU3RCUyQ251bGwlMkNudWxsJTVEJTdEJTJDbnVsbCUyQ251bGwlMkN0cnVlJTVEIiwKICAgIHhBY3Rpb25SZXZhbGlkYXRlZDogIltbXSwwLDBdIgogIH0sCiAgcGF5Tm93SW5mbzogewogICAgbmV4dEFjdGlvbjogIjYwZTNiZjUwY2QzNjg0MTMyMjMwMWQ1YWU0ZjFmMWRmNTVkMGUyNmNkMiIsCiAgICByb3V0ZXJTdGF0ZVRyZWU6ICIlNUIlMjIlMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMihyb290KSUyMiUyQyU3QiUyMmNoaWxkcmVuJTIyJTNBJTVCJTIyYXBwbGljYXRpb24lMjIlMkMlN0IlMjJjaGlsZHJlbiUyMiUzQSU1QiUyMl9fUEFHRV9fJTIyJTJDJTdCJTdEJTJDbnVsbCUyQ251bGwlNUQlN0QlMkNudWxsJTJDbnVsbCU1RCU3RCUyQ251bGwlMkNudWxsJTJDdHJ1ZSU1RCIsCiAgICB4QWN0aW9uUmV2YWxpZGF0ZWQ6ICJbW10sMCwwXSIKICB9Cn07Ci8vIENhcHRjaGEgVG9rZW4gTmFtZXMgQ29uZmlndXJhdGlvbiAoRWRpdGFibGUgRGFpbHkpCmNvbnN0IGNhcHRjaGFUb2tlbk5hbWVzID0gewogIGFwcDogInk2ZTd1a190b2tlbl90NmQ4bjMiLAogIHBlcnNvbmFsOiAiY2FwdGNoYV90b2tlbl9wZXJzb25hbCIsCiAgc2VuZDogImNhcHRjaGFfdG9rZW5fc2VuZCIsCiAgdmVyaWZ5OiAiY2FwdGNoYV90b2tlbl92ZXJpZnkiLAogIGdldFNsb3Q6ICJjYXB0Y2hhX3Rva2VuX2dldHNsb3QiLAogIHBheU5vdzogIms1dDBnOF90b2tlbl95NHY5ZjYiCn07Ci8vIExvZ2luIFRhYiBDYXB0Y2hhIFRva2VuIE5hbWVzIENvbmZpZ3VyYXRpb24gKEVkaXRhYmxlIERhaWx5KQoKLy8gRGFpbHkgRWRpdGFibGUgUGF5bG9hZCBEYXRhIC0gU2ltcGxpZmllZCBmb3IgNCBNZW1iZXJzCmxldCBwYXlsb2FkRGF0YSA9IHsKICBhcHA6IHsKICAgIGhpZ2hjb206IGhpZ2hjb20sCiAgICBpdmFjX2lkOiBpdmFjX2lkLAogICAgdmlzYV90eXBlOiB2aXNhX3R5cGUsCiAgICBhc3dlb2lfZXJpbGZzOiB2aXNpdF9wdXJwb3NlLAogICAgd2ViZmlsZV9pZDogd2ViZmlsZV9pZCwKICAgIGZhbWlseV9jb3VudDogZmFtaWx5X2NvdW50LAogICAgd2ViZmlsZV9pZF9yZXBlYXQ6IHdlYmZpbGVfaWQKICB9LAogIHBlcnNvbmFsOiB7CiAgICBlbWFpbF9uYW1lOiAiIiwKICAgIC8vIFdpbGwgYmUgZmlsbGVkIGZyb20gbG9jYWxTdG9yYWdlCiAgICBmdWxsX25hbWU6ICIiLAogICAgLy8gV2lsbCBiZSBmaWxsZWQgZnJvbSBsb2NhbFN0b3JhZ2UKICAgIHBob25lOiAiIiwKICAgIC8vIFdpbGwgYmUgZmlsbGVkIGZyb20gbG9jYWxTdG9yYWdlCiAgICB3ZWJmaWxlX2lkOiB3ZWJmaWxlX2lkLAogICAgZmFtaWx5OiBbewogICAgICBuYW1lOiAiIiwKICAgICAgd2ViZmlsZV9ubzogIiIsCiAgICAgIGFnYWluX3dlYmZpbGVfbm86ICIiCiAgICB9LCB7CiAgICAgIG5hbWU6ICIiLAogICAgICB3ZWJmaWxlX25vOiAiIiwKICAgICAgYWdhaW5fd2ViZmlsZV9ubzogIiIKICAgIH0sIHsKICAgICAgbmFtZTogIiIsCiAgICAgIHdlYmZpbGVfbm86ICIiLAogICAgICBhZ2Fpbl93ZWJmaWxlX25vOiAiIgogICAgfSwgewogICAgICBuYW1lOiAiIiwKICAgICAgd2ViZmlsZV9ubzogIiIsCiAgICAgIGFnYWluX3dlYmZpbGVfbm86ICIiCiAgICB9XQogIH0sCiAgc2VuZDogewogICAgcmVzZW5kOiAiMCIKICB9LAogIHZlcmlmeTogewogICAgb3RwOiAiIiAvLyBXaWxsIGJlIGZpbGxlZCBmcm9tIGlucHV0CiAgfSwKICBnZXRTbG90OiB7CiAgICBhcHBvaW50bWVudF9kYXRlOiAiIiAvLyBXaWxsIGJlIGZpbGxlZCBmcm9tIGlucHV0CiAgfSwKICBwYXlOb3c6IHsKICAgIGFwcG9pbnRtZW50X2RhdGU6ICIiLAogICAgLy8gV2lsbCBiZSBmaWxsZWQgZnJvbSBpbnB1dAogICAgYXBwb2ludG1lbnRfdGltZTogIiIsCiAgICAvLyBXaWxsIGJlIGZpbGxlZCBmcm9tIGlucHV0CiAgICBzZWxlY3RlZF9wYXltZW50OiB7CiAgICAgIG5hbWU6ICJWSVNBIiwKICAgICAgc2x1ZzogInZpc2FjYXJkIiwKICAgICAgbGluazogImh0dHBzOi8vc2VjdXJlcGF5LnNzbGNvbW1lcnouY29tL2d3cHJvY2Vzcy92NC9pbWFnZS9ndzEvdmlzYS5wbmciCiAgICB9CiAgfQp9OwovLyBVcGRhdGUgZmFtaWx5IGRhdGEgaW4gcGF5bG9hZERhdGEgYmFzZWQgb24gbG9hZGVkIGNvbmZpZ3VyYXRpb24KY29uc3QgbmV3RmFtaWx5ID0gW107CmZvciAobGV0IGkgPSAwOyBpIDwgZmFtaWx5X2NvdW50OyBpKyspIHsKICBpZiAoaSA8IGZhbWlseURhdGEubGVuZ3RoKSB7CiAgICBuZXdGYW1pbHkucHVzaCh7CiAgICAgIG5hbWU6IGZhbWlseURhdGFbaV0ubmFtZSwKICAgICAgd2ViZmlsZV9ubzogZmFtaWx5RGF0YVtpXS53ZWJmaWxlX25vLAogICAgICBhZ2Fpbl93ZWJmaWxlX25vOiBmYW1pbHlEYXRhW2ldLndlYmZpbGVfbm8KICAgIH0pOwogIH0gZWxzZSB7CiAgICBuZXdGYW1pbHkucHVzaCh7CiAgICAgIG5hbWU6ICIiLAogICAgICB3ZWJmaWxlX25vOiAiIiwKICAgICAgYWdhaW5fd2ViZmlsZV9ubzogIiIKICAgIH0pOwogIH0KfQpwYXlsb2FkRGF0YS5wZXJzb25hbC5mYW1pbHkgPSBuZXdGYW1pbHk7Ci8vIEF1dG8gUiBhbmQgQXV0byBDIGJ1dHRvbnMgYXJlIGtlcHQgYnV0IGZ1bmN0aW9uYWxpdHkgaXMgcmVtb3ZlZAovLyBNQUlOIFNDUklQVCAtIERPIE5PVCBFRElUIEJFTE9XIFRISVMgTElORQovLyBNQUlOIFNDUklQVCAtIEF1dGhvcml6YXRpb24gcmVtb3ZlZCwgcnVucyBkaXJlY3RseQooZnVuY3Rpb24gKCkgewogICJ1c2Ugc3RyaWN0IjsKICBjb25zdCBtYWluU2NyaXB0ID0gKCkgPT4gewogICAgY29uc3QgY2Fwc29sdmVyQXBpS2V5ID0gIkNBUC02NTVBNjVCNUY3M0M5MzdFMDBGMjRGRjQ3OUU5Qjc0MTQ1QjA3NTNENTM4Rjk1MzVBNDY5QjBEQkQ2RjYyQjk4IjsKICAgIChmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh3aW5kb3cuX19NVF9ERUZBVUxUX0hFQURFUlNfUEFUQ0hFRF9fKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHdpbmRvdy5fX01UX0RFRkFVTFRfSEVBREVSU19QQVRDSEVEX18gPSB0cnVlOwogICAgICBjb25zdCB0ZW1wXzIgPSB3aW5kb3cuZmV0Y2ggPyB3aW5kb3cuZmV0Y2guYmluZCh3aW5kb3cpIDogbnVsbDsKICAgICAgaWYgKCF0ZW1wXzIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZnVuY3Rpb24gY2xvbmVIZWFkZXJzKGluc3RhbmNlXzUpIHsKICAgICAgICBpZiAoaW5zdGFuY2VfNSBpbnN0YW5jZW9mIEhlYWRlcnMpIHsKICAgICAgICAgIHJldHVybiBuZXcgSGVhZGVycyhpbnN0YW5jZV81KTsKICAgICAgICB9CiAgICAgICAgY29uc3QgaGVhZGVyc18xID0gbmV3IEhlYWRlcnMoKTsKICAgICAgICBpZiAoaW5zdGFuY2VfNSAmJiB0eXBlb2YgaW5zdGFuY2VfNSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIE9iamVjdC5rZXlzKGluc3RhbmNlXzUpLmZvckVhY2goaXRlbV8xID0-IGhlYWRlcnNfMS5zZXQoaXRlbV8xLCBpbnN0YW5jZV81W2l0ZW1fMV0pKTsKICAgICAgICAgIH0gY2F0Y2ggKHZhcl82KSB7fQogICAgICAgIH0KICAgICAgICByZXR1cm4gaGVhZGVyc18xOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIHBhdGNoRmV0Y2hSZXF1ZXN0KGluc3RhbmNlXzcsIHZhcl84KSB7CiAgICAgICAgbGV0IHVybF8yID0gaW5zdGFuY2VfNzsKICAgICAgICBsZXQgaGVhZGVyc18yID0gdmFyXzggPyBPYmplY3QuYXNzaWduKHt9LCB2YXJfOCkgOiB7fTsKICAgICAgICBsZXQgaGVhZGVyc18zOwogICAgICAgIGlmIChpbnN0YW5jZV83IGluc3RhbmNlb2YgUmVxdWVzdCkgewogICAgICAgICAgdXJsXzIgPSBpbnN0YW5jZV83LnVybDsKICAgICAgICAgIGhlYWRlcnNfMyA9IG5ldyBIZWFkZXJzKGluc3RhbmNlXzcuaGVhZGVycyk7CiAgICAgICAgICBjb25zdCBoZWFkZXJzXzQgPSBjbG9uZUhlYWRlcnMoaGVhZGVyc18yLmhlYWRlcnMpOwogICAgICAgICAgaGVhZGVyc180LmZvckVhY2goKGl0ZW1fMiwgYXJyYXlJdGVtXzkpID0-IGhlYWRlcnNfMy5zZXQoYXJyYXlJdGVtXzksIGl0ZW1fMikpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoZWFkZXJzXzMgPSBjbG9uZUhlYWRlcnMoaGVhZGVyc18yLmhlYWRlcnMpOwogICAgICAgIH0KICAgICAgICBsZXQgdXJsXzM7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHVybF8zID0gbmV3IFVSTCh1cmxfMiwgbG9jYXRpb24uaHJlZik7CiAgICAgICAgfSBjYXRjaCAodmFyXzEwKSB7CiAgICAgICAgICB1cmxfMyA9IG51bGw7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMyA9IHVybF8zID8gdXJsXzMub3JpZ2luID09PSBsb2NhdGlvbi5vcmlnaW4gOiB0cnVlOwogICAgICAgIGNvbnN0IHRlbXBfNCA9IHVybF8zID8gLyhefFwuKWNhcHNvbHZlclwuY29tJC9pLnRlc3QodXJsXzMuaG9zdG5hbWUpIDogZmFsc2U7CiAgICAgICAgaWYgKHRlbXBfNCkgewogICAgICAgICAgaWYgKGhlYWRlcnNfMy5oYXMoImxhbmd1YWdlIikpIHsKICAgICAgICAgICAgaGVhZGVyc18zLmRlbGV0ZSgibGFuZ3VhZ2UiKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRlbXBfMykgewogICAgICAgICAgaGVhZGVyc18zLnNldCgibGFuZ3VhZ2UiLCAiZW4iKTsKICAgICAgICB9CiAgICAgICAgaWYgKCFoZWFkZXJzXzMuaGFzKCJhY2NlcHQiKSkgewogICAgICAgICAgaGVhZGVyc18zLnNldCgiYWNjZXB0IiwgImFwcGxpY2F0aW9uL2pzb24iKTsKICAgICAgICB9CiAgICAgICAgY29uc3QgdGVtcF81ID0gKGhlYWRlcnNfMi5tZXRob2QgfHwgKGluc3RhbmNlXzcgaW5zdGFuY2VvZiBSZXF1ZXN0ID8gaW5zdGFuY2VfNy5tZXRob2QgOiAiR0VUIikpLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgY29uc3QgdGV4dF82ID0gaGVhZGVyc18yLmJvZHkgIT0gbnVsbCB8fCBpbnN0YW5jZV83IGluc3RhbmNlb2YgUmVxdWVzdCAmJiBpbnN0YW5jZV83LmJvZHkgIT0gbnVsbDsKICAgICAgICBsZXQgdGV4dF83ID0gZmFsc2U7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRleHRfNyA9IHRleHRfNiAmJiB0eXBlb2YgaGVhZGVyc18yLmJvZHkgPT09ICJzdHJpbmciICYmIC9eW1xzXSpbe1tdLy50ZXN0KGhlYWRlcnNfMi5ib2R5KTsKICAgICAgICB9IGNhdGNoICh2YXJfMTEpIHt9CiAgICAgICAgaWYgKCFoZWFkZXJzXzMuaGFzKCJjb250ZW50LXR5cGUiKSAmJiAodGV4dF83IHx8IFsiUE9TVCIsICJQVVQiLCAiUEFUQ0giLCAiREVMRVRFIl0uaW5jbHVkZXModGVtcF81KSkpIHsKICAgICAgICAgIGhlYWRlcnNfMy5zZXQoImNvbnRlbnQtdHlwZSIsICJhcHBsaWNhdGlvbi9qc29uIik7CiAgICAgICAgfQogICAgICAgIGlmICh0ZW1wXzQgJiYgaGVhZGVyc18zLmhhcygiYXV0aG9yaXphdGlvbiIpKSB7CiAgICAgICAgICBoZWFkZXJzXzMuZGVsZXRlKCJhdXRob3JpemF0aW9uIik7CiAgICAgICAgfQogICAgICAgIGlmICh0ZW1wXzMgJiYgIXRlbXBfNCAmJiAhaGVhZGVyc18zLmhhcygiYXV0aG9yaXphdGlvbiIpKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCB0b2tlbl8xID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImFjY2Vzc190b2tlbiIpOwogICAgICAgICAgICBpZiAodG9rZW5fMSkgewogICAgICAgICAgICAgIGhlYWRlcnNfMy5zZXQoImF1dGhvcml6YXRpb24iLCAiQmVhcmVyICIgKyB0b2tlbl8xKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAodmFyXzEyKSB7fQogICAgICAgIH0KICAgICAgICBpZiAodGVtcF8zICYmICF0ZW1wXzQgJiYgdXJsXzMgJiYgdXJsXzMucGF0aG5hbWUuaW5jbHVkZXMoIi9hcHBsaWNhdGlvbiIpKSB7CiAgICAgICAgICBoZWFkZXJzXzMuc2V0KCJyZWZlcmVyIiwgImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIik7CiAgICAgICAgfQogICAgICAgIGhlYWRlcnNfMi5oZWFkZXJzID0gaGVhZGVyc18zOwogICAgICAgIHJldHVybiBbdXJsXzIsIGhlYWRlcnNfMl07CiAgICAgIH0KICAgICAgd2luZG93LmZldGNoID0gZnVuY3Rpb24gKHBhcmFtXzUsIHBhcmFtXzYpIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgdGVtcF82ID0gcGF0Y2hGZXRjaFJlcXVlc3QocGFyYW1fNSwgcGFyYW1fNik7CiAgICAgICAgICByZXR1cm4gdGVtcF8yKHRlbXBfNlswXSwgdGVtcF82WzFdKTsKICAgICAgICB9IGNhdGNoICh2YXJfMTMpIHsKICAgICAgICAgIHJldHVybiB0ZW1wXzIocGFyYW1fNSwgcGFyYW1fNik7CiAgICAgICAgfQogICAgICB9OwogICAgfSkoKTsKICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVsdGktdG9vbHMtY29udGFpbmVyIikpIHsKICAgICAgY29uc29sZS5sb2coIldpZGdldCBhbHJlYWR5IGV4aXN0cywgc2tpcHBpbmcgaW5pdGlhbGl6YXRpb24uIik7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IGluaXRpYWxpemVXaWRnZXQgPSAoKSA9PiB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXVsdGktdG9vbHMtY29udGFpbmVyIikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IGVkaXRlZERhdGEgPSB7CiAgICAgICAgYXBwOiBudWxsLAogICAgICAgIHBlcnNvbmFsOiBudWxsLAogICAgICAgIG92ZXJ2aWV3OiBudWxsLAogICAgICAgIHNlbmQ6IG51bGwsCiAgICAgICAgdmVyaWZ5OiBudWxsLAogICAgICAgIG1vYmlsZTogbnVsbCwKICAgICAgICBwYXNzd29yZDogbnVsbCwKICAgICAgICBvdHA6IG51bGwsCiAgICAgICAgcGF5bm93OiBudWxsLAogICAgICAgIHBheW5vd2J1dHRvbjogbnVsbAogICAgICB9OwogICAgICBsZXQgZWRpdGVkRW5kcG9pbnRzID0ge307CiAgICAgIGxldCBlZGl0ZWRDYXB0Y2hhVG9rZW5OYW1lcyA9IHt9OwogICAgICBmdW5jdGlvbiBsb2FkRWRpdGVkRGF0YUZyb21TdG9yYWdlKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBkYXRhXzIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaXZhY19lZGl0ZWRfZGF0YSIpOwogICAgICAgICAgaWYgKGRhdGFfMikgewogICAgICAgICAgICBlZGl0ZWREYXRhID0gSlNPTi5wYXJzZShkYXRhXzIpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiTG9hZGVkIGVkaXRlZCBkYXRhIGZyb20gbG9jYWxTdG9yYWdlOiIsIGVkaXRlZERhdGEpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKHZhcl8xNCkgewogICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgbG9hZGluZyBlZGl0ZWQgZGF0YSBmcm9tIGxvY2FsU3RvcmFnZToiLCB2YXJfMTQpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBsb2FkRWRpdGVkRW5kcG9pbnRzRnJvbVN0b3JhZ2UoKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHRlbXBfNyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpdmFjX2VkaXRlZF9lbmRwb2ludHMiKTsKICAgICAgICAgIGlmICh0ZW1wXzcpIHsKICAgICAgICAgICAgZWRpdGVkRW5kcG9pbnRzID0gSlNPTi5wYXJzZSh0ZW1wXzcpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiTG9hZGVkIGVkaXRlZCBlbmRwb2ludHMgZnJvbSBsb2NhbFN0b3JhZ2U6IiwgZWRpdGVkRW5kcG9pbnRzKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoICh2YXJfMTUpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGxvYWRpbmcgZWRpdGVkIGVuZHBvaW50cyBmcm9tIGxvY2FsU3RvcmFnZToiLCB2YXJfMTUpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBsb2FkRWRpdGVkQ2FwdGNoYVRva2Vuc0Zyb21TdG9yYWdlKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCB0b2tlbl8yID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oIml2YWNfZWRpdGVkX2NhcHRjaGFfdG9rZW5fbmFtZXMiKTsKICAgICAgICAgIGlmICh0b2tlbl8yKSB7CiAgICAgICAgICAgIGVkaXRlZENhcHRjaGFUb2tlbk5hbWVzID0gSlNPTi5wYXJzZSh0b2tlbl8yKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIkxvYWRlZCBlZGl0ZWQgY2FwdGNoYSB0b2tlbiBuYW1lcyBmcm9tIGxvY2FsU3RvcmFnZToiLCBlZGl0ZWRDYXB0Y2hhVG9rZW5OYW1lcyk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAodmFyXzE2KSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBsb2FkaW5nIGVkaXRlZCBjYXB0Y2hhIHRva2VuIG5hbWVzIGZyb20gbG9jYWxTdG9yYWdlOiIsIHZhcl8xNik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGxvYWRFZGl0ZWREYXRhRnJvbVN0b3JhZ2UoKTsKICAgICAgbG9hZEVkaXRlZEVuZHBvaW50c0Zyb21TdG9yYWdlKCk7CiAgICAgIGxvYWRFZGl0ZWRDYXB0Y2hhVG9rZW5zRnJvbVN0b3JhZ2UoKTsKICAgICAgZnVuY3Rpb24gcmVzdG9yZUFwcGxpY2F0aW9uU3RhdGUoKSB7CiAgICAgICAgY29uc3QgdG9rZW5fMyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhY2Nlc3NfdG9rZW4iKTsKICAgICAgICBjb25zdCBzdGVwXzEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiYXV0aFN0ZXAiKTsKICAgICAgICBjb25zdCBzdGVwXzIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiYWN0aXZlU3RlcCIpOwogICAgICAgIGlmICh0b2tlbl8zICYmIHN0ZXBfMSA9PT0gIjEwMCIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXN0b3JpbmcgYXBwbGljYXRpb24gc3RhdGUgLSBVc2VyIGlzIGF1dGhlbnRpY2F0ZWQiKTsKICAgICAgICAgIGlmIChzdGVwXzIgPT09ICIxIikgewogICAgICAgICAgICBjb25zb2xlLmxvZygiQ3VycmVudCBzdGVwOiBBcHBsaWNhdGlvbiBJbmZvIik7CiAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXBfMiA9PT0gIjIiKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDdXJyZW50IHN0ZXA6IFBlcnNvbmFsIEluZm8iKTsKICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcF8yID09PSAiMyIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkN1cnJlbnQgc3RlcDogT3ZlcnZpZXciKTsKICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcF8yID09PSAiNCIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkN1cnJlbnQgc3RlcDogUGF5bWVudCIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXN0b3JlQXBwbGljYXRpb25TdGF0ZSgpOwogICAgICBsZXQgYXBpQmFzZVVybCA9ICJodHRwczovL3BheW1lbnQuaXZhY2JkLmNvbS9hcGkvdjIvIjsKICAgICAgY29uc3QgbG9naW5TaXRlS2V5ID0gIjB4NEFBQUFBQUJwTlVwelllcHBCb1lwZSI7CiAgICAgIGNvbnN0IGFwcGxpY2F0aW9uU2l0ZUtleSA9ICIweDRBQUFBQUFCdlEzTWk2Umt0Q3VaN1AiOwogICAgICBmdW5jdGlvbiBnZXRTaXRlS2V5KG9iaktleV8xNykgewogICAgICAgIGlmIChvYmpLZXlfMTcgPT09ICJsb2dpbiIpIHsKICAgICAgICAgIHJldHVybiBsb2dpblNpdGVLZXk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBhcHBsaWNhdGlvblNpdGVLZXk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGxldCBjdXJyZW50QXBpS2V5ID0gbnVsbDsKICAgICAgbGV0IGNhcHRjaGFTdGF0ZSA9IHsKICAgICAgICBzb2x2ZWQ6IGZhbHNlLAogICAgICAgIHRva2VuOiAiIiwKICAgICAgICB3aWRnZXQ6IG51bGwsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgYXV0b0NoZWNrSW50ZXJ2YWw6IG51bGwsCiAgICAgICAgaGlkZVRpbWVvdXQ6IG51bGwsCiAgICAgICAgaXNQYWdlQ2FwdGNoYTogZmFsc2UsCiAgICAgICAgbW9uaXRvckludGVydmFsOiBudWxsLAogICAgICAgIHNvbHZpbmc6IGZhbHNlLAogICAgICAgIHNvbHV0aW9uOiBudWxsLAogICAgICAgIGNmVG9rZW46ICIiLAogICAgICAgIGNmcFRva2VuOiAiIiwKICAgICAgICBpbWFnZURhdGE6ICIiCiAgICAgIH07CiAgICAgIGxldCBwZW5kaW5nT3BlcmF0aW9ucyA9IFtdOwogICAgICBsZXQgbG9naW5DYXB0Y2hhV2lkZ2V0ID0gbnVsbDsKICAgICAgbGV0IGJnZENhcHRjaGFXaWRnZXQgPSBudWxsOwogICAgICBsZXQgcGF5Q2FwdGNoYVdpZGdldCA9IG51bGw7CiAgICAgIGxldCBtYXRoQ2FwdGNoYVdpZGdldCA9IG51bGw7CiAgICAgIGxldCB0ZXh0Q2FwdGNoYVdpZGdldCA9IG51bGw7CiAgICAgIGxldCBpc0luaXRpYWxpemVkID0gZmFsc2U7CiAgICAgIGxldCBjdXJyZW50Q2FwdGNoYVR5cGUgPSBudWxsOwogICAgICBsZXQgaXNDYXB0Y2hhU29sdmluZyA9IGZhbHNlOwogICAgICBsZXQgY2FwdGNoYVRhc2tTdGF0ZSA9IHsKICAgICAgICBzdG9wUmVxdWVzdGVkOiBmYWxzZSwKICAgICAgICBwb3B1cENsb3NlZDogZmFsc2UsCiAgICAgICAgY3VycmVudFRhc2tJZDogbnVsbAogICAgICB9OwogICAgICBsZXQgcmVmcmVzaFRpbWVycyA9IHsKICAgICAgICByZWZyZXNoSW50ZXJ2YWw6IG51bGwsCiAgICAgICAgY29udGludWVUaW1lb3V0OiBudWxsCiAgICAgIH07CiAgICAgIGxldCBjdXJyZW50Q2FwdGNoYUNvbnRhaW5lciA9IG51bGw7CiAgICAgIGxldCBjYXB0Y2hhU29sdXRpb25DYWxsYmFjayA9IG51bGw7CiAgICAgIGxldCByZXRyeUNvdW50ID0gMDsKICAgICAgbGV0IGxhc3RSZXF1ZXN0VGltZSA9IG51bGw7CiAgICAgIGxldCBjYXB0Y2hhUHJvdmlkZXJDb25maWcgPSB7CiAgICAgICAgbG9naW46IHsKICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLAogICAgICAgICAgdG9rZW46ICIiCiAgICAgICAgfSwKICAgICAgICBiZ2Q6IHsKICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLAogICAgICAgICAgdG9rZW46ICIiCiAgICAgICAgfSwKICAgICAgICBwYXk6IHsKICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLAogICAgICAgICAgdG9rZW46ICIiCiAgICAgICAgfQogICAgICB9OwogICAgICBsZXQgY3VycmVudFRhYiA9ICJsb2dpbiI7CiAgICAgIGNvbnN0IGxvZ2luQmdkUmV0cnlDb25maWcgPSB7CiAgICAgICAgc3RhdHVzZXM6IFs1MDAsIDUwMiwgNTA0XSwKICAgICAgICBtaW5TZWNvbmRzOiAxMCwKICAgICAgICBtYXhTZWNvbmRzOiAxMywKICAgICAgICByZWFzb246IHBhcmFtXzcgPT4gIkhUVFAgIiArIHBhcmFtXzcgKyAiIChMb2dpbi9CR0QpIgogICAgICB9OwogICAgICBjb25zdCBzZW5kVmVyaWZ5UmV0cnlDb25maWcgPSB7CiAgICAgICAgc3RhdHVzZXM6IFs1MDAsIDUwMiwgNTA0XSwKICAgICAgICBtaW5TZWNvbmRzOiA4LAogICAgICAgIG1heFNlY29uZHM6IDEyLAogICAgICAgIHJlYXNvbjogcGFyYW1fOCA9PiAiSFRUUCAiICsgcGFyYW1fOCArICIgKFNlbmQvVmVyaWZ5KSIKICAgICAgfTsKICAgICAgY29uc3QgZ2V0U2xvdFJldHJ5Q29uZmlnID0gewogICAgICAgIHN0YXR1c2VzOiBbNTAwLCA1MDIsIDUwNF0sCiAgICAgICAgbWluU2Vjb25kczogNywKICAgICAgICBtYXhTZWNvbmRzOiAxMCwKICAgICAgICByZWFzb246IHBhcmFtXzkgPT4gIkhUVFAgIiArIHBhcmFtXzkgKyAiIChHZXQgU2xvdCkiCiAgICAgIH07CiAgICAgIGNvbnN0IHBheU5vd1JldHJ5Q29uZmlnID0gewogICAgICAgIHN0YXR1c2VzOiBbNTAwLCA1MDIsIDUwNF0sCiAgICAgICAgbWluU2Vjb25kczogMTAsCiAgICAgICAgbWF4U2Vjb25kczogMTQsCiAgICAgICAgcmVhc29uOiBwYXJhbV8xMCA9PiAiSFRUUCAiICsgcGFyYW1fMTAgKyAiIChQYXkgTm93KSIKICAgICAgfTsKICAgICAgY29uc3Qgb3BlcmF0aW9uUmV0cnlSdWxlcyA9IFt7CiAgICAgICAgbmFtZTogImxvZ2luQmdkIiwKICAgICAgICBvcGVyYXRpb25zOiBuZXcgU2V0KFsibG9naW4tbW9iaWxlIiwgImxvZ2luLWF1dGhlbnRpY2F0ZSIsICJsb2dpbi1zdWJtaXQtb3RwIiwgImJnZC1hcHAiLCAiYmdkLXBlcnNvbmFsIiwgImJnZC1vdmVydmlldyJdKSwKICAgICAgICBydWxlczogW2xvZ2luQmdkUmV0cnlDb25maWddCiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAic2VuZFZlcmlmaWNhdGlvbiIsCiAgICAgICAgb3BlcmF0aW9uczogbmV3IFNldChbInBheS1zZW5kIiwgInBheS1yZXNlbmQiLCAicGF5LXZlcmlmeSIsICJwYXktY2FwdGNoYS12ZXJpZnkiXSksCiAgICAgICAgcnVsZXM6IFtzZW5kVmVyaWZ5UmV0cnlDb25maWddCiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAicGF5R2V0U2xvdCIsCiAgICAgICAgb3BlcmF0aW9uczogbmV3IFNldChbInBheS1nZXQtc2xvdCJdKSwKICAgICAgICBydWxlczogW2dldFNsb3RSZXRyeUNvbmZpZ10KICAgICAgfSwgewogICAgICAgIG5hbWU6ICJwYXlOb3ciLAogICAgICAgIG9wZXJhdGlvbnM6IG5ldyBTZXQoWyJwYXktbm93Il0pLAogICAgICAgIHJ1bGVzOiBbcGF5Tm93UmV0cnlDb25maWddCiAgICAgIH1dOwogICAgICBsZXQgYXV0b1JldHJ5U3RhdGUgPSB7CiAgICAgICAgZW5hYmxlZDogZmFsc2UsCiAgICAgICAgdGltZXJzOiBuZXcgTWFwKCksCiAgICAgICAgY291bnRkb3duSW50ZXJ2YWxzOiBuZXcgTWFwKCkKICAgICAgfTsKICAgICAgZnVuY3Rpb24gY2xlYXJBbGxBdXRvUmV0cnlUaW1lcnMoKSB7CiAgICAgICAgYXV0b1JldHJ5U3RhdGUudGltZXJzLmZvckVhY2goaXRlbV8zID0-IGNsZWFyVGltZW91dChpdGVtXzMpKTsKICAgICAgICBhdXRvUmV0cnlTdGF0ZS50aW1lcnMuY2xlYXIoKTsKICAgICAgICBhdXRvUmV0cnlTdGF0ZS5jb3VudGRvd25JbnRlcnZhbHMuZm9yRWFjaChpdGVtXzQgPT4gY2xlYXJJbnRlcnZhbChpdGVtXzQpKTsKICAgICAgICBhdXRvUmV0cnlTdGF0ZS5jb3VudGRvd25JbnRlcnZhbHMuY2xlYXIoKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBzZXRBdXRvUmV0cnlFbmFibGVkKG1lc3NhZ2VfMTgsIG1lc3NhZ2VfMTkgPSAiIikgewogICAgICAgIGlmIChhdXRvUmV0cnlTdGF0ZS5lbmFibGVkID09PSBtZXNzYWdlXzE4KSB7CiAgICAgICAgICBpZiAobWVzc2FnZV8xOSkgewogICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZShtZXNzYWdlXzE5LCBtZXNzYWdlXzE4ID8gIiMwMEZGMDAiIDogIiNmZjk4MDAiKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCA9IG1lc3NhZ2VfMTg7CiAgICAgICAgY29uc3QgZWxlbWVudF80ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdsb2JhbC1hdXRvLXItYnRuIik7CiAgICAgICAgaWYgKGVsZW1lbnRfNCkgewogICAgICAgICAgZWxlbWVudF80LnRleHRDb250ZW50ID0gbWVzc2FnZV8xOCA_ICJBdXRvIChPTikiIDogIkF1dG8iOwogICAgICAgICAgZWxlbWVudF80LnN0eWxlLmJveFNoYWRvdyA9IG1lc3NhZ2VfMTggPyAiMCAwIDEwcHggcmdiYSg3NiwgMTc1LCA4MCwgMC42KSIgOiAiIjsKICAgICAgICAgIGVsZW1lbnRfNC5zdHlsZS5vcGFjaXR5ID0gbWVzc2FnZV8xOCA_ICIxIiA6ICIwLjg1IjsKICAgICAgICB9CiAgICAgICAgaWYgKCFtZXNzYWdlXzE4KSB7CiAgICAgICAgICBjbGVhckFsbEF1dG9SZXRyeVRpbWVycygpOwogICAgICAgIH0KICAgICAgICBpZiAobWVzc2FnZV8xOSkgewogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UobWVzc2FnZV8xOSwgbWVzc2FnZV8xOCA_ICIjMDBGRjAwIiA6ICIjZmY5ODAwIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKG1lc3NhZ2VfMTggPyAiQXV0byByZXRyeSBlbmFibGVkIiA6ICJBdXRvIHJldHJ5IGRpc2FibGVkIiwgbWVzc2FnZV8xOCA_ICIjMDBGRjAwIiA6ICIjZmY5ODAwIik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIGdldFJhbmRvbURlbGF5TXMobWF0aFJlc3VsdF8yMCwgbWF0aFJlc3VsdF8yMSkgewogICAgICAgIGNvbnN0IHRlbXBfOCA9IE1hdGguY2VpbChtYXRoUmVzdWx0XzIwKTsKICAgICAgICBjb25zdCB0ZW1wXzkgPSBNYXRoLmZsb29yKG1hdGhSZXN1bHRfMjEpOwogICAgICAgIGNvbnN0IHRlbXBfMTAgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAodGVtcF85IC0gdGVtcF84ICsgMSkpICsgdGVtcF84OwogICAgICAgIHJldHVybiB0ZW1wXzEwICogMTAwMDsKICAgICAgfQogICAgICBmdW5jdGlvbiBzY2hlZHVsZUF1dG9SZXRyeShkYXRldGltZV8yMiwgbWF0aFJlc3VsdF8yMywgdmFyXzI0LCB2YXJfMjUpIHsKICAgICAgICBpZiAodHlwZW9mIHZhcl8yNCAhPT0gImZ1bmN0aW9uIikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoYXV0b1JldHJ5U3RhdGUudGltZXJzLmhhcyhkYXRldGltZV8yMikpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChhdXRvUmV0cnlTdGF0ZS50aW1lcnMuZ2V0KGRhdGV0aW1lXzIyKSk7CiAgICAgICAgfQogICAgICAgIGlmIChhdXRvUmV0cnlTdGF0ZS5jb3VudGRvd25JbnRlcnZhbHMuaGFzKGRhdGV0aW1lXzIyKSkgewogICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvUmV0cnlTdGF0ZS5jb3VudGRvd25JbnRlcnZhbHMuZ2V0KGRhdGV0aW1lXzIyKSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMTEgPSBNYXRoLnJvdW5kKG1hdGhSZXN1bHRfMjMgLyAxMDAwKTsKICAgICAgICBsZXQgdGVtcF8xMiA9IHRlbXBfMTE7CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlJldHJ5aW5nIGluICIgKyB0ZW1wXzEyICsgIiBTZWMiLCAiI0ZGRDcwMCIpOwogICAgICAgIGNvbnN0IHRpbWVyXzEgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICB0ZW1wXzEyLS07CiAgICAgICAgICBpZiAodGVtcF8xMiA-IDApIHsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlJldHJ5aW5nIGluICIgKyB0ZW1wXzEyICsgIiBTZWMiLCAiI0ZGRDcwMCIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcl8xKTsKICAgICAgICAgICAgYXV0b1JldHJ5U3RhdGUuY291bnRkb3duSW50ZXJ2YWxzLmRlbGV0ZShkYXRldGltZV8yMik7CiAgICAgICAgICB9CiAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgYXV0b1JldHJ5U3RhdGUuY291bnRkb3duSW50ZXJ2YWxzLnNldChkYXRldGltZV8yMiwgdGltZXJfMSk7CiAgICAgICAgY29uc3QgdGltZXJfMiA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgYXV0b1JldHJ5U3RhdGUudGltZXJzLmRlbGV0ZShkYXRldGltZV8yMik7CiAgICAgICAgICBpZiAoYXV0b1JldHJ5U3RhdGUuY291bnRkb3duSW50ZXJ2YWxzLmhhcyhkYXRldGltZV8yMikpIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvUmV0cnlTdGF0ZS5jb3VudGRvd25JbnRlcnZhbHMuZ2V0KGRhdGV0aW1lXzIyKSk7CiAgICAgICAgICAgIGF1dG9SZXRyeVN0YXRlLmNvdW50ZG93bkludGVydmFscy5kZWxldGUoZGF0ZXRpbWVfMjIpOwogICAgICAgICAgfQogICAgICAgICAgdmFyXzI0KCk7CiAgICAgICAgfSwgbWF0aFJlc3VsdF8yMyk7CiAgICAgICAgYXV0b1JldHJ5U3RhdGUudGltZXJzLnNldChkYXRldGltZV8yMiwgdGltZXJfMik7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZ2V0UmV0cnlSdWxlc0Zvck9wZXJhdGlvbih2YXJfMjYsIHZhcl8yNywgdmFyXzI4KSB7CiAgICAgICAgaWYgKHZhcl8yNyA9PT0gNDAzKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBkaXNhYmxlQXV0bzogdHJ1ZSwKICAgICAgICAgICAgcmVhc29uOiAiQXV0byByZXRyeSBkaXNhYmxlZCBhZnRlciBIVFRQIDQwMyIKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGlmICh2YXJfMjcgPT09IDQyOSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbWluU2Vjb25kczogMzAsCiAgICAgICAgICAgIG1heFNlY29uZHM6IDMwLAogICAgICAgICAgICByZWFzb246ICJIVFRQIDQyOSIKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGlmICh2YXJfMjgpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG1pblNlY29uZHM6IDMsCiAgICAgICAgICAgIG1heFNlY29uZHM6IDYsCiAgICAgICAgICAgIHJlYXNvbjogIk5ldHdvcmsgZmFpbHVyZSIKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlb2YgdmFyXzI3ICE9PSAibnVtYmVyIikgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGZvciAoY29uc3QgdGVtcF8xMyBvZiBvcGVyYXRpb25SZXRyeVJ1bGVzKSB7CiAgICAgICAgICBpZiAoIXRlbXBfMTMub3BlcmF0aW9ucy5oYXModmFyXzI2KSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHRlbXBfMTQgPSB0ZW1wXzEzLnJ1bGVzLmZpbmQoc3RhdHVzXzEgPT4gc3RhdHVzXzEuc3RhdHVzZXMuaW5jbHVkZXModmFyXzI3KSk7CiAgICAgICAgICBpZiAodGVtcF8xNCkgewogICAgICAgICAgICBjb25zdCB0ZW1wXzE1ID0gdHlwZW9mIHRlbXBfMTQucmVhc29uID09PSAiZnVuY3Rpb24iID8gdGVtcF8xNC5yZWFzb24odmFyXzI3KSA6IHRlbXBfMTQucmVhc29uIHx8ICJIVFRQICIgKyB2YXJfMjc7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMTYgPSB7CiAgICAgICAgICAgICAgbWluU2Vjb25kczogdGVtcF8xNC5taW5TZWNvbmRzLAogICAgICAgICAgICAgIG1heFNlY29uZHM6IHRlbXBfMTQubWF4U2Vjb25kcywKICAgICAgICAgICAgICByZWFzb246IHRlbXBfMTUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmV0dXJuIHRlbXBfMTY7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGdldEZhbGxiYWNrUmV0cnlEZWxheShhc3luY1Jlc3VsdF8yOSkgewogICAgICAgIGlmIChbImJnZC1hcHAiLCAiYmdkLXBlcnNvbmFsIiwgImJnZC1vdmVydmlldyIsICJsb2dpbi1tb2JpbGUiLCAibG9naW4tYXV0aGVudGljYXRlIiwgImxvZ2luLXN1Ym1pdC1vdHAiXS5pbmNsdWRlcyhhc3luY1Jlc3VsdF8yOSkpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG1pblNlY29uZHM6IDEwLAogICAgICAgICAgICBtYXhTZWNvbmRzOiAxMywKICAgICAgICAgICAgcmVhc29uOiAiU3VjY2VzcyBtZXNzYWdlIG5vdCBtYXRjaGVkIgogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgaWYgKFsicGF5LXNlbmQiLCAicGF5LXJlc2VuZCIsICJwYXktdmVyaWZ5IiwgInBheS1jYXB0Y2hhLXZlcmlmeSJdLmluY2x1ZGVzKGFzeW5jUmVzdWx0XzI5KSkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbWluU2Vjb25kczogOCwKICAgICAgICAgICAgbWF4U2Vjb25kczogMTIsCiAgICAgICAgICAgIHJlYXNvbjogIlN1Y2Nlc3MgbWVzc2FnZSBub3QgbWF0Y2hlZCIKICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIGlmIChhc3luY1Jlc3VsdF8yOSA9PT0gInBheS1nZXQtc2xvdCIpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG1pblNlY29uZHM6IDcsCiAgICAgICAgICAgIG1heFNlY29uZHM6IDEwLAogICAgICAgICAgICByZWFzb246ICJTdWNjZXNzIG1lc3NhZ2Ugbm90IG1hdGNoZWQiCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAoYXN5bmNSZXN1bHRfMjkgPT09ICJwYXktbm93IikgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbWluU2Vjb25kczogMTAsCiAgICAgICAgICAgIG1heFNlY29uZHM6IDE0LAogICAgICAgICAgICByZWFzb246ICJTdWNjZXNzIG1lc3NhZ2Ugbm90IG1hdGNoZWQiCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICByZXR1cm4gewogICAgICAgICAgbWluU2Vjb25kczogMTAsCiAgICAgICAgICBtYXhTZWNvbmRzOiAxMywKICAgICAgICAgIHJlYXNvbjogIlN1Y2Nlc3MgbWVzc2FnZSBub3QgbWF0Y2hlZCIKICAgICAgICB9OwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGhhbmRsZUF1dG9SZXRyeShsb29wVmFyXzMwLCB2YXJfMzEsIHZhcl8zMiwgdmFyXzMzID0ge30pIHsKICAgICAgICBpZiAodmFyXzMxID09PSA0MDMpIHsKICAgICAgICAgIHN0b3BBbGxPcGVyYXRpb25zKCk7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiNDAzIEZvcmJpZGRlbiBFcnJvciBkZXRlY3RlZCIsICIjZmY0NDQ0Iik7CiAgICAgICAgfQogICAgICAgIGlmICghYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgZXJyb3JfNCA9IGdldFJldHJ5UnVsZXNGb3JPcGVyYXRpb24obG9vcFZhcl8zMCwgdmFyXzMxLCB2YXJfMzMuaXNOZXR3b3JrRXJyb3IpOwogICAgICAgIGlmICghZXJyb3JfNCkgewogICAgICAgICAgY29uc29sZS5sb2coIk5vIHJldHJ5IHJ1bGUgZm91bmQgZm9yICIgKyBsb29wVmFyXzMwICsgIiAoc3RhdHVzOiAiICsgdmFyXzMxICsgIikgLSB1c2luZyBmYWxsYmFjayBkZWxheSIpOwogICAgICAgICAgZXJyb3JfNCA9IGdldEZhbGxiYWNrUmV0cnlEZWxheShsb29wVmFyXzMwKTsKICAgICAgICB9CiAgICAgICAgaWYgKGVycm9yXzQuZGlzYWJsZUF1dG8pIHsKICAgICAgICAgIGlmICh2YXJfMzEgPT09IDQwMykgewogICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiNDAzIEZvcmJpZGRlbiBFcnJvciBkZXRlY3RlZCAtIEF1dG8gYnV0dG9uIHR1cm5pbmcgb2ZmIiwgIiNmZjQ0NDQiKTsKICAgICAgICAgIH0KICAgICAgICAgIHNldEF1dG9SZXRyeUVuYWJsZWQoZmFsc2UsIGVycm9yXzQucmVhc29uKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgZGVsYXlfMSA9IGdldFJhbmRvbURlbGF5TXMoZXJyb3JfNC5taW5TZWNvbmRzLCBlcnJvcl80Lm1heFNlY29uZHMpOwogICAgICAgIHNjaGVkdWxlQXV0b1JldHJ5KGxvb3BWYXJfMzAsIGRlbGF5XzEsIHZhcl8zMiwgZXJyb3JfNC5yZWFzb24pOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGhhbmRsZU9wZXJhdGlvbkZhaWx1cmUob3V0Y29tZV8zNCwgb3V0Y29tZV8zNSwgb3V0Y29tZV8zNiwgZGF0ZXRpbWVfMzcsIGRhdGV0aW1lXzM4LCB0aW1lckNhbGxiYWNrXzM5LCBkYXRldGltZV80MCkgewogICAgICAgIGlmIChvdXRjb21lXzM0ID09PSAiYmdkLWFwcCIpIHsKICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmFwcFN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKG91dGNvbWVfMzQgPT09ICJiZ2QtcGVyc29uYWwiKSB7CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5wZXJzb25hbFN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKG91dGNvbWVfMzUgPT09IDQwMykgewogICAgICAgICAgY29uc29sZS5sb2coIuKdjCAiICsgZGF0ZXRpbWVfNDAgKyAiOiA0MDMgRm9yYmlkZGVuIEVycm9yIC0gc3RvcHBpbmcgQXV0byBTZXF1ZW5jZSBpbW1lZGlhdGVseSIpOwogICAgICAgICAgc3RvcEFsbE9wZXJhdGlvbnMoKTsKICAgICAgICAgIGlmIChhdXRvUmV0cnlTdGF0ZS5lbmFibGVkKSB7CiAgICAgICAgICAgIHNldEF1dG9SZXRyeUVuYWJsZWQoZmFsc2UsICI0MDMgRm9yYmlkZGVuIEVycm9yIC0gQXV0byB0dXJuZWQgb2ZmIik7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICBzZXRBdXRvU2VxdWVuY2VFbmFibGVkKGZhbHNlKTsKICAgICAgICAgICAgcmVzZXRBdXRvU2VxdWVuY2VTdGF0ZSgpOwogICAgICAgICAgfQogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIjQwMyBGb3JiaWRkZW4gRXJyb3IgLSBBdXRvIFNlcXVlbmNlIHN0b3BwZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgIH0KICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgIHVwZGF0ZUJ1dHRvblN0YXR1cyhkYXRldGltZV8zNywgZGF0ZXRpbWVfNDAsIGRhdGV0aW1lXzM4LCBkYXRldGltZV80MCArICIgU3VjY2VzcyIsIGRhdGV0aW1lXzQwICsgIiBGYWlsZWQiKTsKICAgICAgICB1cGRhdGVCdXR0b25Mb2FkaW5nKHRpbWVyQ2FsbGJhY2tfMzkpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzZXRCdXR0b25TdGF0ZSh0aW1lckNhbGxiYWNrXzM5KSwgMzAwMCk7CiAgICAgICAgaWYgKGF1dG9SZXRyeVN0YXRlLmVuYWJsZWQgJiYgb3V0Y29tZV8zNSAhPT0gNDAzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygi8J-UhCBBdXRvIHJldHJ5IHRyaWdnZXJlZCBmb3IgIiArIGRhdGV0aW1lXzQwICsgIiAtIHN1Y2Nlc3MgbWVzc2FnZSBub3QgbWF0Y2hlZCAoc3RhdHVzOiAiICsgKG91dGNvbWVfMzUgfHwgIk4vQSIpICsgIikiKTsKICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeShvdXRjb21lXzM0LCBvdXRjb21lXzM1LCBvdXRjb21lXzM2LCB7CiAgICAgICAgICAgIGlzTmV0d29ya0Vycm9yOiBvdXRjb21lXzM1ID09PSBudWxsIHx8IG91dGNvbWVfMzUgPT09IHVuZGVmaW5lZAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChvdXRjb21lXzM1ICE9PSA0MDMpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJBdXRvIHJldHJ5IGRpc2FibGVkIGZvciAiICsgZGF0ZXRpbWVfNDAgKyAiIC0gQXV0byBPTiBpcyBvZmYiKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IGF1dG9TZXF1ZW5jZVN0YXRlID0gewogICAgICAgIGVuYWJsZWQ6IGZhbHNlLAogICAgICAgIGN1cnJlbnRTdGVwOiBudWxsLAogICAgICAgIHRpbWVyczogbmV3IE1hcCgpLAogICAgICAgIG90cE9ic2VydmVyOiBudWxsLAogICAgICAgIGRhdGVPYnNlcnZlcjogbnVsbCwKICAgICAgICBhdXRoZW50aWNhdGVTdGFydFRpbWU6IG51bGwsCiAgICAgICAgb3RwRW50ZXJlZFRpbWU6IG51bGwsCiAgICAgICAgc3VibWl0T3RwVGltZXI6IG51bGwsCiAgICAgICAgc3VibWl0T3RwU3RhdHVzMjAwOiBmYWxzZSwKICAgICAgICBiZ2RDZlRpbWVyOiBudWxsLAogICAgICAgIGJnZENmU3RhcnRUaW1lOiBudWxsLAogICAgICAgIHBheU5vd1RpbWVyOiBudWxsLAogICAgICAgIHdhaXRpbmdGb3JQZXJzb25hbDogZmFsc2UsCiAgICAgICAgcGVyc29uYWxEZWxheVN0YXJ0VGltZTogbnVsbCwKICAgICAgICBwZXJzb25hbERlbGF5RHVyYXRpb246IG51bGwsCiAgICAgICAgb3ZlcnZpZXdTdWNjZXNzOiBmYWxzZSwKICAgICAgICBhcHBTdWNjZXNzOiBmYWxzZSwKICAgICAgICBwZXJzb25hbFN1Y2Nlc3M6IGZhbHNlLAogICAgICAgIG1hbnVhbEJnZENmU3RhcnRUaW1lOiBudWxsLAogICAgICAgIG1hbnVhbEJnZENmVGltZXI6IG51bGwsCiAgICAgICAgbWFudWFsUGVyc29uYWxTdGFydFRpbWU6IG51bGwsCiAgICAgICAgbWFudWFsUGVyc29uYWxUaW1lcjogbnVsbCwKICAgICAgICBtYW51YWxQZXJzb25hbERlbGF5RHVyYXRpb246IG51bGwKICAgICAgfTsKICAgICAgY29uc3QgQVVUT19TRVFVRU5DRV9TVEVQUyA9IHsKICAgICAgICBJRExFOiAiaWRsZSIsCiAgICAgICAgTE9HSU5fQ0Y6ICJsb2dpbl9jZiIsCiAgICAgICAgTE9HSU5fTU9CSUxFX1ZFUklGWTogImxvZ2luX21vYmlsZV92ZXJpZnkiLAogICAgICAgIExPR0lOX0FVVEhFTlRJQ0FURTogImxvZ2luX2F1dGhlbnRpY2F0ZSIsCiAgICAgICAgTE9HSU5fV0FJVF9PVFA6ICJsb2dpbl93YWl0X290cCIsCiAgICAgICAgTE9HSU5fU1VCTUlUX09UUDogImxvZ2luX3N1Ym1pdF9vdHAiLAogICAgICAgIEJHRF9DRjogImJnZF9jZiIsCiAgICAgICAgQkdEX0FQUDogImJnZF9hcHAiLAogICAgICAgIEJHRF9QRVJTT05BTDogImJnZF9wZXJzb25hbCIsCiAgICAgICAgQkdEX09WRVJWSUVXOiAiYmdkX292ZXJ2aWV3IiwKICAgICAgICBCR0RfU0VORDogImJnZF9zZW5kIiwKICAgICAgICBCR0RfV0FJVF9WRVJJRlk6ICJiZ2Rfd2FpdF92ZXJpZnkiLAogICAgICAgIFBBWV9HRVRfU0xPVDogInBheV9nZXRfc2xvdCIsCiAgICAgICAgUEFZX1NFVF9USU1FOiAicGF5X3NldF90aW1lIiwKICAgICAgICBQQVlfQ0FQVENIQTogInBheV9jYXB0Y2hhIiwKICAgICAgICBQQVlfV0FJVF9QQVlfTk9XOiAicGF5X3dhaXRfcGF5X25vdyIsCiAgICAgICAgUEFZX05PVzogInBheV9ub3ciCiAgICAgIH07CiAgICAgIGZ1bmN0aW9uIGlzV2l0aGluV29ya2luZ0hvdXJzKCkgewogICAgICAgIGNvbnN0IHRlbXBfMTcgPSBuZXcgRGF0ZSgpOwogICAgICAgIGNvbnN0IHRlbXBfMTggPSB0ZW1wXzE3LmdldEhvdXJzKCk7CiAgICAgICAgY29uc3QgdGVtcF8xOSA9IHRlbXBfMTcuZ2V0TWludXRlcygpOwogICAgICAgIGNvbnN0IHRlbXBfMjAgPSB0ZW1wXzE3LmdldFNlY29uZHMoKTsKICAgICAgICBjb25zdCB0ZW1wXzIxID0gdGVtcF8xOCAqIDM2MDAgKyB0ZW1wXzE5ICogNjAgKyB0ZW1wXzIwOwogICAgICAgIGNvbnN0IHRlbXBfMjIgPSA2NDgwMjsKICAgICAgICBjb25zdCB0ZW1wXzIzID0gMTQ0MDA7CiAgICAgICAgaWYgKHRlbXBfMjIgPD0gdGVtcF8yMykgewogICAgICAgICAgcmV0dXJuIHRlbXBfMjEgPj0gdGVtcF8yMiAmJiB0ZW1wXzIxIDw9IHRlbXBfMjM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0ZW1wXzIxID49IHRlbXBfMjIgfHwgdGVtcF8yMSA8PSB0ZW1wXzIzOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBzZXRBdXRvU2VxdWVuY2VFbmFibGVkKHN0YXRlRmxhZ180MSkgewogICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5lbmFibGVkID09PSBzdGF0ZUZsYWdfNDEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCA9IHN0YXRlRmxhZ180MTsKICAgICAgICBjb25zdCBlbGVtZW50XzUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2xvYmFsLWF1dG8tYy1idG4iKTsKICAgICAgICBpZiAoZWxlbWVudF81KSB7CiAgICAgICAgICBlbGVtZW50XzUudGV4dENvbnRlbnQgPSBzdGF0ZUZsYWdfNDEgPyAiQVMgKE9OKSIgOiAiQVMiOwogICAgICAgICAgZWxlbWVudF81LnN0eWxlLmJveFNoYWRvdyA9IHN0YXRlRmxhZ180MSA_ICIwIDAgMTBweCByZ2JhKDI1NSwgMTUyLCAwLCAwLjYpIiA6ICIiOwogICAgICAgICAgZWxlbWVudF81LnN0eWxlLm9wYWNpdHkgPSBzdGF0ZUZsYWdfNDEgPyAiMSIgOiAiMC44NSI7CiAgICAgICAgfQogICAgICAgIGlmICghc3RhdGVGbGFnXzQxKSB7CiAgICAgICAgICByZXNldEF1dG9TZXF1ZW5jZVN0YXRlKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICghYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogQXV0byBPTiByZXF1aXJlZCB0byBlbmFibGUgQVMiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICAgIGlmIChlbGVtZW50XzUpIHsKICAgICAgICAgICAgICBlbGVtZW50XzUudGV4dENvbnRlbnQgPSAiQVMiOwogICAgICAgICAgICAgIGVsZW1lbnRfNS5zdHlsZS5ib3hTaGFkb3cgPSAiIjsKICAgICAgICAgICAgICBlbGVtZW50XzUuc3R5bGUub3BhY2l0eSA9ICIwLjg1IjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuSURMRTsKICAgICAgICAgIGlmIChpc1dpdGhpbldvcmtpbmdIb3VycygpKSB7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlIGVuYWJsZWQgLSBXYWl0aW5nIGZvciBtYW51YWwgQ0YgY2xpY2sgb24gTG9naW4gVGFiIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlIGVuYWJsZWQgLSBXaWxsIGF1dG8tdHJpZ2dlciB3aGVuIHdvcmtpbmcgaG91cnMgc3RhcnQgKDA2OjAwOjAyIFBNIC0gMDQ6MDA6MDAgQU0pIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gcmVzZXRBdXRvU2VxdWVuY2VTdGF0ZSgpIHsKICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuSURMRTsKICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS50aW1lcnMuZm9yRWFjaChpdGVtXzUgPT4gY2xlYXJUaW1lb3V0KGl0ZW1fNSkpOwogICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLnRpbWVycy5jbGVhcigpOwogICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5zdWJtaXRPdHBUaW1lcikgewogICAgICAgICAgY2xlYXJUaW1lb3V0KGF1dG9TZXF1ZW5jZVN0YXRlLnN1Ym1pdE90cFRpbWVyKTsKICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLnN1Ym1pdE90cFRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmJnZENmVGltZXIpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZUaW1lcik7CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLnBheU5vd1RpbWVyKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQoYXV0b1NlcXVlbmNlU3RhdGUucGF5Tm93VGltZXIpOwogICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUucGF5Tm93VGltZXIgPSBudWxsOwogICAgICAgIH0KICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5hdXRoZW50aWNhdGVTdGFydFRpbWUgPSBudWxsOwogICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm90cEVudGVyZWRUaW1lID0gbnVsbDsKICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5zdWJtaXRPdHBTdGF0dXMyMDAgPSBmYWxzZTsKICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlN0YXJ0VGltZSA9IG51bGw7CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUud2FpdGluZ0ZvclBlcnNvbmFsID0gZmFsc2U7CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUucGVyc29uYWxEZWxheVN0YXJ0VGltZSA9IG51bGw7CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUucGVyc29uYWxEZWxheUR1cmF0aW9uID0gbnVsbDsKICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5vdmVydmlld1N1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5hcHBTdWNjZXNzID0gZmFsc2U7CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUucGVyc29uYWxTdWNjZXNzID0gZmFsc2U7CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbEJnZENmVGltZXIpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsQmdkQ2ZUaW1lcik7CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxCZ2RDZlRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsVGltZXIpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsUGVyc29uYWxUaW1lcik7CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxQZXJzb25hbFRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsQmdkQ2ZTdGFydFRpbWUgPSBudWxsOwogICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsU3RhcnRUaW1lID0gbnVsbDsKICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxQZXJzb25hbERlbGF5RHVyYXRpb24gPSBudWxsOwogICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5vdHBPYnNlcnZlcikgewogICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUub3RwT2JzZXJ2ZXIuZGlzY29ubmVjdCgpOwogICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUub3RwT2JzZXJ2ZXIgPSBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZGF0ZU9ic2VydmVyKSB7CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5kYXRlT2JzZXJ2ZXIuZGlzY29ubmVjdCgpOwogICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuZGF0ZU9ic2VydmVyID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gY2FuQXV0b1NlcXVlbmNlUHJvY2VlZCgpIHsKICAgICAgICByZXR1cm4gYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5lbmFibGVkICYmIGlzV2l0aGluV29ya2luZ0hvdXJzKCk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gaGFuZGxlQXV0b1NlcXVlbmNlRXJyb3IodmFyXzQyKSB7CiAgICAgICAgaWYgKHZhcl80MiA9PT0gbnVsbCB8fCB2YXJfNDIgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAodmFyXzQyID09PSA0MDMpIHsKICAgICAgICAgIHN0b3BBbGxPcGVyYXRpb25zKCk7CiAgICAgICAgICBpZiAoYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICBzZXRBdXRvUmV0cnlFbmFibGVkKGZhbHNlLCAiNDAzIEZvcmJpZGRlbiBFcnJvciAtIEF1dG8gdHVybmVkIG9mZiIpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmVuYWJsZWQpIHsKICAgICAgICAgICAgc2V0QXV0b1NlcXVlbmNlRW5hYmxlZChmYWxzZSk7CiAgICAgICAgICAgIHJlc2V0QXV0b1NlcXVlbmNlU3RhdGUoKTsKICAgICAgICAgIH0KICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCI0MDMgRm9yYmlkZGVuIEVycm9yIGRldGVjdGVkIC0gQXV0byBTZXF1ZW5jZSBzdG9wcGVkIiwgIiNmZjQ0NDQiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgdGVtcF8yNCA9IFs1MDAsIDUwMiwgNTA0LCA0MjldOwogICAgICAgIGlmICghdGVtcF8yNC5pbmNsdWRlcyh2YXJfNDIpKSB7CiAgICAgICAgICBpZiAoYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICBzZXRBdXRvUmV0cnlFbmFibGVkKGZhbHNlLCAiQXV0byBkaXNhYmxlZCBkdWUgdG8gZXJyb3IgIiArIHZhcl80Mik7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICBzZXRBdXRvU2VxdWVuY2VFbmFibGVkKGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJFcnJvciAiICsgdmFyXzQyICsgIiBkZXRlY3RlZCAtIEF1dG8gYW5kIEFTIHR1cm5lZCBvZmYiLCAiI2ZmNDQ0NCIpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBkZXRlY3RNYW51YWxCdXR0b25TdWNjZXNzKG91dGNvbWVfNDMpIHsKICAgICAgICBpZiAoIWF1dG9SZXRyeVN0YXRlLmVuYWJsZWQgfHwgIWF1dG9TZXF1ZW5jZVN0YXRlLmVuYWJsZWQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3Qgc3RlcF8zID0gYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXA7CiAgICAgICAgaWYgKHN0ZXBfMyAmJiBzdGVwXzMgIT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuSURMRSkgewogICAgICAgICAgY29uc3QgdGVtcF8yNSA9IHsKICAgICAgICAgICAgW0FVVE9fU0VRVUVOQ0VfU1RFUFMuSURMRV06IDAsCiAgICAgICAgICAgIFtBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX0NGXTogMSwKICAgICAgICAgICAgW0FVVE9fU0VRVUVOQ0VfU1RFUFMuTE9HSU5fTU9CSUxFX1ZFUklGWV06IDIsCiAgICAgICAgICAgIFtBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX0FVVEhFTlRJQ0FURV06IDMsCiAgICAgICAgICAgIFtBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX1dBSVRfT1RQXTogNCwKICAgICAgICAgICAgW0FVVE9fU0VRVUVOQ0VfU1RFUFMuTE9HSU5fU1VCTUlUX09UUF06IDUsCiAgICAgICAgICAgIFtBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9DRl06IDYsCiAgICAgICAgICAgIFtBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9BUFBdOiA3LAogICAgICAgICAgICBbQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfUEVSU09OQUxdOiA4LAogICAgICAgICAgICBbQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfT1ZFUlZJRVddOiA5LAogICAgICAgICAgICBbQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfU0VORF06IDEwLAogICAgICAgICAgICBbQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfV0FJVF9WRVJJRlldOiAxMSwKICAgICAgICAgICAgW0FVVE9fU0VRVUVOQ0VfU1RFUFMuUEFZX0dFVF9TTE9UXTogMTIsCiAgICAgICAgICAgIFtBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9TRVRfVElNRV06IDEzLAogICAgICAgICAgICBbQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfQ0FQVENIQV06IDE0LAogICAgICAgICAgICBbQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfV0FJVF9QQVlfTk9XXTogMTUsCiAgICAgICAgICAgIFtBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9OT1ddOiAxNgogICAgICAgICAgfTsKICAgICAgICAgIGNvbnN0IHN0ZXBfNCA9IHRlbXBfMjU7CiAgICAgICAgICBsZXQgc3RlcF81ID0gbnVsbDsKICAgICAgICAgIGxldCBzdGVwXzYgPSAwOwogICAgICAgICAgaWYgKG91dGNvbWVfNDMgPT09ICJjZi1idG4tYmdkIiB8fCBvdXRjb21lXzQzID09PSAiY2YtYnRuLWxvZ2luIiAmJiBpc0N1cnJlbnRUYWJBY3RpdmUoImxvZ2luIikpIHsKICAgICAgICAgICAgaWYgKG91dGNvbWVfNDMgPT09ICJjZi1idG4tYmdkIikgewogICAgICAgICAgICAgIHN0ZXBfNSA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX0NGOwogICAgICAgICAgICAgIHN0ZXBfNiA9IHN0ZXBfNFtBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9DRl07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgc3RlcF81ID0gQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9DRjsKICAgICAgICAgICAgICBzdGVwXzYgPSBzdGVwXzRbQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9DRl07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAob3V0Y29tZV80MyA9PT0gImFwcGxpY2F0aW9uLWluZm8tYnRuIikgewogICAgICAgICAgICBzdGVwXzUgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9BUFA7CiAgICAgICAgICAgIHN0ZXBfNiA9IHN0ZXBfNFtBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9BUFBdOwogICAgICAgICAgfSBlbHNlIGlmIChvdXRjb21lXzQzID09PSAicGVyc29uYWwtaW5mby1idG4iKSB7CiAgICAgICAgICAgIHN0ZXBfNSA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX1BFUlNPTkFMOwogICAgICAgICAgICBzdGVwXzYgPSBzdGVwXzRbQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfUEVSU09OQUxdOwogICAgICAgICAgfSBlbHNlIGlmIChvdXRjb21lXzQzID09PSAib3ZlcnZpZXctYnRuIikgewogICAgICAgICAgICBzdGVwXzUgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9PVkVSVklFVzsKICAgICAgICAgICAgc3RlcF82ID0gc3RlcF80W0FVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX09WRVJWSUVXXTsKICAgICAgICAgIH0gZWxzZSBpZiAob3V0Y29tZV80MyA9PT0gInBheS1vdHAtYnRuIikgewogICAgICAgICAgICBzdGVwXzUgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9TRU5EOwogICAgICAgICAgICBzdGVwXzYgPSBzdGVwXzRbQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfU0VORF07CiAgICAgICAgICB9IGVsc2UgaWYgKG91dGNvbWVfNDMgPT09ICJwYXktdmVyaWZ5LWJ0biIpIHsKICAgICAgICAgICAgc3RlcF81ID0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfV0FJVF9WRVJJRlk7CiAgICAgICAgICAgIHN0ZXBfNiA9IHN0ZXBfNFtBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9XQUlUX1ZFUklGWV07CiAgICAgICAgICB9IGVsc2UgaWYgKG91dGNvbWVfNDMgPT09ICJnZXQtdGltZS1zbG90LWJ0biIpIHsKICAgICAgICAgICAgc3RlcF81ID0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfR0VUX1NMT1Q7CiAgICAgICAgICAgIHN0ZXBfNiA9IHN0ZXBfNFtBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9HRVRfU0xPVF07CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoc3RlcF81KSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMjYgPSBzdGVwXzRbc3RlcF8zXSB8fCAwOwogICAgICAgICAgICBpZiAoc3RlcF82ID4gdGVtcF8yNikgewogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gc3RlcF81OwogICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBEZXRlY3RlZCBtYW51YWwgIiArIG91dGNvbWVfNDMgKyAiIHN1Y2Nlc3MsIGNvbnRpbnVpbmcgZnJvbSBzdGVwICIgKyBzdGVwXzUsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBjb250aW51ZUF1dG9TZXF1ZW5jZSgpOwogICAgICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgbGV0IHN0ZXBfNyA9IG51bGw7CiAgICAgICAgICBpZiAob3V0Y29tZV80MyA9PT0gImNmLWJ0bi1iZ2QiKSB7CiAgICAgICAgICAgIHN0ZXBfNyA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX0NGOwogICAgICAgICAgfSBlbHNlIGlmIChvdXRjb21lXzQzID09PSAiYXBwbGljYXRpb24taW5mby1idG4iKSB7CiAgICAgICAgICAgIHN0ZXBfNyA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX0FQUDsKICAgICAgICAgIH0gZWxzZSBpZiAob3V0Y29tZV80MyA9PT0gInBlcnNvbmFsLWluZm8tYnRuIikgewogICAgICAgICAgICBzdGVwXzcgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9QRVJTT05BTDsKICAgICAgICAgIH0gZWxzZSBpZiAob3V0Y29tZV80MyA9PT0gIm92ZXJ2aWV3LWJ0biIpIHsKICAgICAgICAgICAgc3RlcF83ID0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfT1ZFUlZJRVc7CiAgICAgICAgICB9IGVsc2UgaWYgKG91dGNvbWVfNDMgPT09ICJwYXktb3RwLWJ0biIpIHsKICAgICAgICAgICAgc3RlcF83ID0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfU0VORDsKICAgICAgICAgIH0gZWxzZSBpZiAob3V0Y29tZV80MyA9PT0gInBheS12ZXJpZnktYnRuIikgewogICAgICAgICAgICBzdGVwXzcgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9XQUlUX1ZFUklGWTsKICAgICAgICAgIH0gZWxzZSBpZiAob3V0Y29tZV80MyA9PT0gImdldC10aW1lLXNsb3QtYnRuIikgewogICAgICAgICAgICBzdGVwXzcgPSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9HRVRfU0xPVDsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChzdGVwXzcpIHsKICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBzdGVwXzc7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBEZXRlY3RlZCBtYW51YWwgIiArIG91dGNvbWVfNDMgKyAiIHN1Y2Nlc3MsIHN0YXJ0aW5nIGZyb20gc3RlcCAiICsgc3RlcF83LCAiIzAwRkYwMCIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICBjb250aW51ZUF1dG9TZXF1ZW5jZSgpOwogICAgICAgICAgICB9LCA1MDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBvYnNlcnZlT3RwSW5wdXQodmFyXzQ0LCB0aW1lckNhbGxiYWNrXzQ1LCB2YXJfNDYgPSAzMDAwMDApIHsKICAgICAgICBjb25zdCBlbGVtZW50XzYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2YXJfNDQpOwogICAgICAgIGlmICghZWxlbWVudF82KSB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHRpbWVyQ2FsbGJhY2tfNDUoKSwgMTAwMCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IGlucHV0XzEgPSAoKSA9PiB7CiAgICAgICAgICBjb25zdCBjb3VudF8zID0gZWxlbWVudF82LnZhbHVlLnRyaW0oKTsKICAgICAgICAgIGlmIChjb3VudF8zLmxlbmd0aCA-PSA0KSB7CiAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5vdHBPYnNlcnZlcikgewogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm90cE9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5vdHBPYnNlcnZlciA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGltZXJDYWxsYmFja180NSgpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgaWYgKGVsZW1lbnRfNi52YWx1ZS50cmltKCkubGVuZ3RoID49IDQpIHsKICAgICAgICAgIHRpbWVyQ2FsbGJhY2tfNDUoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLm90cE9ic2VydmVyKSB7CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5vdHBPYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICAgICAgfQogICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm90cE9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoaW5wdXRfMSk7CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUub3RwT2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50XzYsIHsKICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWUsCiAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsCiAgICAgICAgICBzdWJ0cmVlOiB0cnVlCiAgICAgICAgfSk7CiAgICAgICAgZWxlbWVudF82LmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgaW5wdXRfMSk7CiAgICAgICAgZWxlbWVudF82LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGlucHV0XzEpOwogICAgICAgIGlmICh2YXJfNDYgPiAwKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLm90cE9ic2VydmVyKSB7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUub3RwT2JzZXJ2ZXIuZGlzY29ubmVjdCgpOwogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm90cE9ic2VydmVyID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbGVtZW50XzYucmVtb3ZlRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCBpbnB1dF8xKTsKICAgICAgICAgICAgZWxlbWVudF82LnJlbW92ZUV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGlucHV0XzEpOwogICAgICAgICAgfSwgdmFyXzQ2KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gb2JzZXJ2ZURhdGVJbnB1dChkYXRldGltZV80NywgdGltZXJDYWxsYmFja180OCkgewogICAgICAgIGNvbnN0IGVsZW1lbnRfNyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRhdGV0aW1lXzQ3KTsKICAgICAgICBpZiAoIWVsZW1lbnRfNykgewogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aW1lckNhbGxiYWNrXzQ4KCksIDEwMDApOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCBpbnB1dF8yID0gKCkgPT4gewogICAgICAgICAgY29uc3QgdGVtcF8yNyA9IGVsZW1lbnRfNy52YWx1ZS50cmltKCk7CiAgICAgICAgICBpZiAoL15cZHs0fS1cZHsyfS1cZHsyfSQvLnRlc3QodGVtcF8yNykpIHsKICAgICAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmRhdGVPYnNlcnZlcikgewogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmRhdGVPYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuZGF0ZU9ic2VydmVyID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aW1lckNhbGxiYWNrXzQ4KCk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBpZiAoL15cZHs0fS1cZHsyfS1cZHsyfSQvLnRlc3QoZWxlbWVudF83LnZhbHVlLnRyaW0oKSkpIHsKICAgICAgICAgIHRpbWVyQ2FsbGJhY2tfNDgoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmRhdGVPYnNlcnZlcikgewogICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuZGF0ZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAgICAgICB9CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuZGF0ZU9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoaW5wdXRfMik7CiAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuZGF0ZU9ic2VydmVyLm9ic2VydmUoZWxlbWVudF83LCB7CiAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLAogICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLAogICAgICAgICAgc3VidHJlZTogdHJ1ZQogICAgICAgIH0pOwogICAgICAgIGVsZW1lbnRfNy5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIGlucHV0XzIpOwogICAgICAgIGVsZW1lbnRfNy5hZGRFdmVudExpc3RlbmVyKCJjaGFuZ2UiLCBpbnB1dF8yKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBjaGVja0J1dHRvblRleHRDb250YWlucyh2YXJfNDksIGh0bWxDb250ZW50XzUwKSB7CiAgICAgICAgY29uc3QgZWxlbWVudF84ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodmFyXzQ5KTsKICAgICAgICBpZiAoIWVsZW1lbnRfOCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZWxlbWVudF84LnRleHRDb250ZW50LmluY2x1ZGVzKCLinJMiKSB8fCBlbGVtZW50XzgudGV4dENvbnRlbnQuaW5jbHVkZXMoaHRtbENvbnRlbnRfNTApOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGlzQnV0dG9uRW5hYmxlZChzdGF0ZUZsYWdfNTEpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdGF0ZUZsYWdfNTEpOwogICAgICAgIGlmIChlbGVtZW50XzkgJiYgIWVsZW1lbnRfOS5kaXNhYmxlZCkgewogICAgICAgICAgZWxlbWVudF85LmNsaWNrKCk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGNsaWNrQnV0dG9uKGV2ZW50SGFuZGxlcl81MikgewogICAgICAgIGNvbnN0IGVsZW1lbnRfMTAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJbZGF0YS10YWI9XCIiICsgZXZlbnRIYW5kbGVyXzUyICsgIlwiXSIpOwogICAgICAgIGlmIChlbGVtZW50XzEwKSB7CiAgICAgICAgICBlbGVtZW50XzEwLmNsaWNrKCk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGlzQ3VycmVudFRhYkFjdGl2ZShzdGF0ZUZsYWdfNTMpIHsKICAgICAgICBpZiAoY2FwdGNoYVByb3ZpZGVyQ29uZmlnW3N0YXRlRmxhZ181M10gJiYgY2FwdGNoYVByb3ZpZGVyQ29uZmlnW3N0YXRlRmxhZ181M10uZW5hYmxlZCAmJiBjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzUzXS50b2tlbikgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGVsZW1lbnRfMTEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2YtYnRuLSIgKyBzdGF0ZUZsYWdfNTMpOwogICAgICAgIGlmIChlbGVtZW50XzExKSB7CiAgICAgICAgICByZXR1cm4gZWxlbWVudF8xMS50ZXh0Q29udGVudC5pbmNsdWRlcygi4pyTIikgfHwgZWxlbWVudF8xMS50ZXh0Q29udGVudC5pbmNsdWRlcygiTG9hZGVkIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBmdW5jdGlvbiBzd2l0Y2hUb1RhYihzdGF0ZUZsYWdfNTQpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzEyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNmLWJ0bi0iICsgc3RhdGVGbGFnXzU0KTsKICAgICAgICBpZiAoZWxlbWVudF8xMiAmJiBjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzU0XSAmJiBjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzU0XS5lbmFibGVkKSB7CiAgICAgICAgICBjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzU0XS5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICBjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzU0XS50b2tlbiA9ICIiOwogICAgICAgICAgdmFyXzU1KHN0YXRlRmxhZ181NCk7CiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50XzEyKSB7CiAgICAgICAgICB2YXJfNTUoc3RhdGVGbGFnXzU0KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gaGFuZGxlTG9naW5DRlN0ZXAoKSB7CiAgICAgICAgY29uc3QgdGVtcF8yOCA9ICFhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlN0YXJ0VGltZTsKICAgICAgICBpZiAodGVtcF8yOCkgewogICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUgPSBEYXRlLm5vdygpOwogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IEJHRCBDRiB0aW1lciBzdGFydGVkICg1NHMpIiwgIiMwMEZGMDAiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgdGVtcF8yOSA9IChEYXRlLm5vdygpIC0gYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUpIC8gMTAwMDsKICAgICAgICAgIGNvbnN0IHRpbWVyXzMgPSBNYXRoLm1heCgwLCA1NCAtIHRlbXBfMjkpOwogICAgICAgICAgaWYgKHRpbWVyXzMgPiAwKSB7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBCR0QgQ0YgdGltZXIgY29udGludWluZyBmcm9tIGZpcnN0IGNsaWNrICgiICsgTWF0aC5yb3VuZCh0aW1lcl8zKSArICJzIHJlbWFpbmluZykiLCAiI0ZGRDcwMCIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUpIHsKICAgICAgICAgIGNvbnN0IHRlbXBfMzAgPSAoRGF0ZS5ub3coKSAtIGF1dG9TZXF1ZW5jZVN0YXRlLmJnZENmU3RhcnRUaW1lKSAvIDEwMDA7CiAgICAgICAgICBpZiAodGVtcF8zMCA-PSA1NCkgewogICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogNTRzIGVsYXBzZWQgZnJvbSBmaXJzdCBDRiBjbGljaywgY2hlY2tpbmcgQ0Ygc3RhdHVzIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgZXhlY3V0ZUFwcEluZm9TdGVwKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlRpbWVyKSB7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzEzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRpdGxlLXRpbWVyLWRpc3BsYXkiKTsKICAgICAgICAgIGlmIChlbGVtZW50XzEzICYmIGF1dG9TZXF1ZW5jZVN0YXRlLmJnZENmU3RhcnRUaW1lKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMzEgPSAoRGF0ZS5ub3coKSAtIGF1dG9TZXF1ZW5jZVN0YXRlLmJnZENmU3RhcnRUaW1lKSAvIDEwMDA7CiAgICAgICAgICAgIGxldCB0ZXh0XzggPSBNYXRoLmZsb29yKHRlbXBfMzEpOwogICAgICAgICAgICBjb25zdCB0aW1lcl80ID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgIHRleHRfOCsrOwogICAgICAgICAgICAgIGVsZW1lbnRfMTMudGV4dENvbnRlbnQgPSB0ZXh0XzggKyAicyI7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8zMiA9IChEYXRlLm5vdygpIC0gYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUpIC8gMTAwMDsKICAgICAgICAgICAgICBpZiAodGVtcF8zMiA-PSA1NCkgewogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcl80KTsKICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmJnZENmVGltZXIgPSBudWxsOwogICAgICAgICAgICAgICAgaWYgKGNhbkF1dG9TZXF1ZW5jZVByb2NlZWQoKSAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfQ0YpIHsKICAgICAgICAgICAgICAgICAgZXhlY3V0ZUFwcEluZm9TdGVwKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZUaW1lciA9IHRpbWVyXzQ7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGl0bGUtdGltZXItZGlzcGxheSIpOwogICAgICAgICAgaWYgKGVsZW1lbnRfMTQgJiYgYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUpIHsKICAgICAgICAgICAgY29uc3QgdGV4dF85ID0gKERhdGUubm93KCkgLSBhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlN0YXJ0VGltZSkgLyAxMDAwOwogICAgICAgICAgICBlbGVtZW50XzE0LnRleHRDb250ZW50ID0gTWF0aC5mbG9vcih0ZXh0XzkpICsgInMiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBoYW5kbGVCZ2RDRkFmdGVyQXV0aCgpIHsKICAgICAgICBjb25zdCB0ZW1wXzMzID0gIWF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbEJnZENmU3RhcnRUaW1lOwogICAgICAgIGlmICh0ZW1wXzMzKSB7CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxCZ2RDZlN0YXJ0VGltZSA9IERhdGUubm93KCk7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiTWFudWFsOiBZb3UgQ2FuIEhpdCBvbiBBcHAgYWZ0ZXIgNTQgc2VjIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICB2YXJfNTYoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgdGVtcF8zNCA9IChEYXRlLm5vdygpIC0gYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsQmdkQ2ZTdGFydFRpbWUpIC8gMTAwMDsKICAgICAgICAgIGNvbnN0IHRlbXBfMzUgPSBNYXRoLm1heCgwLCA1NCAtIHRlbXBfMzQpOwogICAgICAgICAgaWYgKHRlbXBfMzUgPiAwKSB7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJNYW51YWw6IFlvdSBDYW4gSGl0IG9uIEFwcCBhZnRlciAiICsgTWF0aC5yb3VuZCh0ZW1wXzM1KSArICIgc2VjIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbEJnZENmU3RhcnRUaW1lKSB7CiAgICAgICAgICBjb25zdCB0ZW1wXzM2ID0gKERhdGUubm93KCkgLSBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxCZ2RDZlN0YXJ0VGltZSkgLyAxMDAwOwogICAgICAgICAgaWYgKHRlbXBfMzYgPj0gNTQpIHsKICAgICAgICAgICAgc3RvcEFsbE9wZXJhdGlvbnMoKTsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIk5vdyB5b3UgY2FuIEhpdCBvbiBBcHAgSW5mby4uLiIsICIjRkZENzAwIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxCZ2RDZlRpbWVyKSB7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE1ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRpdGxlLXRpbWVyLWRpc3BsYXkiKTsKICAgICAgICAgIGlmIChlbGVtZW50XzE1ICYmIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbEJnZENmU3RhcnRUaW1lKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMzcgPSAoRGF0ZS5ub3coKSAtIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbEJnZENmU3RhcnRUaW1lKSAvIDEwMDA7CiAgICAgICAgICAgIGxldCB0ZXh0XzEwID0gTWF0aC5mbG9vcih0ZW1wXzM3KTsKICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsQmdkQ2ZUaW1lciA9IHNldEludGVydmFsKCgpID0-IHsKICAgICAgICAgICAgICB0ZXh0XzEwKys7CiAgICAgICAgICAgICAgZWxlbWVudF8xNS50ZXh0Q29udGVudCA9IHRleHRfMTAgKyAicyI7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8zOCA9IChEYXRlLm5vdygpIC0gYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsQmdkQ2ZTdGFydFRpbWUpIC8gMTAwMDsKICAgICAgICAgICAgICBjb25zdCB0ZW1wXzM5ID0gTWF0aC5tYXgoMCwgNTQgLSB0ZW1wXzM4KTsKICAgICAgICAgICAgICBpZiAodGVtcF8zOSA-IDApIHsKICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJNYW51YWw6IFlvdSBDYW4gSGl0IG9uIEFwcCBhZnRlciAiICsgTWF0aC5yb3VuZCh0ZW1wXzM5KSArICIgc2VjIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHRlbXBfMzggPj0gNTQpIHsKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsQmdkQ2ZUaW1lcik7CiAgICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxCZ2RDZlRpbWVyID0gbnVsbDsKICAgICAgICAgICAgICAgIHN0b3BBbGxPcGVyYXRpb25zKCk7CiAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiTm93IHlvdSBjYW4gSGl0IG9uIEFwcCBJbmZvLi4uIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRpdGxlLXRpbWVyLWRpc3BsYXkiKTsKICAgICAgICAgIGlmIChlbGVtZW50XzE2ICYmIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbEJnZENmU3RhcnRUaW1lKSB7CiAgICAgICAgICAgIGNvbnN0IHRleHRfMTEgPSAoRGF0ZS5ub3coKSAtIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbEJnZENmU3RhcnRUaW1lKSAvIDEwMDA7CiAgICAgICAgICAgIGVsZW1lbnRfMTYudGV4dENvbnRlbnQgPSBNYXRoLmZsb29yKHRleHRfMTEpICsgInMiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBoYW5kbGVCZ2RQZXJzb25hbERlbGF5KCkgewogICAgICAgIGNvbnN0IGRlbGF5XzIgPSBleGVjdXRlUGVyc29uYWxJbmZvU3RlcCgpOwogICAgICAgIGNvbnN0IGNvdW50XzQgPSBNYXRoLnJvdW5kKGRlbGF5XzIgLyAxMDAwKTsKICAgICAgICBjb25zdCBjb3VudF81ID0gcGFyc2VJbnQoZmFtaWx5X2NvdW50KSB8fCAwOwogICAgICAgIGNvbnN0IHRlbXBfNDAgPSAhYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsUGVyc29uYWxTdGFydFRpbWU7CiAgICAgICAgaWYgKHRlbXBfNDApIHsKICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsU3RhcnRUaW1lID0gRGF0ZS5ub3coKTsKICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsRGVsYXlEdXJhdGlvbiA9IGRlbGF5XzI7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiTWFudWFsOiBZb3UgY2FuIEhpdCBvbiBQZXJzb25hbCBpbmZvIGFmdGVyICIgKyBjb3VudF80ICsgIiBzZWMgKEZhbWlseSBDb3VudDogIiArIGNvdW50XzUgKyAiKSIsICIjRkZENzAwIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IHRlbXBfNDEgPSAoRGF0ZS5ub3coKSAtIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsU3RhcnRUaW1lKSAvIDEwMDA7CiAgICAgICAgICBjb25zdCBjb3VudF82ID0gTWF0aC5tYXgoMCwgZGVsYXlfMiAtIHRlbXBfNDEgKiAxMDAwKSAvIDEwMDA7CiAgICAgICAgICBpZiAoY291bnRfNiA-IDApIHsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIk1hbnVhbDogWW91IGNhbiBIaXQgb24gUGVyc29uYWwgaW5mbyBhZnRlciAiICsgTWF0aC5yb3VuZChjb3VudF82KSArICIgc2VjIChGYW1pbHkgQ291bnQ6ICIgKyBjb3VudF81ICsgIikiLCAiI0ZGRDcwMCIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsUGVyc29uYWxTdGFydFRpbWUpIHsKICAgICAgICAgIGNvbnN0IGRlbGF5XzMgPSBEYXRlLm5vdygpIC0gYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsUGVyc29uYWxTdGFydFRpbWU7CiAgICAgICAgICBpZiAoZGVsYXlfMyA-PSBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxQZXJzb25hbERlbGF5RHVyYXRpb24pIHsKICAgICAgICAgICAgc3RvcEFsbE9wZXJhdGlvbnMoKTsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIk5vdyBZb3UgQ2FuIEhpdCBvbiBQZXJzb25hbCBJbmZvLi4uIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIWF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsVGltZXIpIHsKICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxQZXJzb25hbFN0YXJ0VGltZSAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxQZXJzb25hbERlbGF5RHVyYXRpb24pIHsKICAgICAgICAgICAgICBjb25zdCBkZWxheV80ID0gRGF0ZS5ub3coKSAtIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsU3RhcnRUaW1lOwogICAgICAgICAgICAgIGNvbnN0IGRlbGF5XzUgPSBNYXRoLm1heCgwLCBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxQZXJzb25hbERlbGF5RHVyYXRpb24gLSBkZWxheV80KTsKICAgICAgICAgICAgICBjb25zdCBjb3VudF83ID0gTWF0aC5yb3VuZChkZWxheV81IC8gMTAwMCk7CiAgICAgICAgICAgICAgaWYgKGNvdW50XzcgPiAwKSB7CiAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiTWFudWFsOiBZb3UgY2FuIEhpdCBvbiBQZXJzb25hbCBpbmZvIGFmdGVyICIgKyBjb3VudF83ICsgIiBzZWMgKEZhbWlseSBDb3VudDogIiArIGNvdW50XzUgKyAiKSIsICIjRkZENzAwIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChkZWxheV80ID49IGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsRGVsYXlEdXJhdGlvbikgewogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxQZXJzb25hbFRpbWVyKTsKICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm1hbnVhbFBlcnNvbmFsVGltZXIgPSBudWxsOwogICAgICAgICAgICAgICAgc3RvcEFsbE9wZXJhdGlvbnMoKTsKICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJOb3cgWW91IENhbiBIaXQgb24gUGVyc29uYWwgSW5mby4uLiIsICIjRkZENzAwIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZXhlY3V0ZUFwcEluZm9TdGVwKCkgewogICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCAhPT0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfQ0YpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCFpc0N1cnJlbnRUYWJBY3RpdmUoImJnZCIpKSB7CiAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUpIHsKICAgICAgICAgICAgY29uc3QgdGVtcF80MiA9IChEYXRlLm5vdygpIC0gYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUpIC8gMTAwMDsKICAgICAgICAgICAgaWYgKHRlbXBfNDIgPj0gNTQpIHsKICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogNTRzIGVsYXBzZWQsIENGIG5vdCBzdWNjZXNzZnVsIC0gd2FpdGluZyBmb3IgbWFudWFsIENGIGNsaWNrIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCFhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlN0YXJ0VGltZSkgewogICAgICAgICAgaGFuZGxlTG9naW5DRlN0ZXAoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgdGltZXJfNSA9IChEYXRlLm5vdygpIC0gYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZTdGFydFRpbWUpIC8gMTAwMDsKICAgICAgICBpZiAodGltZXJfNSA-PSA1NCkgewogICAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmJnZENmVGltZXIpIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlRpbWVyKTsKICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZUaW1lciA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX0FQUDsKICAgICAgICAgIGNvbnN0IHRlbXBfNDMgPSAiYXBwbGljYXRpb24taW5mby1idG4iOwogICAgICAgICAgY29uc3QgdGVtcF80NCA9IGVkaXRlZEVuZHBvaW50c1t0ZW1wXzQzXTsKICAgICAgICAgIGlmICh0ZW1wXzQ0KSB7CiAgICAgICAgICAgIHN1Ym1pdEFwcGxpY2F0aW9uSW5mbyh0ZW1wXzQ0KS50aGVuKCgpID0-IHsKICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogQXBwIHJlcXVlc3Qgc2VudCAoNTRzIGVsYXBzZWQgKyBDRiBzdWNjZXNzKSIsICIjMDBGRjAwIik7CiAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yXzUgPT4gewogICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGluIEFwcCBidXR0b24gY2xpY2s6IiwgZXJyb3JfNSk7CiAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IEFwcCByZXF1ZXN0IGZhaWxlZCIsICIjZmY0NDQ0Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3VibWl0QXBwbGljYXRpb25JbmZvKCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IEFwcCByZXF1ZXN0IHNlbnQgKDU0cyBlbGFwc2VkICsgQ0Ygc3VjY2VzcykiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICB9KS5jYXRjaChlcnJvcl82ID0-IHsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBpbiBBcHAgYnV0dG9uIGNsaWNrOiIsIGVycm9yXzYpOwogICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBBcHAgcmVxdWVzdCBmYWlsZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IEJHRCBDRiBzdWNjZXNzLCB3YWl0aW5nICIgKyBNYXRoLnJvdW5kKDU0IC0gdGltZXJfNSkgKyAicyBmb3IgdGltZXIiLCAiI0ZGRDcwMCIpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBleGVjdXRlUGVyc29uYWxJbmZvU3RlcCgpIHsKICAgICAgICBjb25zdCBkZWxheV82ID0gcGFyc2VJbnQoZmFtaWx5X2NvdW50KSB8fCAwOwogICAgICAgIGNvbnN0IHRlbXBfNDUgPSB7CiAgICAgICAgICAiMCI6IHsKICAgICAgICAgICAgbWluOiAxMjAwMCwKICAgICAgICAgICAgbWF4OiAxNTAwMAogICAgICAgICAgfSwKICAgICAgICAgICIxIjogewogICAgICAgICAgICBtaW46IDQ3MDAwLAogICAgICAgICAgICBtYXg6IDQ5MDAwCiAgICAgICAgICB9LAogICAgICAgICAgIjIiOiB7CiAgICAgICAgICAgIG1pbjogODIwMDAsCiAgICAgICAgICAgIG1heDogODUwMDAKICAgICAgICAgIH0sCiAgICAgICAgICAiMyI6IHsKICAgICAgICAgICAgbWluOiAxMTcwMDAsCiAgICAgICAgICAgIG1heDogMTIwMDAwCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBjb25zdCB0ZW1wXzQ2ID0gdGVtcF80NVtkZWxheV82XTsKICAgICAgICBpZiAodGVtcF80NikgewogICAgICAgICAgY29uc3QgdGVtcF80NyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICh0ZW1wXzQ2Lm1heCAtIHRlbXBfNDYubWluICsgMSkpICsgdGVtcF80Ni5taW47CiAgICAgICAgICByZXR1cm4gdGVtcF80NzsKICAgICAgICB9CiAgICAgICAgY29uc29sZS53YXJuKCJGYW1pbHkgY291bnQgIiArIGRlbGF5XzYgKyAiIG5vdCBpbiBkZWxheSBtYXBwaW5nLCB1c2luZyBkZWZhdWx0IDE0MHMgZGVsYXkiKTsKICAgICAgICByZXR1cm4gMTQwMDAwOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGNvbnRpbnVlQXV0b1NlcXVlbmNlKCkgewogICAgICAgIGlmICghYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCB8fCAhYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgcmVzZXRBdXRvU2VxdWVuY2VTdGF0ZSgpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzd2l0Y2ggKGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwKSB7CiAgICAgICAgICBjYXNlIEFVVE9fU0VRVUVOQ0VfU1RFUFMuSURMRToKICAgICAgICAgIGNhc2UgQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9DRjoKICAgICAgICAgICAgaWYgKGlzV2l0aGluV29ya2luZ0hvdXJzKCkpIHsKICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VGFiQWN0aXZlKCJsb2dpbiIpKSB7CiAgICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuTE9HSU5fTU9CSUxFX1ZFUklGWTsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICBpZiAoaXNCdXR0b25FbmFibGVkKCJtb2JpbGUtdmVyaWZ5LWJ0biIpKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IE1vYmlsZSBWZXJpZnkgY2xpY2tlZCIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHt9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSBBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX01PQklMRV9WRVJJRlk6CiAgICAgICAgICAgIGlmIChjaGVja0J1dHRvblRleHRDb250YWlucygibW9iaWxlLXZlcmlmeS1idG4iLCAiUmVnaXN0ZXJlZCIpKSB7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX0FVVEhFTlRJQ0FURTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgIGlmIChpc0J1dHRvbkVuYWJsZWQoImF1dGhlbnRpY2F0ZS1idG4iKSkgewogICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogQXV0aGVudGljYXRlIGNsaWNrZWQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSBBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX0FVVEhFTlRJQ0FURToKICAgICAgICAgICAgaWYgKGNoZWNrQnV0dG9uVGV4dENvbnRhaW5zKCJhdXRoZW50aWNhdGUtYnRuIiwgIkF1dGhlbnRpY2F0ZWQiKSkgewogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9XQUlUX09UUDsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5hdXRoZW50aWNhdGVTdGFydFRpbWUgPSBEYXRlLm5vdygpOwogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLm90cEVudGVyZWRUaW1lID0gbnVsbDsKICAgICAgICAgICAgICBjb25zdCBlbGVtZW50XzE3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm10LW90cCIpOwogICAgICAgICAgICAgIGlmIChlbGVtZW50XzE3KSB7CiAgICAgICAgICAgICAgICBsZXQgdGVtcF80OCA9IGZhbHNlOwogICAgICAgICAgICAgICAgb2JzZXJ2ZU90cElucHV0KCJtdC1vdHAiLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgIGlmICh0ZW1wXzQ4KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkF1dG8gU2VxdWVuY2U6IE9UUCBjYWxsYmFjayBhbHJlYWR5IGV4ZWN1dGVkLCBpZ25vcmluZyBkdXBsaWNhdGUgY2FsbCIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoY2FuQXV0b1NlcXVlbmNlUHJvY2VlZCgpICYmIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID09PSBBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX1dBSVRfT1RQKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcF80OCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUub3RwRW50ZXJlZFRpbWUgPSBEYXRlLm5vdygpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfNDkgPSAoYXV0b1NlcXVlbmNlU3RhdGUub3RwRW50ZXJlZFRpbWUgLSBhdXRvU2VxdWVuY2VTdGF0ZS5hdXRoZW50aWNhdGVTdGFydFRpbWUpIC8gMTAwMDsKICAgICAgICAgICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuc3VibWl0T3RwVGltZXIpIHsKICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChhdXRvU2VxdWVuY2VTdGF0ZS5zdWJtaXRPdHBUaW1lcik7CiAgICAgICAgICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5zdWJtaXRPdHBUaW1lciA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wXzQ5IDwgMTcpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbGF5XzcgPSAoMTcgLSB0ZW1wXzQ5KSAqIDEwMDA7CiAgICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogT1RQIGVudGVyZWQsIHdhaXRpbmcgIiArIE1hdGgucm91bmQoZGVsYXlfNyAvIDEwMDApICsgInMgdG8gcmVhY2ggMTdzIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLnN1Ym1pdE90cFRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW5BdXRvU2VxdWVuY2VQcm9jZWVkKCkgJiYgKGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID09PSBBVVRPX1NFUVVFTkNFX1NURVBTLkxPR0lOX1NVQk1JVF9PVFAgfHwgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuTE9HSU5fV0FJVF9PVFApICYmICFkZWxheV84KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuc3VibWl0T3RwVGltZXIgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9TVUJNSVRfT1RQOwogICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLnN1Ym1pdE90cFN0YXR1czIwMCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfNTAgPSAic3VibWl0LW90cC1idG4iOwogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfNTEgPSBlZGl0ZWRFbmRwb2ludHNbdGVtcF81MF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBfNTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdExvZ2luT3RwKHRlbXBfNTEpLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogU3VibWl0IE9UUCByZXF1ZXN0IHNlbnQgKGFmdGVyIDE3cyB3YWl0KSIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnJvcl83ID0-IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgaW4gU3VibWl0IE9UUCBjbGljazoiLCBlcnJvcl83KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFN1Ym1pdCBPVFAgcmVxdWVzdCBmYWlsZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdExvZ2luT3RwKCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBTdWJtaXQgT1RQIHJlcXVlc3Qgc2VudCAoYWZ0ZXIgMTdzIHdhaXQpIiwgIiMwMEZGMDAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yXzggPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBpbiBTdWJtaXQgT1RQIGNsaWNrOiIsIGVycm9yXzgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogU3VibWl0IE9UUCByZXF1ZXN0IGZhaWxlZCIsICIjZmY0NDQ0Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIGRlbGF5XzcpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWRlbGF5XzgpIHsKICAgICAgICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9TVUJNSVRfT1RQOwogICAgICAgICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuc3VibWl0T3RwU3RhdHVzMjAwID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wXzUyID0gInN1Ym1pdC1vdHAtYnRuIjsKICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfNTMgPSBlZGl0ZWRFbmRwb2ludHNbdGVtcF81Ml07CiAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcF81MykgewogICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRMb2dpbk90cCh0ZW1wXzUzKS50aGVuKCgpID0-IHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogU3VibWl0IE9UUCByZXF1ZXN0IHNlbnQgKDE3cyBlbGFwc2VkKSIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yXzkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGluIFN1Ym1pdCBPVFAgY2xpY2s6IiwgZXJyb3JfOSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFN1Ym1pdCBPVFAgcmVxdWVzdCBmYWlsZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdExvZ2luT3RwKCkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFN1Ym1pdCBPVFAgcmVxdWVzdCBzZW50ICgxN3MgZWxhcHNlZCkiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnJvcl8xMCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgaW4gU3VibWl0IE9UUCBjbGljazoiLCBlcnJvcl8xMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFN1Ym1pdCBPVFAgcmVxdWVzdCBmYWlsZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9TVUJNSVRfT1RQOgogICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuc3VibWl0T3RwU3RhdHVzMjAwKSB7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuc3VibWl0T3RwU3RhdHVzMjAwID0gZmFsc2U7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9DRjsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlN0YXJ0VGltZSA9IG51bGw7CiAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFN1Ym1pdCBPVFAgc3VjY2VzcywgbW92aW5nIHRvIEJHRCBUYWIgaW1tZWRpYXRlbHkiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgIGNsaWNrQnV0dG9uKCJiZ2QiKTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBFbmFibGluZyBCR0QgQ0YgYnV0dG9uIiwgIiMwMEZGMDAiKTsKICAgICAgICAgICAgICAgIGlmICghY2FwdGNoYVByb3ZpZGVyQ29uZmlnLmJnZC5lbmFibGVkKSB7CiAgICAgICAgICAgICAgICAgIGNhcHRjaGFQcm92aWRlckNvbmZpZy5iZ2QuZW5hYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgIHZhcl81NSgiYmdkIik7CiAgICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgICAgICAgIHZhcl81NigpOwogICAgICAgICAgICAgICAgICBoYW5kbGVMb2dpbkNGU3RlcCgpOwogICAgICAgICAgICAgICAgICBhc3luY1Jlc3VsdF81NygiYmdkIik7CiAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBCR0QgQ0YgYnV0dG9uIGVuYWJsZWQsIHRpbWVyIHN0YXJ0ZWQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgaGFuZGxlTG9naW5DRlN0ZXAoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfQ0Y6CiAgICAgICAgICAgIGV4ZWN1dGVBcHBJbmZvU3RlcCgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfQVBQOgogICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUud2FpdGluZ0ZvclBlcnNvbmFsICYmIGF1dG9TZXF1ZW5jZVN0YXRlLnBlcnNvbmFsRGVsYXlTdGFydFRpbWUpIHsKICAgICAgICAgICAgICBjb25zdCBkZWxheV85ID0gRGF0ZS5ub3coKSAtIGF1dG9TZXF1ZW5jZVN0YXRlLnBlcnNvbmFsRGVsYXlTdGFydFRpbWU7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMTAgPSBhdXRvU2VxdWVuY2VTdGF0ZS5wZXJzb25hbERlbGF5RHVyYXRpb24gfHwgMjAwMDsKICAgICAgICAgICAgICBpZiAoZGVsYXlfOSA-PSBkZWxheV8xMCkgewogICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUud2FpdGluZ0ZvclBlcnNvbmFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5wZXJzb25hbERlbGF5U3RhcnRUaW1lID0gbnVsbDsKICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLnBlcnNvbmFsRGVsYXlEdXJhdGlvbiA9IG51bGw7CiAgICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX1BFUlNPTkFMOwogICAgICAgICAgICAgICAgaWYgKGNhbkF1dG9TZXF1ZW5jZVByb2NlZWQoKSkgewogICAgICAgICAgICAgICAgICBhc3luY1Jlc3VsdF81OCgpLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBQZXJzb25hbCByZXF1ZXN0IHNlbnQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnJvcl8xMSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgaW4gUGVyc29uYWwgSW5mbyBjbGljazoiLCBlcnJvcl8xMSk7CiAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFBlcnNvbmFsIHJlcXVlc3QgZmFpbGVkIiwgIiNmZjQ0NDQiKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IGRlbGF5XzExID0gTWF0aC5yb3VuZCgoZGVsYXlfMTAgLSBkZWxheV85KSAvIDEwMDApOwogICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IEFwcCBzdWNjZXNzLCB3YWl0aW5nICIgKyBkZWxheV8xMSArICJzIGJlZm9yZSBQZXJzb25hbCBzdWJtaXQgKEZhbWlseSBDb3VudDogIiArIGZhbWlseV9jb3VudCArICIpIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5hcHBTdWNjZXNzICYmICFhdXRvU2VxdWVuY2VTdGF0ZS53YWl0aW5nRm9yUGVyc29uYWwpIHsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5hcHBTdWNjZXNzID0gZmFsc2U7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMTIgPSBleGVjdXRlUGVyc29uYWxJbmZvU3RlcCgpOwogICAgICAgICAgICAgIGNvbnN0IGRlbGF5XzEzID0gTWF0aC5yb3VuZChkZWxheV8xMiAvIDEwMDApOwogICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBBcHAgc3VjY2Vzcywgd2FpdGluZyAiICsgZGVsYXlfMTMgKyAicyBiZWZvcmUgUGVyc29uYWwgc3VibWl0IChGYW1pbHkgQ291bnQ6ICIgKyBmYW1pbHlfY291bnQgKyAiKSIsICIjRkZENzAwIik7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUud2FpdGluZ0ZvclBlcnNvbmFsID0gdHJ1ZTsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5wZXJzb25hbERlbGF5U3RhcnRUaW1lID0gRGF0ZS5ub3coKTsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5wZXJzb25hbERlbGF5RHVyYXRpb24gPSBkZWxheV8xMjsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfUEVSU09OQUw6CiAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5wZXJzb25hbFN1Y2Nlc3MpIHsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5wZXJzb25hbFN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX09WRVJWSUVXOwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfNTQgPSAxMDAwMDsKICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogUGVyc29uYWwgc3VjY2Vzcywgd2FpdGluZyAxMHMgYmVmb3JlIE92ZXJ2aWV3IGNsaWNrIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgIGlmIChjYW5BdXRvU2VxdWVuY2VQcm9jZWVkKCkgJiYgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX09WRVJWSUVXKSB7CiAgICAgICAgICAgICAgICAgIGlmIChpc0J1dHRvbkVuYWJsZWQoIm92ZXJ2aWV3LWJ0biIpKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IE92ZXJ2aWV3IGNsaWNrZWQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgdGVtcF81NCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX09WRVJWSUVXOgogICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUub3ZlcnZpZXdTdWNjZXNzKSB7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUub3ZlcnZpZXdTdWNjZXNzID0gZmFsc2U7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9TRU5EOwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfNTUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKSArIDIwMDA7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMTQgPSAodGVtcF81NSAvIDEwMDApLnRvRml4ZWQoMSk7CiAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IE92ZXJ2aWV3IHN1Y2Nlc3MgKEJvb2tpbmcgc2Vzc2lvbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSksIHdhaXRpbmcgIiArIGRlbGF5XzE0ICsgInMgYmVmb3JlIFNlbmQgT1RQIGNsaWNrIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgIGlmIChpc0J1dHRvbkVuYWJsZWQoInBheS1vdHAtYnRuIikpIHsKICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFNlbmQgT1RQIGNsaWNrZWQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIHRlbXBfNTUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib3ZlcnZpZXctYnRuIik7CiAgICAgICAgICAgICAgY29uc3QgYnV0dG9uXzEgPSBlbGVtZW50XzE4ICYmIChlbGVtZW50XzE4LmRpc2FibGVkIHx8IGVsZW1lbnRfMTgudGV4dENvbnRlbnQuaW5jbHVkZXMoIlN1Ym1pdHRpbmciKSB8fCBlbGVtZW50XzE4LnRleHRDb250ZW50LmluY2x1ZGVzKCJMb2FkaW5nIikgfHwgIWNoZWNrQnV0dG9uVGV4dENvbnRhaW5zKCJvdmVydmlldy1idG4iLCAiT3ZlcnZpZXciKSk7CiAgICAgICAgICAgICAgaWYgKGJ1dHRvbl8xKSB7CiAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogT3ZlcnZpZXcgcmVxdWVzdCBwZW5kaW5nLCB3YWl0aW5nIGZvciBzdWNjZXNzLi4uIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoZWNrQnV0dG9uVGV4dENvbnRhaW5zKCJvdmVydmlldy1idG4iLCAiT3ZlcnZpZXciKSkgewogICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFdhaXRpbmcgZm9yIE92ZXJ2aWV3IHJlc3BvbnNlIGNvbmZpcm1hdGlvbi4uLiIsICIjRkZENzAwIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9TRU5EOgogICAgICAgICAgICBpZiAoY2hlY2tCdXR0b25UZXh0Q29udGFpbnMoInBheS1vdHAtYnRuIiwgIlNlbnQiKSkgewogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfV0FJVF9WRVJJRlk7CiAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFNlbmQgT1RQIHN1Y2Nlc3MsIHdhaXRpbmcgZm9yIG1hbnVhbCBPVFAgZW50cnkgYW5kIFZlcmlmeSBjbGljayIsICIjRkZENzAwIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX1dBSVRfVkVSSUZZOgogICAgICAgICAgICBjb25zdCBlbGVtZW50XzE5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheS12ZXJpZnktYnRuIik7CiAgICAgICAgICAgIGlmIChlbGVtZW50XzE5ICYmIChlbGVtZW50XzE5LnRleHRDb250ZW50LmluY2x1ZGVzKCLinJMiKSB8fCBlbGVtZW50XzE5LnRleHRDb250ZW50LmluY2x1ZGVzKCJWZXJpZmllZCIpKSkgewogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfR0VUX1NMT1Q7CiAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFZlcmlmeSBzdWNjZXNzLCBzd2l0Y2hpbmcgdG8gUGF5IFRhYiIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBjbGlja0J1dHRvbigicGF5Iik7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8yMCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHBvaW50bWVudF9kYXRlIik7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfNTYgPSBlbGVtZW50XzIwICYmIGVsZW1lbnRfMjAudmFsdWUgJiYgL15cZHs0fS1cZHsyfS1cZHsyfSQvLnRlc3QoZWxlbWVudF8yMC52YWx1ZS50cmltKCkpOwogICAgICAgICAgICAgICAgICBpZiAodGVtcF81NikgewogICAgICAgICAgICAgICAgICAgIGlmIChpc0J1dHRvbkVuYWJsZWQoImdldC10aW1lLXNsb3QtYnRuIikpIHsKICAgICAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBHZXQgU2xvdCBjbGlja2VkIChkYXRlIGF2YWlsYWJsZSkiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogUGxlYXNlIGVudGVyIGRhdGUgKFlZWVktTU0tREQpIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICAgICAgICBvYnNlcnZlRGF0ZUlucHV0KCJhcHBvaW50bWVudF9kYXRlIiwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbkF1dG9TZXF1ZW5jZVByb2NlZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNCdXR0b25FbmFibGVkKCJnZXQtdGltZS1zbG90LWJ0biIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogR2V0IFNsb3QgY2xpY2tlZCAoZGF0ZSBlbnRlcmVkKSIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgMjAwMCk7CiAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIEFVVE9fU0VRVUVOQ0VfU1RFUFMuUEFZX0dFVF9TTE9UOgogICAgICAgICAgICBjb25zdCBlbGVtZW50XzIxID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdldC10aW1lLXNsb3QtYnRuIik7CiAgICAgICAgICAgIGlmIChlbGVtZW50XzIxICYmIChlbGVtZW50XzIxLnRleHRDb250ZW50LmluY2x1ZGVzKCLinJMiKSB8fCBlbGVtZW50XzIxLnRleHRDb250ZW50LmluY2x1ZGVzKCJTbG90IEZvdW5kIikpKSB7CiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8yMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHBvaW50bWVudF90aW1lIik7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF81NyA9IGVsZW1lbnRfMjIgJiYgZWxlbWVudF8yMi52YWx1ZSAmJiBlbGVtZW50XzIyLnZhbHVlICE9PSAiIjsKICAgICAgICAgICAgICBpZiAodGVtcF81NykgewogICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9DQVBUQ0hBOwogICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8yMyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktY2FwdGNoYS1tb2RhbCIpOwogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRfMjMpIHsKICAgICAgICAgICAgICAgICAgZWxlbWVudF8yMy5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IEdldCBTbG90IHN1Y2Nlc3Mgd2l0aCB0aW1lLCBjYXB0Y2hhIHBvcHVwIG9wZW5lZCwgd2FpdGluZyBmb3IgbWFudWFsIHNvbHZlIiwgIiNGRkQ3MDAiKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9TRVRfVElNRTsKICAgICAgICAgICAgICAgIGlmIChpc0J1dHRvbkVuYWJsZWQoInNldC10aW1lLWJ0biIpKSB7CiAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBTZXQgVGltZSBjbGlja2VkIChubyB0aW1lIHNsb3QpIiwgIiMwMEZGMDAiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIEFVVE9fU0VRVUVOQ0VfU1RFUFMuUEFZX1NFVF9USU1FOgogICAgICAgICAgICBjb25zdCBlbGVtZW50XzI0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNldC10aW1lLWJ0biIpOwogICAgICAgICAgICBpZiAoZWxlbWVudF8yNCAmJiAoZWxlbWVudF8yNC50ZXh0Q29udGVudC5pbmNsdWRlcygi4pyTIikgfHwgZWxlbWVudF8yNC50ZXh0Q29udGVudC5pbmNsdWRlcygiU2V0IERvbmUiKSB8fCBlbGVtZW50XzI0LnRleHRDb250ZW50LmluY2x1ZGVzKCJTZXQg4pyTIikpKSB7CiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8yNSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHBvaW50bWVudF90aW1lIik7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF81OCA9IGVsZW1lbnRfMjUgJiYgZWxlbWVudF8yNS52YWx1ZSAmJiBlbGVtZW50XzI1LnZhbHVlICE9PSAiIjsKICAgICAgICAgICAgICBpZiAodGVtcF81OCkgewogICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9DQVBUQ0hBOwogICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8yNiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktY2FwdGNoYS1tb2RhbCIpOwogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRfMjYpIHsKICAgICAgICAgICAgICAgICAgZWxlbWVudF8yNi5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFNldCBUaW1lIHN1Y2Nlc3MsIGNhcHRjaGEgcG9wdXAgb3BlbmVkLCB3YWl0aW5nIGZvciBtYW51YWwgc29sdmUiLCAiI0ZGRDcwMCIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfQ0FQVENIQToKICAgICAgICAgICAgY29uc3QgZWxlbWVudF8yNyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktY2FwdGNoYS12ZXJpZnktYnRuIik7CiAgICAgICAgICAgIGlmIChlbGVtZW50XzI3ICYmIChlbGVtZW50XzI3LnRleHRDb250ZW50LmluY2x1ZGVzKCLinJMiKSB8fCBlbGVtZW50XzI3LnRleHRDb250ZW50LmluY2x1ZGVzKCJWZXJpZmllZCIpKSkgewogICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfV0FJVF9QQVlfTk9XOwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfNTkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKSArIDIwMDA7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMTUgPSAodGVtcF81OSAvIDEwMDApLnRvRml4ZWQoMSk7CiAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IENhcHRjaGEgdmVyaWZpZWQgc3VjY2Vzc2Z1bGx5LCB3YWl0aW5nICIgKyBkZWxheV8xNSArICJzIGJlZm9yZSBQYXkgTm93IiwgIiMwMEZGMDAiKTsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5wYXlOb3dUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgaWYgKGNhbkF1dG9TZXF1ZW5jZVByb2NlZWQoKSAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfV0FJVF9QQVlfTk9XKSB7CiAgICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfTk9XOwogICAgICAgICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICAgICAgICAgIHNldEF1dG9TZXF1ZW5jZUVuYWJsZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBQYXkgTm93IHRyaWdnZXJlZCAtIEFTIGJ1dHRvbiB0dXJuZWQgb2ZmIiwgIiMwMEZGMDAiKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoaXNCdXR0b25FbmFibGVkKCJwYXktbm93IikpIHsKICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogUGF5IE5vdyBjbGlja2VkIiwgIiMwMEZGMDAiKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIHRlbXBfNTkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9OT1c6CiAgICAgICAgICAgIGlmIChjaGVja0J1dHRvblRleHRDb250YWlucygicGF5LW5vdyIsICJQYWlkIikpIHsKICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogUGF5IE5vdyBzdWNjZXNzIC0gQXV0byBidXR0b24gdHVybmluZyBvZmYiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgIGlmIChhdXRvUmV0cnlTdGF0ZS5lbmFibGVkKSB7CiAgICAgICAgICAgICAgICBzZXRBdXRvUmV0cnlFbmFibGVkKGZhbHNlLCAiUGF5IE5vdyBzdWNjZXNzIC0gQXV0byB0dXJuZWQgb2ZmIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJlc2V0QXV0b1NlcXVlbmNlU3RhdGUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdGltZXJDYWxsYmFja181OSgpIHsKICAgICAgICBpZiAoIWF1dG9SZXRyeVN0YXRlLmVuYWJsZWQgfHwgIWF1dG9TZXF1ZW5jZVN0YXRlLmVuYWJsZWQpIHsKICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCAhPT0gQVVUT19TRVFVRU5DRV9TVEVQUy5JRExFKSB7CiAgICAgICAgICAgIHJlc2V0QXV0b1NlcXVlbmNlU3RhdGUoKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCFpc1dpdGhpbldvcmtpbmdIb3VycygpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5JRExFKSB7CiAgICAgICAgICBpZiAoaXNDdXJyZW50VGFiQWN0aXZlKCJsb2dpbiIpKSB7CiAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9DRjsKICAgICAgICAgICAgY29udGludWVBdXRvU2VxdWVuY2UoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGludWVBdXRvU2VxdWVuY2UoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IHRpbWVyXzYgPSBudWxsOwogICAgICBmdW5jdGlvbiB2YXJfNjAoKSB7CiAgICAgICAgaWYgKHRpbWVyXzYpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJfNik7CiAgICAgICAgfQogICAgICAgIHRpbWVyXzYgPSBzZXRJbnRlcnZhbCh0aW1lckNhbGxiYWNrXzU5LCAxMDAwKTsKICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfNjEoKSB7CiAgICAgICAgaWYgKHRpbWVyXzYpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJfNik7CiAgICAgICAgICB0aW1lcl82ID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzYyKGh0bWxDb250ZW50XzYzKSB7CiAgICAgICAgY29uc3QgZWxlbWVudF8yOCA9IGh0bWxDb250ZW50XzYzID09PSAibW9iaWxlIiA_ICJtb2JpbGUtdmVyaWZ5LWJ0biIgOiBodG1sQ29udGVudF82MyA9PT0gInBhc3N3b3JkIiA_ICJhdXRoZW50aWNhdGUtYnRuIiA6IGh0bWxDb250ZW50XzYzID09PSAib3RwIiA_ICJzdWJtaXQtb3RwLWJ0biIgOiBodG1sQ29udGVudF82MyA9PT0gInBheW5vdyIgPyAiZ2V0LXRpbWUtc2xvdC1idG4iIDogaHRtbENvbnRlbnRfNjMgPT09ICJiZ2QiID8gImFwcGxpY2F0aW9uLWluZm8tYnRuIiA6IGh0bWxDb250ZW50XzYzID09PSAicGVyc29uYWwiID8gInBlcnNvbmFsLWluZm8tYnRuIiA6IGh0bWxDb250ZW50XzYzID09PSAib3ZlcnZpZXciID8gIm92ZXJ2aWV3LWJ0biIgOiBodG1sQ29udGVudF82MyA9PT0gInNlbmQiID8gInBheS1vdHAtYnRuIiA6IGh0bWxDb250ZW50XzYzID09PSAidmVyaWZ5IiA_ICJwYXktdmVyaWZ5LWJ0biIgOiBodG1sQ29udGVudF82MyA9PT0gInJlc2VuZCIgPyAicmVzZW5kLXBheS1vdHAtYnRuIiA6IGh0bWxDb250ZW50XzYzID09PSAic2V0dGltZSIgPyAic2V0LXRpbWUtYnRuIiA6IGh0bWxDb250ZW50XzYzID09PSAibG9hZCIgPyAiY2YtYnRuLXBheW5vdy1yb3ciIDogaHRtbENvbnRlbnRfNjMgPT09ICJwYXlub3didXR0b24iID8gInBheS1ub3ciIDogIiI7CiAgICAgICAgY29uc3QgZWxlbWVudF8yOSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRfMjgpOwogICAgICAgIGlmIChlbGVtZW50XzI5KSB7CiAgICAgICAgICBlbGVtZW50XzI5LnN0eWxlLmJhY2tncm91bmQgPSAiIzM5RkYxNCI7CiAgICAgICAgICBlbGVtZW50XzI5LnN0eWxlLmNvbG9yID0gIiMwMDAwMDAiOwogICAgICAgICAgZWxlbWVudF8yOS5zdHlsZS5ib3hTaGFkb3cgPSAiMCAwIDEwcHggIzM5RkYxNCI7CiAgICAgICAgICBlbGVtZW50XzI5LnRleHRDb250ZW50ID0gaHRtbENvbnRlbnRfNjMgPT09ICJtb2JpbGUiID8gIlJlZ2lzdGVyZWQg4pyTIiA6IGh0bWxDb250ZW50XzYzID09PSAicGFzc3dvcmQiID8gIkF1dGhlbnRpY2F0ZWQg4pyTIiA6IGh0bWxDb250ZW50XzYzID09PSAib3RwIiA_ICJPVFAgVmVyaWZpZWQg4pyTIiA6IGh0bWxDb250ZW50XzYzID09PSAicGF5bm93IiA_ICJTbG90IEZvdW5kIOKckyIgOiBodG1sQ29udGVudF82MyA9PT0gImJnZCIgPyAiQXBwIOKckyIgOiBodG1sQ29udGVudF82MyA9PT0gInBlcnNvbmFsIiA_ICJQZXJzb25hbCDinJMiIDogaHRtbENvbnRlbnRfNjMgPT09ICJvdmVydmlldyIgPyAiT3ZlcnZpZXcg4pyTIiA6IGh0bWxDb250ZW50XzYzID09PSAic2VuZCIgPyAiU2VudCDinJMiIDogaHRtbENvbnRlbnRfNjMgPT09ICJ2ZXJpZnkiID8gIlZlcmlmaWVkIOKckyIgOiBodG1sQ29udGVudF82MyA9PT0gInJlc2VuZCIgPyAiUmVzZW50IOKckyIgOiBodG1sQ29udGVudF82MyA9PT0gInNldHRpbWUiID8gIlNldCDinJMiIDogaHRtbENvbnRlbnRfNjMgPT09ICJsb2FkIiA_ICJMb2FkZWQg4pyTIiA6IGh0bWxDb250ZW50XzYzID09PSAicGF5bm93YnV0dG9uIiA_ICJQYWlkIOKckyIgOiAiU3VjY2VzcyDinJMiOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBldmVudEhhbmRsZXJfNjQoKSB7CiAgICAgICAgc2V0QXV0b1JldHJ5RW5hYmxlZCghYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzY1KHZhcl82NikgewogICAgICAgIGNvbnN0IHRleHRfMTIgPSB2YXJfNjYgKyAiPSI7CiAgICAgICAgY29uc3QgY291bnRfOCA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgiOyIpOwogICAgICAgIGZvciAobGV0IGNvdW50XzkgPSAwOyBjb3VudF85IDwgY291bnRfOC5sZW5ndGg7IGNvdW50XzkrKykgewogICAgICAgICAgbGV0IHRleHRfMTMgPSBjb3VudF84W2NvdW50XzldOwogICAgICAgICAgd2hpbGUgKHRleHRfMTMuY2hhckF0KDApID09PSAiICIpIHsKICAgICAgICAgICAgdGV4dF8xMyA9IHRleHRfMTMuc3Vic3RyaW5nKDEsIHRleHRfMTMubGVuZ3RoKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh0ZXh0XzEzLmluZGV4T2YodGV4dF8xMikgPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudCh0ZXh0XzEzLnN1YnN0cmluZyh0ZXh0XzEyLmxlbmd0aCwgdGV4dF8xMy5sZW5ndGgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzY3KCkgewogICAgICAgIGNvbnN0IHRlbXBfNjAgPSB7fTsKICAgICAgICBpZiAoZG9jdW1lbnQuY29va2llICYmIGRvY3VtZW50LmNvb2tpZSAhPT0gIiIpIHsKICAgICAgICAgIGNvbnN0IGNvdW50XzEwID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCI7Iik7CiAgICAgICAgICBmb3IgKGxldCBjb3VudF8xMSA9IDA7IGNvdW50XzExIDwgY291bnRfMTAubGVuZ3RoOyBjb3VudF8xMSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfNjEgPSBjb3VudF8xMFtjb3VudF8xMV0uc3BsaXQoIj0iKTsKICAgICAgICAgICAgY29uc3QgdGVtcF82MiA9IHRlbXBfNjFbMF0udHJpbSgpOwogICAgICAgICAgICBjb25zdCB0ZW1wXzYzID0gdGVtcF82MS5zbGljZSgxKS5qb2luKCI9Iik7CiAgICAgICAgICAgIHRlbXBfNjBbdGVtcF82Ml0gPSBkZWNvZGVVUklDb21wb25lbnQodGVtcF82Myk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0ZW1wXzYwOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl82OCh2YXJfNjkpIHsKICAgICAgICByZXR1cm4gdmFyXzY1KHZhcl82OSkgIT09IG51bGw7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzcwKHZhcl83MSwgdmFyXzcyID0gbnVsbCkgewogICAgICAgIGlmICh2YXJfNzE_LmRhdGEpIHsKICAgICAgICAgIGNvbnN0IGRhdGFfMyA9IHZhcl83MS5kYXRhLmFjY2Vzc190b2tlbiB8fCB2YXJfNzEuZGF0YS50b2tlbiB8fCB2YXJfNzEuZGF0YS5hdXRoX3Rva2VuIHx8IHZhcl83MS5hY2Nlc3NfdG9rZW4gfHwgdmFyXzcxLnRva2VuOwogICAgICAgICAgaWYgKGRhdGFfMykgewogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYWNjZXNzX3Rva2VuIiwgZGF0YV8zKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIvCflJEgQWNjZXNzIHRva2VuIGNvbGxlY3RlZCBmcm9tIHJlc3BvbnNlIGFuZCBzdG9yZWQiKTsKICAgICAgICAgICAgdmFyXzczKCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodmFyXzcxLmRhdGEuZW1haWwpIHsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dGhfZW1haWwiLCB2YXJfNzEuZGF0YS5lbWFpbCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodmFyXzcxLmRhdGEubmFtZSkgewogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYXV0aF9uYW1lIiwgdmFyXzcxLmRhdGEubmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodmFyXzcxLmRhdGEucGhvbmUgfHwgdmFyXzcxLmRhdGEubW9iaWxlX25vKSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJhdXRoX3Bob25lIiwgdmFyXzcxLmRhdGEucGhvbmUgfHwgdmFyXzcxLmRhdGEubW9iaWxlX25vKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHZhcl83MiAmJiB2YXJfNzIuaGVhZGVycykgewogICAgICAgICAgY29uc3QgaGVhZGVyc181ID0gdmFyXzcyLmhlYWRlcnMuZ2V0KCJBdXRob3JpemF0aW9uIikgfHwgdmFyXzcyLmhlYWRlcnMuZ2V0KCJhdXRob3JpemF0aW9uIik7CiAgICAgICAgICBpZiAoaGVhZGVyc181KSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfNjQgPSBoZWFkZXJzXzUubWF0Y2goL0JlYXJlclxzKyguKykvaSk7CiAgICAgICAgICAgIGlmICh0ZW1wXzY0ICYmIHRlbXBfNjRbMV0pIHsKICAgICAgICAgICAgICBjb25zdCB0b2tlbl80ID0gdGVtcF82NFsxXS50cmltKCk7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImFjY2Vzc190b2tlbiIsIHRva2VuXzQpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLwn5SRIEFjY2VzcyB0b2tlbiBjb2xsZWN0ZWQgZnJvbSBBdXRob3JpemF0aW9uIGhlYWRlciBhbmQgc3RvcmVkIik7CiAgICAgICAgICAgICAgdmFyXzczKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29uc3QgdG9rZW5fNSA9IHZhcl82NygpOwogICAgICAgIGNvbnNvbGUubG9nKCLwn5OLIEZvdW5kICIgKyBPYmplY3Qua2V5cyh0b2tlbl81KS5sZW5ndGggKyAiIGNvb2tpZXMiKTsKICAgICAgICBjb25zdCB0ZXh0XzE0ID0gdG9rZW5fNS5hY2Nlc3NfdG9rZW4gfHwgdG9rZW5fNS50b2tlbiB8fCB0b2tlbl81LmF1dGhfdG9rZW4gfHwgdG9rZW5fNVsiYXV0aC10b2tlbiJdIHx8IHRva2VuXzVbImFjY2Vzcy10b2tlbiJdIHx8IHRva2VuXzUuc2Vzc2lvbl90b2tlbiB8fCB0b2tlbl81WyJzZXNzaW9uLXRva2VuIl07CiAgICAgICAgaWYgKHRleHRfMTQpIHsKICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJhY2Nlc3NfdG9rZW5fY29va2llIiwgdGV4dF8xNCk7CiAgICAgICAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhY2Nlc3NfdG9rZW4iKSkgewogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYWNjZXNzX3Rva2VuIiwgdGV4dF8xNCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgQWNjZXNzIHRva2VuIGZvdW5kIGluIGNvb2tpZXMgYW5kIHN0b3JlZCIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIuKchSBBY2Nlc3MgdG9rZW4gZm91bmQgaW4gY29va2llczogIiArIHRleHRfMTQuc3Vic3RyaW5nKDAsIDIwKSArICIuLi4iKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgY291bnRfMTIgPSBPYmplY3Qua2V5cyh0b2tlbl81KTsKICAgICAgICAgIGlmIChjb3VudF8xMi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLwn5SNIEF2YWlsYWJsZSBjb29raWVzOiAiICsgY291bnRfMTIuam9pbigiLCAiKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRva2VuXzYgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiYWNjZXNzX3Rva2VuIik7CiAgICAgICAgaWYgKHRva2VuXzYpIHsKICAgICAgICAgIHZhcl83MygpOwogICAgICAgICAgY29uc29sZS5sb2coIuKchSBUb2tlbiBjb2xsZWN0aW9uIGNvbXBsZXRlIC0gUGFuZWwgdGl0bGUgdGV4dCBjb2xvciB1cGRhdGVkIHRvIE5lb24gR3JlZW4gKCMzOUZGMTQpIik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl83MygpIHsKICAgICAgICBjb25zdCB0b2tlbl83ID0gISFsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiYWNjZXNzX3Rva2VuIik7CiAgICAgICAgY29uc3QgZWxlbWVudF8zMCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC10aXRsZS10ZXh0Iik7CiAgICAgICAgaWYgKGVsZW1lbnRfMzApIHsKICAgICAgICAgIGlmICh0b2tlbl83KSB7CiAgICAgICAgICAgIGVsZW1lbnRfMzAuc3R5bGUuY29sb3IgPSAiIzM5RkYxNCI7CiAgICAgICAgICAgIGVsZW1lbnRfMzAuc3R5bGUudGV4dFNoYWRvdyA9ICIwIDAgOHB4IHJnYmEoNTcsIDI1NSwgMjAsIDAuOSkiOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZWxlbWVudF8zMC5zdHlsZS5jb2xvciA9ICIjZmZmZmZmIjsKICAgICAgICAgICAgZWxlbWVudF8zMC5zdHlsZS50ZXh0U2hhZG93ID0gIjAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMykiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfNzQoKSB7CiAgICAgICAgaWYgKCFjdXJyZW50QXBpS2V5KSB7CiAgICAgICAgICBjdXJyZW50QXBpS2V5ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQpKCk7CiAgICAgICAgfQogICAgICAgIGlmIChjdXJyZW50QXBpS2V5LnN0YXRlID09PSAic3VzcGVuZGVkIikgewogICAgICAgICAgY3VycmVudEFwaUtleS5yZXN1bWUoKS50aGVuKCgpID0-IHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkF1ZGlvIGNvbnRleHQgcmVzdW1lZCIpOwogICAgICAgICAgfSkuY2F0Y2goZXJyb3JfMTIgPT4gewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJGYWlsZWQgdG8gcmVzdW1lIGF1ZGlvIGNvbnRleHQ6IiwgZXJyb3JfMTIpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl83NSgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFjdXJyZW50QXBpS2V5KSB7CiAgICAgICAgICAgIHZhcl83NCgpOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgdGVtcF82NSA9IGN1cnJlbnRBcGlLZXkuY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgY29uc3QgdGVtcF82NiA9IGN1cnJlbnRBcGlLZXkuY3JlYXRlR2FpbigpOwogICAgICAgICAgdGVtcF82NS5jb25uZWN0KHRlbXBfNjYpOwogICAgICAgICAgdGVtcF82Ni5jb25uZWN0KGN1cnJlbnRBcGlLZXkuZGVzdGluYXRpb24pOwogICAgICAgICAgdGVtcF82NS50eXBlID0gInNpbmUiOwogICAgICAgICAgdGVtcF82NS5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoMTAwMCwgY3VycmVudEFwaUtleS5jdXJyZW50VGltZSk7CiAgICAgICAgICB0ZW1wXzY2LmdhaW4uc2V0VmFsdWVBdFRpbWUoMC4zLCBjdXJyZW50QXBpS2V5LmN1cnJlbnRUaW1lKTsKICAgICAgICAgIHRlbXBfNjUuc3RhcnQoKTsKICAgICAgICAgIHRlbXBfNjUuc3RvcChjdXJyZW50QXBpS2V5LmN1cnJlbnRUaW1lICsgMSk7CiAgICAgICAgICBjb25zb2xlLmxvZygiUGxheWluZyBzdWNjZXNzIHNvdW5kIGZvciAxIHNlY29uZCIpOwogICAgICAgIH0gY2F0Y2ggKHZhcl83NikgewogICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgcGxheWluZyBzb3VuZDoiLCB2YXJfNzYpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB0aW1lckNhbGxiYWNrXzc3KHRpbWVyQ2FsbGJhY2tfNzggPSAxKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGN0eF8zID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQpKCk7CiAgICAgICAgICBjb25zdCB0ZW1wXzY3ID0gY3R4XzMuY3VycmVudFRpbWU7CiAgICAgICAgICBjb25zdCB0ZW1wXzY4ID0gY3R4XzMuY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgY29uc3QgdGVtcF82OSA9IGN0eF8zLmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgIGNvbnN0IHRlbXBfNzAgPSBjdHhfMy5jcmVhdGVHYWluKCk7CiAgICAgICAgICB0ZW1wXzY4LnR5cGUgPSAic2luZSI7CiAgICAgICAgICB0ZW1wXzY5LnR5cGUgPSAic2luZSI7CiAgICAgICAgICB0ZW1wXzY4LmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZSg4ODAsIHRlbXBfNjcpOwogICAgICAgICAgdGVtcF82OS5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoMTMyMCwgdGVtcF82Nyk7CiAgICAgICAgICB0ZW1wXzcwLmdhaW4uc2V0VmFsdWVBdFRpbWUoMCwgdGVtcF82Nyk7CiAgICAgICAgICB0ZW1wXzcwLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMC41LCB0ZW1wXzY3ICsgMC4wNSk7CiAgICAgICAgICB0ZW1wXzcwLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAwMSwgdGVtcF82NyArIDAuOCk7CiAgICAgICAgICB0ZW1wXzY4LmNvbm5lY3QodGVtcF83MCk7CiAgICAgICAgICB0ZW1wXzY5LmNvbm5lY3QodGVtcF83MCk7CiAgICAgICAgICB0ZW1wXzcwLmNvbm5lY3QoY3R4XzMuZGVzdGluYXRpb24pOwogICAgICAgICAgdGVtcF82OC5zdGFydCh0ZW1wXzY3KTsKICAgICAgICAgIHRlbXBfNjkuc3RhcnQodGVtcF82Nyk7CiAgICAgICAgICB0ZW1wXzY4LnN0b3AodGVtcF82NyArIDAuOCk7CiAgICAgICAgICB0ZW1wXzY5LnN0b3AodGVtcF82NyArIDAuOCk7CiAgICAgICAgICBpZiAodGltZXJDYWxsYmFja183OCA-IDEpIHsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aW1lckNhbGxiYWNrXzc3KHRpbWVyQ2FsbGJhY2tfNzggLSAxKSwgMzAwKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoICh2YXJfNzkpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIHdpdGggV2ViIEF1ZGlvIEFQSToiLCB2YXJfNzkpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfODAoKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGN0eF80ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQpKCk7CiAgICAgICAgICBjb25zdCB0ZW1wXzcxID0gY3R4XzQuY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgY29uc3QgdGVtcF83MiA9IGN0eF80LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgIGNvbnN0IHRlbXBfNzMgPSBjdHhfNC5jcmVhdGVHYWluKCk7CiAgICAgICAgICB0ZW1wXzcxLnR5cGUgPSAic2luZSI7CiAgICAgICAgICB0ZW1wXzcyLnR5cGUgPSAic3F1YXJlIjsKICAgICAgICAgIHRlbXBfNzEuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDEwMDAsIGN0eF80LmN1cnJlbnRUaW1lKTsKICAgICAgICAgIHRlbXBfNzIuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDgwMCwgY3R4XzQuY3VycmVudFRpbWUpOwogICAgICAgICAgdGVtcF83MS5mcmVxdWVuY3kuZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSg0MDAsIGN0eF80LmN1cnJlbnRUaW1lICsgMC44KTsKICAgICAgICAgIHRlbXBfNzIuZnJlcXVlbmN5LmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMzAwLCBjdHhfNC5jdXJyZW50VGltZSArIDAuOCk7CiAgICAgICAgICB0ZW1wXzczLmdhaW4uc2V0VmFsdWVBdFRpbWUoMC44LCBjdHhfNC5jdXJyZW50VGltZSk7CiAgICAgICAgICB0ZW1wXzczLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAxLCBjdHhfNC5jdXJyZW50VGltZSArIDAuOCk7CiAgICAgICAgICB0ZW1wXzcxLmNvbm5lY3QodGVtcF83Myk7CiAgICAgICAgICB0ZW1wXzcyLmNvbm5lY3QodGVtcF83Myk7CiAgICAgICAgICB0ZW1wXzczLmNvbm5lY3QoY3R4XzQuZGVzdGluYXRpb24pOwogICAgICAgICAgdGVtcF83MS5zdGFydCgpOwogICAgICAgICAgdGVtcF83Mi5zdGFydCgpOwogICAgICAgICAgdGVtcF83MS5zdG9wKGN0eF80LmN1cnJlbnRUaW1lICsgMC44KTsKICAgICAgICAgIHRlbXBfNzIuc3RvcChjdHhfNC5jdXJyZW50VGltZSArIDAuOCk7CiAgICAgICAgfSBjYXRjaCAodmFyXzgxKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQ291bGRuJ3QgcGxheSBzb3VuZDoiLCB2YXJfODEpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfODIoKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGN0eF81ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQpKCk7CiAgICAgICAgICBjb25zdCB0ZW1wXzc0ID0gY3R4XzUuY3JlYXRlT3NjaWxsYXRvcigpOwogICAgICAgICAgY29uc3QgdGVtcF83NSA9IGN0eF81LmNyZWF0ZUdhaW4oKTsKICAgICAgICAgIHRlbXBfNzQudHlwZSA9ICJzcXVhcmUiOwogICAgICAgICAgdGVtcF83NC5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoNTIzLjI1LCBjdHhfNS5jdXJyZW50VGltZSk7CiAgICAgICAgICB0ZW1wXzc0LmZyZXF1ZW5jeS5zZXRWYWx1ZUF0VGltZSg2NTkuMjUsIGN0eF81LmN1cnJlbnRUaW1lICsgMC4xKTsKICAgICAgICAgIHRlbXBfNzQuZnJlcXVlbmN5LnNldFZhbHVlQXRUaW1lKDc4My45OSwgY3R4XzUuY3VycmVudFRpbWUgKyAwLjIpOwogICAgICAgICAgdGVtcF83NS5nYWluLnNldFZhbHVlQXRUaW1lKDAuNSwgY3R4XzUuY3VycmVudFRpbWUpOwogICAgICAgICAgdGVtcF83NS5nYWluLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUoMC4wMSwgY3R4XzUuY3VycmVudFRpbWUgKyAwLjMpOwogICAgICAgICAgdGVtcF83NC5jb25uZWN0KHRlbXBfNzUpOwogICAgICAgICAgdGVtcF83NS5jb25uZWN0KGN0eF81LmRlc3RpbmF0aW9uKTsKICAgICAgICAgIHRlbXBfNzQuc3RhcnQoKTsKICAgICAgICAgIHRlbXBfNzQuc3RvcChjdHhfNS5jdXJyZW50VGltZSArIDAuMyk7CiAgICAgICAgfSBjYXRjaCAodmFyXzgzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQ291bGRuJ3QgcGxheSBzb3VuZDoiLCB2YXJfODMpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfODQoYXJyYXlJdGVtXzg1LCBkYXRldGltZV84NikgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBjdHhfNiA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpOwogICAgICAgICAgY29uc3QgdGVtcF83NiA9IGN0eF82LmNyZWF0ZU9zY2lsbGF0b3IoKTsKICAgICAgICAgIGNvbnN0IHRlbXBfNzcgPSBjdHhfNi5jcmVhdGVHYWluKCk7CiAgICAgICAgICB0ZW1wXzc2LnR5cGUgPSAic2luZSI7CiAgICAgICAgICBsZXQgdGVtcF83OCA9IGN0eF82LmN1cnJlbnRUaW1lOwogICAgICAgICAgYXJyYXlJdGVtXzg1LmZvckVhY2goaXRlbV82ID0-IHsKICAgICAgICAgICAgdGVtcF83Ni5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUoaXRlbV82LCB0ZW1wXzc4KTsKICAgICAgICAgICAgdGVtcF83OCArPSAwLjE7CiAgICAgICAgICB9KTsKICAgICAgICAgIHRlbXBfNzcuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgxLCBjdHhfNi5jdXJyZW50VGltZSk7CiAgICAgICAgICB0ZW1wXzc3LmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgwLjAxLCBjdHhfNi5jdXJyZW50VGltZSArIGRhdGV0aW1lXzg2KTsKICAgICAgICAgIHRlbXBfNzYuY29ubmVjdCh0ZW1wXzc3KTsKICAgICAgICAgIHRlbXBfNzcuY29ubmVjdChjdHhfNi5kZXN0aW5hdGlvbik7CiAgICAgICAgICB0ZW1wXzc2LnN0YXJ0KCk7CiAgICAgICAgICB0ZW1wXzc2LnN0b3AoY3R4XzYuY3VycmVudFRpbWUgKyBkYXRldGltZV84Nik7CiAgICAgICAgfSBjYXRjaCAodmFyXzg3KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQ291bGRuJ3QgcGxheSBzb3VuZDoiLCB2YXJfODcpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBzdG9wQWxsT3BlcmF0aW9ucygpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdmFyXzg0KFs4MDAsIDQwMCwgOTAwLCA0NTAsIDEwMDAsIDUwMF0sIDAuNik7CiAgICAgICAgICBjb25zb2xlLmxvZygi8J-UiiBTaG9ydCBhbWJ1bGFuY2Ugc291bmQgYWxlcnQgcGxheWVkIik7CiAgICAgICAgfSBjYXRjaCAodmFyXzg4KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQ291bGRuJ3QgcGxheSB3YXJuaW5nIHNvdW5kOiIsIHZhcl84OCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl84OSh2YXJfOTApIHsKICAgICAgICBpZiAodmFyXzkwKSB7CiAgICAgICAgICBjb25zdCB0ZW1wXzc5ID0gdmFyXzkwLmNsb3Nlc3QoIiNiZ2QtY29udGVudCIpOwogICAgICAgICAgaWYgKHRlbXBfNzkpIHsKICAgICAgICAgICAgdmFyXzkwLnN0eWxlLmJhY2tncm91bmQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzRDQUY1MCwgIzhCQzM0QSkiOwogICAgICAgICAgICB2YXJfOTAuc3R5bGUuYm94U2hhZG93ID0gIlxuICAgICAgICAgICAgICAgICAgICAgICAgMCAwIDE1cHggIzRDQUY1MCxcbiAgICAgICAgICAgICAgICAgICAgICAgIDAgMCAyNXB4ICM0Q0FGNTAsXG4gICAgICAgICAgICAgICAgICAgICAgICAwIDRweCA4cHggcmdiYSgwLDAsMCwwLjMpXG4gICAgICAgICAgICAgICAgICAgICI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXJfOTAuc3R5bGUuYmFja2dyb3VuZCA9ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjRkY0MDgxLCAjRjUwMDU3KSI7CiAgICAgICAgICAgIHZhcl85MC5zdHlsZS5ib3hTaGFkb3cgPSAiXG4gICAgICAgICAgICAgICAgICAgICAgICAwIDAgMTVweCAjRkY0MDgxLFxuICAgICAgICAgICAgICAgICAgICAgICAgMCAwIDI1cHggI0ZGNDA4MSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDAgNHB4IDhweCByZ2JhKDAsMCwwLDAuMylcbiAgICAgICAgICAgICAgICAgICAgIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdXBkYXRlQnV0dG9uTG9hZGluZyhkYXRldGltZV85MSkgewogICAgICAgIGlmIChkYXRldGltZV85MSkgewogICAgICAgICAgZGF0ZXRpbWVfOTEuc3R5bGUuYmFja2dyb3VuZCA9ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjMjE5NkYzLCAjMDNBOUY0KSI7CiAgICAgICAgICBkYXRldGltZV85MS5zdHlsZS5ib3hTaGFkb3cgPSAiXG4gICAgICAgICAgICAgICAgICAgIDAgMCAxNXB4ICMyMTk2RjMsXG4gICAgICAgICAgICAgICAgICAgIDAgMCAyNXB4ICMyMTk2RjMsXG4gICAgICAgICAgICAgICAgICAgIDAgNHB4IDhweCByZ2JhKDAsMCwwLDAuMylcbiAgICAgICAgICAgICAgICAiOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiByZXNldEJ1dHRvblN0YXRlKGFzeW5jUmVzdWx0XzkyKSB7CiAgICAgICAgaWYgKGFzeW5jUmVzdWx0XzkyKSB7CiAgICAgICAgICBpZiAoYXN5bmNSZXN1bHRfOTIuaWQgPT09ICJtb2JpbGUtdmVyaWZ5LWJ0biIgfHwgYXN5bmNSZXN1bHRfOTIuaWQgPT09ICJhdXRoZW50aWNhdGUtYnRuIiB8fCBhc3luY1Jlc3VsdF85Mi5pZCA9PT0gInN1Ym1pdC1vdHAtYnRuIikgewogICAgICAgICAgICBhc3luY1Jlc3VsdF85Mi5zdHlsZS5iYWNrZ3JvdW5kID0gImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMyMTk2RjMsICMwM0E5RjQpIjsKICAgICAgICAgIH0KICAgICAgICAgIGFzeW5jUmVzdWx0XzkyLnN0eWxlLmJveFNoYWRvdyA9ICIiOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBhc3luY1Jlc3VsdF85Myhjb2xvclZhbHVlXzk0KSB7CiAgICAgICAgaWYgKGNvbG9yVmFsdWVfOTQpIHsKICAgICAgICAgIGNvbG9yVmFsdWVfOTQuc3R5bGUuYmFja2dyb3VuZCA9ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjMDBGRjAwLCAjMDBDQzAwKSI7CiAgICAgICAgICBjb2xvclZhbHVlXzk0LnN0eWxlLmJveFNoYWRvdyA9ICJcbiAgICAgICAgICAgICAgICAgICAgMCAwIDE1cHggIzAwRkYwMCxcbiAgICAgICAgICAgICAgICAgICAgMCAwIDI1cHggIzAwRkYwMCxcbiAgICAgICAgICAgICAgICAgICAgMCA0cHggOHB4IHJnYmEoMCwwLDAsMC4zKVxuICAgICAgICAgICAgICAgICI7CiAgICAgICAgICBjb2xvclZhbHVlXzk0LnN0eWxlLmNvbG9yID0gIiMwMDAwMDAiOwogICAgICAgICAgdmFyXzc1KCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGNvbnN0IGVsZW1lbnRfMzEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF8zMS5pZCA9ICJtdWx0aS10b29scy1jb250YWluZXIiOwogICAgICBlbGVtZW50XzMxLmNsYXNzTmFtZSA9ICJtdC1jb250YWluZXIiOwogICAgICBjb25zdCBlbGVtZW50XzMyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfMzIuY2xhc3NOYW1lID0gIm10LXRpdGxlLWJhciI7CiAgICAgIGNvbnN0IGVsZW1lbnRfMzMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF8zMy5pZCA9ICJtdC10aXRsZS10ZXh0IjsKICAgICAgZWxlbWVudF8zMy5jbGFzc05hbWUgPSAibXQtdGl0bGUiOwogICAgICBlbGVtZW50XzMzLmlubmVySFRNTCA9ICLwn6aFIEZBTENPTiBQUk8iOwogICAgICBjb25zdCBlbGVtZW50XzM0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfMzQuaWQgPSAidGl0bGUtdGltZXItZGlzcGxheSI7CiAgICAgIGVsZW1lbnRfMzQuY2xhc3NOYW1lID0gIm10LXRpdGxlLXRpbWVyIjsKICAgICAgZWxlbWVudF8zNC50ZXh0Q29udGVudCA9ICIwcyI7CiAgICAgIGNvbnN0IGVsZW1lbnRfMzUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF8zNS5jbGFzc05hbWUgPSAibXQtY29udHJvbHMiOwogICAgICBjb25zdCBlbGVtZW50XzM2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgIGVsZW1lbnRfMzYuY2xhc3NOYW1lID0gIm10LWJ0bi1taW5pbWl6ZSI7CiAgICAgIGVsZW1lbnRfMzYuaW5uZXJIVE1MID0gIuKIkiI7CiAgICAgIGNvbnN0IGVsZW1lbnRfMzcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgZWxlbWVudF8zNy5jbGFzc05hbWUgPSAibXQtYnRuLWNsb3NlIjsKICAgICAgZWxlbWVudF8zNy5pbm5lckhUTUwgPSAiw5ciOwogICAgICBlbGVtZW50XzM1LmFwcGVuZENoaWxkKGVsZW1lbnRfMzYpOwogICAgICBlbGVtZW50XzM1LmFwcGVuZENoaWxkKGVsZW1lbnRfMzcpOwogICAgICBlbGVtZW50XzMyLmFwcGVuZENoaWxkKGVsZW1lbnRfMzMpOwogICAgICBlbGVtZW50XzMyLmFwcGVuZENoaWxkKGVsZW1lbnRfMzQpOwogICAgICBlbGVtZW50XzMyLmFwcGVuZENoaWxkKGVsZW1lbnRfMzUpOwogICAgICBjb25zdCBlbGVtZW50XzM4ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfMzguY2xhc3NOYW1lID0gIm10LXRhYnMtY29udGFpbmVyIjsKICAgICAgY29uc3QgdGVtcF84MCA9IChwYXJhbV8xMSwgdmFyXzk1ID0gZmFsc2UpID0-IHsKICAgICAgICBjb25zdCBlbGVtZW50XzM5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgICAgZWxlbWVudF8zOS5jbGFzc0xpc3QuYWRkKCJ0YWIiLCAibmVvbi10YWIiLCAiaW5hY3RpdmUtdGFiIik7CiAgICAgICAgZWxlbWVudF8zOS5pbm5lckhUTUwgPSAiPHNwYW4gY2xhc3M9XCJ0YWItbGFiZWxcIj4iICsgcGFyYW1fMTEgKyAiPC9zcGFuPiI7CiAgICAgICAgaWYgKHZhcl85NSkgewogICAgICAgICAgZWxlbWVudF8zOS5jbGFzc0xpc3QuYWRkKCJhY3RpdmUiLCAiYWN0aXZlLXRhYiIpOwogICAgICAgICAgZWxlbWVudF8zOS5jbGFzc0xpc3QucmVtb3ZlKCJpbmFjdGl2ZS10YWIiKTsKICAgICAgICB9CiAgICAgICAgZWxlbWVudF8zOS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0-IHsKICAgICAgICAgIGNvbnN0IGNvbmZpZ18xID0gY3VycmVudFRhYjsKICAgICAgICAgIGlmIChjb25maWdfMSAmJiBjb25maWdfMSAhPT0gZWxlbWVudF8zOS5nZXRBdHRyaWJ1dGUoImRhdGEtdGFiIikpIHsKICAgICAgICAgICAgY2FwdGNoYVByb3ZpZGVyQ29uZmlnW2NvbmZpZ18xXS5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICAgIGNhcHRjaGFQcm92aWRlckNvbmZpZ1tjb25maWdfMV0udG9rZW4gPSAiIjsKICAgICAgICAgICAgdmFyXzU1KGNvbmZpZ18xKTsKICAgICAgICAgIH0KICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIiNtdWx0aS10b29scy1jb250YWluZXIgLnRhYiIpLmZvckVhY2goaXRlbV83ID0-IHsKICAgICAgICAgICAgaXRlbV83LmNsYXNzTGlzdC5yZW1vdmUoImFjdGl2ZSIsICJhY3RpdmUtdGFiIik7CiAgICAgICAgICAgIGl0ZW1fNy5jbGFzc0xpc3QuYWRkKCJpbmFjdGl2ZS10YWIiKTsKICAgICAgICAgIH0pOwogICAgICAgICAgZWxlbWVudF8zOS5jbGFzc0xpc3QuYWRkKCJhY3RpdmUiLCAiYWN0aXZlLXRhYiIpOwogICAgICAgICAgZWxlbWVudF8zOS5jbGFzc0xpc3QucmVtb3ZlKCJpbmFjdGl2ZS10YWIiKTsKICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIiNtdWx0aS10b29scy1jb250YWluZXIgLnRhYi1jb250ZW50IikuZm9yRWFjaChpdGVtXzggPT4gewogICAgICAgICAgICBpdGVtXzguc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgaXRlbV84LmNsYXNzTGlzdC5yZW1vdmUoImFjdGl2ZSIpOwogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzQwID0gZWxlbWVudF8zOS5nZXRBdHRyaWJ1dGUoImRhdGEtY29udGVudCIpOwogICAgICAgICAgY29uc3QgZWxlbWVudF80MSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRfNDApOwogICAgICAgICAgaWYgKGVsZW1lbnRfNDEpIHsKICAgICAgICAgICAgZWxlbWVudF80MS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgICAgZWxlbWVudF80MS5jbGFzc0xpc3QuYWRkKCJhY3RpdmUiKTsKICAgICAgICAgIH0KICAgICAgICAgIGN1cnJlbnRUYWIgPSBlbGVtZW50XzM5LmdldEF0dHJpYnV0ZSgiZGF0YS10YWIiKTsKICAgICAgICAgIHZhcl81NShjdXJyZW50VGFiKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZWxlbWVudF8zOTsKICAgICAgfTsKICAgICAgY29uc3QgZGF0YV80ID0gdGVtcF84MCgiTG9naW4iLCB0cnVlKTsKICAgICAgY29uc3QgZGF0YV81ID0gdGVtcF84MCgiQkdEIik7CiAgICAgIGNvbnN0IGRhdGFfNiA9IHRlbXBfODAoIlBheSIpOwogICAgICBkYXRhXzQuc2V0QXR0cmlidXRlKCJkYXRhLWNvbnRlbnQiLCAibG9naW4tY29udGVudCIpOwogICAgICBkYXRhXzQuc2V0QXR0cmlidXRlKCJkYXRhLXRhYiIsICJsb2dpbiIpOwogICAgICBkYXRhXzUuc2V0QXR0cmlidXRlKCJkYXRhLWNvbnRlbnQiLCAiYmdkLWNvbnRlbnQiKTsKICAgICAgZGF0YV81LnNldEF0dHJpYnV0ZSgiZGF0YS10YWIiLCAiYmdkIik7CiAgICAgIGRhdGFfNi5zZXRBdHRyaWJ1dGUoImRhdGEtY29udGVudCIsICJwYXlub3ctY29udGVudCIpOwogICAgICBkYXRhXzYuc2V0QXR0cmlidXRlKCJkYXRhLXRhYiIsICJwYXkiKTsKICAgICAgZWxlbWVudF8zOC5hcHBlbmRDaGlsZChkYXRhXzQpOwogICAgICBlbGVtZW50XzM4LmFwcGVuZENoaWxkKGRhdGFfNSk7CiAgICAgIGVsZW1lbnRfMzguYXBwZW5kQ2hpbGQoZGF0YV82KTsKICAgICAgY29uc3QgZWxlbWVudF80MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzQyLmlkID0gInN0YXR1cy1wYW5lbCI7CiAgICAgIGVsZW1lbnRfNDIuY2xhc3NOYW1lID0gIm10LXN0YXR1cy1wYW5lbCI7CiAgICAgIGVsZW1lbnRfNDIudGV4dENvbnRlbnQgPSAiUmVhZHkgISI7CiAgICAgIGNvbnN0IGVsZW1lbnRfNDMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF80My5jbGFzc05hbWUgPSAibXQtY29udGVudCI7CiAgICAgIGZ1bmN0aW9uIHZhcl85NihldmVudEhhbmRsZXJfOTcgPSAiIikgewogICAgICAgIGNvbnN0IGVsZW1lbnRfNDQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBlbGVtZW50XzQ0LmNsYXNzTmFtZSA9ICJmbGV4IG1iLW1kIjsKICAgICAgICBjb25zdCBlbGVtZW50XzQ1ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgICAgZWxlbWVudF80NS5pZCA9ICJjZi1idG4iICsgKGV2ZW50SGFuZGxlcl85NyA_ICItIiArIGV2ZW50SGFuZGxlcl85NyA6ICIiKTsKICAgICAgICBlbGVtZW50XzQ1LmNsYXNzTmFtZSA9ICJjZi1hdC1idG4gZ2xvYmFsLWNmLWJ0biBidG4taW5mbyI7CiAgICAgICAgZWxlbWVudF80NS50ZXh0Q29udGVudCA9ICJDRiI7CiAgICAgICAgZWxlbWVudF80NS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0-IGV2ZW50SGFuZGxlcl85OChldmVudEhhbmRsZXJfOTcpKTsKICAgICAgICBlbGVtZW50XzQ0LmFwcGVuZENoaWxkKGVsZW1lbnRfNDUpOwogICAgICAgIGlmIChldmVudEhhbmRsZXJfOTcgPT09ICJsb2dpbiIpIHsKICAgICAgICAgIGNvbnN0IGVsZW1lbnRfNDYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIGVsZW1lbnRfNDYuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICAgIGVsZW1lbnRfNDYuc3R5bGUuYWxpZ25JdGVtcyA9ICJjZW50ZXIiOwogICAgICAgICAgZWxlbWVudF80Ni5zdHlsZS5nYXAgPSAiNnB4IjsKICAgICAgICAgIGVsZW1lbnRfNDYuc3R5bGUuZmxleCA9ICIxIjsKICAgICAgICAgIGVsZW1lbnRfNDYuc3R5bGUubWFyZ2luTGVmdCA9ICI4cHgiOwogICAgICAgICAgY29uc3QgZWxlbWVudF80NyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgICAgICBlbGVtZW50XzQ3LnR5cGUgPSAiY2hlY2tib3giOwogICAgICAgICAgZWxlbWVudF80Ny5pZCA9ICJjYXB0Y2hhLWVuYWJsZS1jaGVja2JveCI7CiAgICAgICAgICBlbGVtZW50XzQ3LnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIjsKICAgICAgICAgIGNvbnN0IGVsZW1lbnRfNDggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwogICAgICAgICAgZWxlbWVudF80OC5pZCA9ICJtYXRoLWNhcHRjaGEtaW5wdXQiOwogICAgICAgICAgZWxlbWVudF80OC50eXBlID0gInRleHQiOwogICAgICAgICAgZWxlbWVudF80OC5jbGFzc05hbWUgPSAidG9vbC1pbnB1dC1yb3ciOwogICAgICAgICAgZWxlbWVudF80OC5wbGFjZWhvbGRlciA9ICJFbnRlciBDYXB0Y2hhIEFuc3dlciI7CiAgICAgICAgICBlbGVtZW50XzQ4LnN0eWxlLmZsZXggPSAiMSI7CiAgICAgICAgICBlbGVtZW50XzQ4LnN0eWxlLmhlaWdodCA9ICIyNHB4IjsKICAgICAgICAgIGVsZW1lbnRfNDguc3R5bGUucGFkZGluZyA9ICI0cHggOHB4IjsKICAgICAgICAgIGVsZW1lbnRfNDguc3R5bGUuZm9udFNpemUgPSAiMTBweCI7CiAgICAgICAgICBlbGVtZW50XzQ4LmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgZXZlbnRfMSA9PiB7CiAgICAgICAgICAgIGV2ZW50XzEudGFyZ2V0LnZhbHVlID0gZXZlbnRfMS50YXJnZXQudmFsdWUucmVwbGFjZSgvW14wLTldL2csICIiKTsKICAgICAgICAgIH0pOwogICAgICAgICAgZWxlbWVudF80OC5kaXNhYmxlZCA9ICFlbGVtZW50XzQ3LmNoZWNrZWQ7CiAgICAgICAgICBlbGVtZW50XzQ3LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGV2ZW50XzIgPT4gewogICAgICAgICAgICBlbGVtZW50XzQ4LmRpc2FibGVkID0gIWV2ZW50XzIudGFyZ2V0LmNoZWNrZWQ7CiAgICAgICAgICAgIGlmICghZXZlbnRfMi50YXJnZXQuY2hlY2tlZCkgewogICAgICAgICAgICAgIGVsZW1lbnRfNDgudmFsdWUgPSAiIjsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBlbGVtZW50XzQ2LmFwcGVuZENoaWxkKGVsZW1lbnRfNDcpOwogICAgICAgICAgZWxlbWVudF80Ni5hcHBlbmRDaGlsZChlbGVtZW50XzQ4KTsKICAgICAgICAgIGVsZW1lbnRfNDQuYXBwZW5kQ2hpbGQoZWxlbWVudF80Nik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlbGVtZW50XzQ0OwogICAgICB9CiAgICAgIGNvbnN0IHN0eWxlXzEgPSB7CiAgICAgICAgcHJpbWFyeTogImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM2MzY2ZjEsICM4YjVjZjYpOyIsCiAgICAgICAgd2FybmluZzogImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmNTllMGIsICNmYmJmMjQpOyIsCiAgICAgICAgZGFuZ2VyOiAiYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VmNDQ0NCwgI2Y4NzE3MSk7IiwKICAgICAgICBzdWNjZXNzOiAiYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzIyYzU1ZSwgIzRhZGU4MCk7IiwKICAgICAgICBzZWNvbmRhcnk6ICJiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZWM0ODk5LCAjZjQ3MmI2KTsiLAogICAgICAgIGdyYXk6ICJiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNjM2NmYxLCAjOGI1Y2Y2KTsiLAogICAgICAgIHNsYXRlOiAiYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VjNDg5OSwgI2Y0NzJiNik7IiwKICAgICAgICBnb2xkOiAiYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2Y1OWUwYiwgI2ZiYmYyNCk7IiwKICAgICAgICB0ZWFsOiAiYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzNiODJmNiwgIzYwYTVmYSk7IiwKICAgICAgICB2aW9sZXQ6ICJiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNjM2NmYxLCAjOGI1Y2Y2KTsiLAogICAgICAgIHB1cnBsZTogImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNlYzQ4OTksICNmNDcyYjYpOyIKICAgICAgfTsKICAgICAgY29uc3Qgc3R5bGVfMiA9IHsKICAgICAgICBwcmltYXJ5OiAiYnRuLXByaW1hcnkiLAogICAgICAgIHdhcm5pbmc6ICJidG4td2FybmluZyIsCiAgICAgICAgZGFuZ2VyOiAiYnRuLWRhbmdlciIsCiAgICAgICAgc3VjY2VzczogImJ0bi1zdWNjZXNzIiwKICAgICAgICBpbmZvOiAiYnRuLWluZm8iLAogICAgICAgIHNlY29uZGFyeTogImJ0bi1zZWNvbmRhcnkiCiAgICAgIH07CiAgICAgIGZ1bmN0aW9uIGNoaWxkRWxlbWVudF85OSh7CiAgICAgICAgaWQgPSAiIiwKICAgICAgICBjbGFzc05hbWUgPSAidG9vbC1idG4tcm93IiwKICAgICAgICB0ZXh0ID0gIiIsCiAgICAgICAgc3R5bGUgPSAiIiwKICAgICAgICBzdHlsZUNsYXNzID0gIiIsCiAgICAgICAgaHRtbCA9ICIiCiAgICAgIH0gPSB7fSkgewogICAgICAgIGNvbnN0IGVsZW1lbnRfNDkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgICBpZiAoaWQpIHsKICAgICAgICAgIGVsZW1lbnRfNDkuaWQgPSBpZDsKICAgICAgICB9CiAgICAgICAgY29uc3Qgc3R5bGVfMyA9IHN0eWxlQ2xhc3MgPyBjbGFzc05hbWUgKyAiICIgKyBzdHlsZUNsYXNzIDogY2xhc3NOYW1lOwogICAgICAgIGVsZW1lbnRfNDkuY2xhc3NOYW1lID0gc3R5bGVfMzsKICAgICAgICBpZiAodGV4dCkgewogICAgICAgICAgZWxlbWVudF80OS50ZXh0Q29udGVudCA9IHRleHQ7CiAgICAgICAgfQogICAgICAgIGlmIChodG1sKSB7CiAgICAgICAgICBlbGVtZW50XzQ5LmlubmVySFRNTCA9IGh0bWw7CiAgICAgICAgfQogICAgICAgIGlmIChzdHlsZSkgewogICAgICAgICAgZWxlbWVudF80OS5zdHlsZS5jc3NUZXh0ID0gc3R5bGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlbGVtZW50XzQ5OwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGNoaWxkRWxlbWVudF8xMDAoewogICAgICAgIGlkID0gIiIsCiAgICAgICAgY2xhc3NOYW1lID0gInRvb2wtaW5wdXQtcm93IiwKICAgICAgICBwbGFjZWhvbGRlciA9ICIiLAogICAgICAgIHR5cGUgPSAidGV4dCIsCiAgICAgICAgdmFsdWUgPSAiIiwKICAgICAgICBleHRyYVN0eWxlcyA9ICIiCiAgICAgIH0gPSB7fSkgewogICAgICAgIGNvbnN0IGVsZW1lbnRfNTAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwogICAgICAgIGlmIChpZCkgewogICAgICAgICAgZWxlbWVudF81MC5pZCA9IGlkOwogICAgICAgIH0KICAgICAgICBlbGVtZW50XzUwLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTsKICAgICAgICBlbGVtZW50XzUwLnR5cGUgPSB0eXBlOwogICAgICAgIGVsZW1lbnRfNTAucGxhY2Vob2xkZXIgPSBwbGFjZWhvbGRlcjsKICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgIGVsZW1lbnRfNTAudmFsdWUgPSB2YWx1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGV4dHJhU3R5bGVzKSB7CiAgICAgICAgICBlbGVtZW50XzUwLnN0eWxlLmNzc1RleHQgPSBleHRyYVN0eWxlczsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGVsZW1lbnRfNTA7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzEwMSgpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgZWxlbWVudF81MS5jbGFzc05hbWUgPSAiZmxleCBtYi1tZCI7CiAgICAgICAgY29uc3QgZWxlbWVudF81MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgIGVsZW1lbnRfNTIuaWQgPSAiY2ZwLWJ0bi1wYXlub3ctcm93IjsKICAgICAgICBlbGVtZW50XzUyLmNsYXNzTmFtZSA9ICJjZi1hdC1idG4gZ2xvYmFsLWNmcC1idG4gYnRuLWluZm8iOwogICAgICAgIGVsZW1lbnRfNTIudGV4dENvbnRlbnQgPSAiQ0YiOwogICAgICAgIGVsZW1lbnRfNTIuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiBldmVudEhhbmRsZXJfOTgoInBheSIpKTsKICAgICAgICBlbGVtZW50XzUxLmFwcGVuZENoaWxkKGVsZW1lbnRfNTIpOwogICAgICAgIHJldHVybiBlbGVtZW50XzUxOwogICAgICB9CiAgICAgIGFzeW5jIGZ1bmN0aW9uIGFzeW5jUmVzdWx0XzU3KGFzeW5jUmVzdWx0XzEwMikgewogICAgICAgIGNhcHRjaGFTdGF0ZS5zb2x2aW5nID0gdHJ1ZTsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiU29sdmluZyBDQVBUQ0hBLi4uIiwgIiMwMEJDRDQiKTsKICAgICAgICB2YXJfNTUoYXN5bmNSZXN1bHRfMTAyKTsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc29sZS5sb2coIkNyZWF0aW5nIENBUFRDSEEgdGFzay4uLiIpOwogICAgICAgICAgY29uc3QgZGF0YV83ID0gewogICAgICAgICAgICBjbGllbnRLZXk6IGNhcHNvbHZlckFwaUtleSwKICAgICAgICAgICAgdGFzazogewogICAgICAgICAgICAgIHR5cGU6ICJBbnRpVHVybnN0aWxlVGFza1Byb3h5bGVzcyIsCiAgICAgICAgICAgICAgd2Vic2l0ZVVSTDogd2luZG93LmxvY2F0aW9uLmhyZWYsCiAgICAgICAgICAgICAgd2Vic2l0ZUtleTogZ2V0U2l0ZUtleShhc3luY1Jlc3VsdF8xMDIpCiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICBjb25zb2xlLmxvZygiVGFzayBkYXRhOiIsIEpTT04uc3RyaW5naWZ5KGRhdGFfNykpOwogICAgICAgICAgY29uc3QgcmVzdWx0XzEgPSBhd2FpdCBmZXRjaCgiaHR0cHM6Ly9hcGkuY2Fwc29sdmVyLmNvbS9jcmVhdGVUYXNrIiwgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YV83KQogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zb2xlLmxvZygiQ3JlYXRlIHRhc2sgcmVzcG9uc2Ugc3RhdHVzOiIsIHJlc3VsdF8xLnN0YXR1cyk7CiAgICAgICAgICBjb25zdCByZXN1bHRfMiA9IGF3YWl0IHJlc3VsdF8xLmpzb24oKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJDcmVhdGUgdGFzayByZXN1bHQ6IiwgcmVzdWx0XzIpOwogICAgICAgICAgaWYgKHJlc3VsdF8yLmVycm9ySWQgIT09IDApIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiQ3JlYXRlIHRhc2sgZXJyb3I6IiwgcmVzdWx0XzIuZXJyb3JEZXNjcmlwdGlvbik7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXN1bHRfMi5lcnJvckRlc2NyaXB0aW9uKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHRlbXBfODEgPSByZXN1bHRfMi50YXNrSWQ7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQ0FQVENIQSB0YXNrIGNyZWF0ZWQiLCAiIzAwQkNENCIpOwogICAgICAgICAgY29uc3QgdGVtcF84MiA9IDYwOwogICAgICAgICAgbGV0IHRlbXBfODMgPSAwOwogICAgICAgICAgbGV0IHRva2VuXzggPSBudWxsOwogICAgICAgICAgY29uc29sZS5sb2coIlN0YXJ0aW5nIHRvIHBvbGwgZm9yIHNvbHV0aW9uLi4uIik7CiAgICAgICAgICB3aGlsZSAodGVtcF84MyA8IHRlbXBfODIgJiYgIXRva2VuXzgpIHsKICAgICAgICAgICAgdGVtcF84MysrOwogICAgICAgICAgICBjb25zb2xlLmxvZygiUG9sbGluZyBhdHRlbXB0ICIgKyB0ZW1wXzgzICsgIi8iICsgdGVtcF84Mik7CiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHBhcmFtXzEyID0-IHsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KHBhcmFtXzEyLCA1MDAwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfODQgPSB7CiAgICAgICAgICAgICAgY2xpZW50S2V5OiBjYXBzb2x2ZXJBcGlLZXksCiAgICAgICAgICAgICAgdGFza0lkOiB0ZW1wXzgxCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNvbnN0IHRleHRfMTUgPSB0ZW1wXzg0OwogICAgICAgICAgICBjb25zb2xlLmxvZygiR2V0dGluZyB0YXNrIHJlc3VsdC4uLiIpOwogICAgICAgICAgICBjb25zdCByZXN1bHRfMyA9IGF3YWl0IGZldGNoKCJodHRwczovL2FwaS5jYXBzb2x2ZXIuY29tL2dldFRhc2tSZXN1bHQiLCB7CiAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodGV4dF8xNSkKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJHZXQgcmVzdWx0IHJlc3BvbnNlIHN0YXR1czoiLCByZXN1bHRfMy5zdGF0dXMpOwogICAgICAgICAgICBjb25zdCByZXN1bHRfNCA9IGF3YWl0IHJlc3VsdF8zLmpzb24oKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIkdldCByZXN1bHQ6IiwgcmVzdWx0XzQpOwogICAgICAgICAgICBpZiAocmVzdWx0XzQuZXJyb3JJZCAhPT0gMCkgewogICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkdldCByZXN1bHQgZXJyb3I6IiwgcmVzdWx0XzQuZXJyb3JEZXNjcmlwdGlvbik7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3VsdF80LmVycm9yRGVzY3JpcHRpb24pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChyZXN1bHRfNC5zdGF0dXMgPT09ICJyZWFkeSIpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiU29sdXRpb24gZm91bmQ6IiwgcmVzdWx0XzQuc29sdXRpb24pOwogICAgICAgICAgICAgIHRva2VuXzggPSByZXN1bHRfNC5zb2x1dGlvbjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHRfNC5zdGF0dXMgPT09ICJwcm9jZXNzaW5nIikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJUYXNrIHN0aWxsIHByb2Nlc3NpbmcuLi4iKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJVbmV4cGVjdGVkIHN0YXR1czoiLCByZXN1bHRfNC5zdGF0dXMpOwogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVW5leHBlY3RlZCBzdGF0dXM6ICIgKyByZXN1bHRfNC5zdGF0dXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXRva2VuXzgpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiQ0FQVENIQSBzb2x2aW5nIHRpbWVvdXQiKTsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDQVBUQ0hBIHNvbHZpbmcgdGltZW91dCIpOwogICAgICAgICAgfQogICAgICAgICAgY2FwdGNoYVN0YXRlLnRva2VuID0gdG9rZW5fOC50b2tlbjsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS5jZlRva2VuID0gdG9rZW5fOC50b2tlbjsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS5zb2x1dGlvbiA9IHRva2VuXzg7CiAgICAgICAgICBjYXB0Y2hhU3RhdGUuc29sdmVkID0gdHJ1ZTsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS5zb2x2aW5nID0gZmFsc2U7CiAgICAgICAgICBjYXB0Y2hhUHJvdmlkZXJDb25maWdbYXN5bmNSZXN1bHRfMTAyXS50b2tlbiA9IHRva2VuXzgudG9rZW47CiAgICAgICAgICB2YXJfMTAzKHRva2VuXzgudG9rZW4pOwogICAgICAgICAgdmFyXzU1KGFzeW5jUmVzdWx0XzEwMik7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQ0FQVENIQSBTb2x2ZWQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgdmFyXzc1KCk7CiAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCAmJiBhc3luY1Jlc3VsdF8xMDIgPT09ICJsb2dpbiIgJiYgKGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID09PSBBVVRPX1NFUVVFTkNFX1NURVBTLklETEUgfHwgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuTE9HSU5fQ0YpICYmIGlzQ3VycmVudFRhYkFjdGl2ZSgibG9naW4iKSkgewogICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuTE9HSU5fQ0Y7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIGNvbnRpbnVlQXV0b1NlcXVlbmNlKCk7CiAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCAmJiBhdXRvUmV0cnlTdGF0ZS5lbmFibGVkICYmIGFzeW5jUmVzdWx0XzEwMiA9PT0gImJnZCIpIHsKICAgICAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID09PSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9DRikgewogICAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5iZ2RDZlN0YXJ0VGltZSAmJiAhYXV0b1NlcXVlbmNlU3RhdGUuYmdkQ2ZUaW1lcikgewogICAgICAgICAgICAgICAgaGFuZGxlTG9naW5DRlN0ZXAoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZXhlY3V0ZUFwcEluZm9TdGVwKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZGV0ZWN0TWFudWFsQnV0dG9uU3VjY2VzcygiY2YtYnRuLWJnZCIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKCghYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCB8fCAhYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCkgJiYgYXN5bmNSZXN1bHRfMTAyID09PSAiYmdkIiAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5tYW51YWxCZ2RDZlN0YXJ0VGltZSAmJiAhYXV0b1NlcXVlbmNlU3RhdGUubWFudWFsQmdkQ2ZUaW1lcikgewogICAgICAgICAgICBoYW5kbGVCZ2RDRkFmdGVyQXV0aCgpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKG1lc3NhZ2VfMTA0KSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJDQVBUQ0hBIHNvbHZpbmcgZXJyb3I6IiwgbWVzc2FnZV8xMDQpOwogICAgICAgICAgY2FwdGNoYVN0YXRlLnNvbHZpbmcgPSBmYWxzZTsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJDQVBUQ0hBIFNvbHZlIEZhaWxlZDogIiArIG1lc3NhZ2VfMTA0Lm1lc3NhZ2UsICIjZmY0NDQ0Iik7CiAgICAgICAgICB2YXJfNTUoYXN5bmNSZXN1bHRfMTAyKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZXZlbnRIYW5kbGVyXzk4KHN0YXRlRmxhZ18xMDUpIHsKICAgICAgICBjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzEwNV0uZW5hYmxlZCA9ICFjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzEwNV0uZW5hYmxlZDsKICAgICAgICBpZiAoY2FwdGNoYVByb3ZpZGVyQ29uZmlnW3N0YXRlRmxhZ18xMDVdLmVuYWJsZWQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJDRiB0dXJuZWQgT04gZm9yICIgKyBzdGF0ZUZsYWdfMTA1ICsgIiB0YWIgLSBTdGFydGluZyBhdXRvLXNvbHZpbmcgQ0FQVENIQSIpOwogICAgICAgICAgaWYgKHN0YXRlRmxhZ18xMDUgPT09ICJiZ2QiKSB7CiAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5lbmFibGVkICYmIGF1dG9SZXRyeVN0YXRlLmVuYWJsZWQpIHsKICAgICAgICAgICAgICBpZiAoIWF1dG9TZXF1ZW5jZVN0YXRlLmJnZENmU3RhcnRUaW1lKSB7CiAgICAgICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICAgICAgdmFyXzU2KCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5JRExFIHx8IGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwICE9PSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9DRiAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCAhPT0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfQVBQICYmIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwICE9PSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9QRVJTT05BTCAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCAhPT0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfT1ZFUlZJRVcgJiYgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgIT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX1NFTkQgJiYgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgIT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX1dBSVRfVkVSSUZZKSB7CiAgICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX0NGOwogICAgICAgICAgICAgICAgaGFuZGxlTG9naW5DRlN0ZXAoKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID09PSBBVVRPX1NFUVVFTkNFX1NURVBTLkJHRF9DRikgewogICAgICAgICAgICAgICAgaGFuZGxlTG9naW5DRlN0ZXAoKTsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuQkdEX0NGKSB7CiAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZUFwcEluZm9TdGVwKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGhhbmRsZUJnZENGQWZ0ZXJBdXRoKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGFzeW5jUmVzdWx0XzU3KHN0YXRlRmxhZ18xMDUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQ0YgdHVybmVkIE9GRiBmb3IgIiArIHN0YXRlRmxhZ18xMDUgKyAiIHRhYiAtIFN0b3BwaW5nIGF1dG8tc29sdmluZyBDQVBUQ0hBIik7CiAgICAgICAgICBjYXB0Y2hhUHJvdmlkZXJDb25maWdbc3RhdGVGbGFnXzEwNV0udG9rZW4gPSAiIjsKICAgICAgICAgIHZhcl81NShzdGF0ZUZsYWdfMTA1KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzU1KHZhcl8xMDYpIHsKICAgICAgICBsZXQgZWxlbWVudF81MzsKICAgICAgICBpZiAodmFyXzEwNiA9PT0gInBheSIpIHsKICAgICAgICAgIGVsZW1lbnRfNTMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2ZwLWJ0bi1wYXlub3ctcm93Iik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGVsZW1lbnRfNTMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2YtYnRuLSIgKyB2YXJfMTA2KTsKICAgICAgICB9CiAgICAgICAgaWYgKGVsZW1lbnRfNTMpIHsKICAgICAgICAgIGlmIChjYXB0Y2hhUHJvdmlkZXJDb25maWdbdmFyXzEwNl0uZW5hYmxlZCAmJiBjYXB0Y2hhUHJvdmlkZXJDb25maWdbdmFyXzEwNl0udG9rZW4pIHsKICAgICAgICAgICAgZWxlbWVudF81My5zdHlsZS5iYWNrZ3JvdW5kID0gImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNGRjk4MDAsICNGRjU3MjIpIjsKICAgICAgICAgICAgZWxlbWVudF81My5zdHlsZS5ib3JkZXIgPSAiMnB4IHNvbGlkICMzOUZGMTQiOwogICAgICAgICAgICBlbGVtZW50XzUzLnN0eWxlLmJveFNoYWRvdyA9ICJcbiAgICAgICAgICAgICAgICAgICAgICAgIDAgMCAxMHB4ICMzOUZGMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICAwIDAgMjBweCAjMzlGRjE0LFxuICAgICAgICAgICAgICAgICAgICAgICAgMCAwIDMwcHggIzM5RkYxNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIDAgMCA0MHB4ICMzOUZGMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnNldCAwIDAgMTBweCByZ2JhKDU3LCAyNTUsIDIwLCAwLjUpXG4gICAgICAgICAgICAgICAgICAgICI7CiAgICAgICAgICB9IGVsc2UgaWYgKGNhcHRjaGFQcm92aWRlckNvbmZpZ1t2YXJfMTA2XS5lbmFibGVkKSB7CiAgICAgICAgICAgIGVsZW1lbnRfNTMuc3R5bGUuYmFja2dyb3VuZCA9ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjRkY5ODAwLCAjRkY1NzIyKSI7CiAgICAgICAgICAgIGVsZW1lbnRfNTMuc3R5bGUuYm9yZGVyID0gIjJweCBzb2xpZCAjRkY5ODAwIjsKICAgICAgICAgICAgZWxlbWVudF81My5zdHlsZS5ib3hTaGFkb3cgPSAiMCAwIDE1cHggI0ZGOTgwMCwgMCAwIDI1cHggI0ZGOTgwMCI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlbGVtZW50XzUzLnN0eWxlLmJhY2tncm91bmQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzIxOTZGMywgIzAzQTlGNCkiOwogICAgICAgICAgICBlbGVtZW50XzUzLnN0eWxlLmJvcmRlciA9ICJub25lIjsKICAgICAgICAgICAgZWxlbWVudF81My5zdHlsZS5ib3hTaGFkb3cgPSAiIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzEwMyh2YWx1ZV8xMDcpIHsKICAgICAgICBsZXQgZWxlbWVudF81NCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC1jYXB0Y2hhLXRva2VuLWlucHV0Iik7CiAgICAgICAgaWYgKCFlbGVtZW50XzU0KSB7CiAgICAgICAgICBlbGVtZW50XzU0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgICAgICAgIGVsZW1lbnRfNTQuaWQgPSAibXQtY2FwdGNoYS10b2tlbi1pbnB1dCI7CiAgICAgICAgICBlbGVtZW50XzU0LnR5cGUgPSAiaGlkZGVuIjsKICAgICAgICAgIGVsZW1lbnRfNTQubmFtZSA9ICJjZi10dXJuc3RpbGUtcmVzcG9uc2UiOwogICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50XzU0KTsKICAgICAgICB9CiAgICAgICAgZWxlbWVudF81NC52YWx1ZSA9IHZhbHVlXzEwNzsKICAgICAgICBjb25zb2xlLmxvZygiU3RvcmVkIENBUFRDSEEgdG9rZW4gaW4gaGlkZGVuIGlucHV0OiIsIHZhbHVlXzEwNyk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZGF0ZXRpbWVfMTA4KGRhdGV0aW1lXzEwOSwgdmFyXzExMCkgewogICAgICAgIGNvbnN0IHRpbWVyXzcgPSB3aW5kb3dbInRpbWVySW50ZXJ2YWxfIiArIGRhdGV0aW1lXzEwOV07CiAgICAgICAgaWYgKHRpbWVyXzcpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJfNyk7CiAgICAgICAgfQogICAgICAgIGxldCB0ZW1wXzg1ID0gdmFyXzExMCAqIDYwOwogICAgICAgIGNvbnN0IGVsZW1lbnRfNTUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkYXRldGltZV8xMDkpOwogICAgICAgIGlmICghZWxlbWVudF81NSkgewogICAgICAgICAgY29uc29sZS5lcnJvcigiVGltZXIgZWxlbWVudCB3aXRoIGlkICIgKyBkYXRldGltZV8xMDkgKyAiIG5vdCBmb3VuZCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBlbGVtZW50XzU1LnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIGVsZW1lbnRfNTUuc3R5bGUuY29sb3IgPSAiI2ZmZmZmZiI7CiAgICAgICAgd2luZG93WyJ0aW1lckludGVydmFsXyIgKyBkYXRldGltZV8xMDldID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgdGVtcF84NS0tOwogICAgICAgICAgY29uc3QgdGV4dF8xNiA9IE1hdGguZmxvb3IodGVtcF84NSAvIDYwKTsKICAgICAgICAgIGNvbnN0IHRleHRfMTcgPSB0ZW1wXzg1ICUgNjA7CiAgICAgICAgICBpZiAoZWxlbWVudF81NSkgewogICAgICAgICAgICBlbGVtZW50XzU1LnRleHRDb250ZW50ID0gdGV4dF8xNi50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIikgKyAiOiIgKyB0ZXh0XzE3LnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh0ZW1wXzg1IDw9IDApIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh3aW5kb3dbInRpbWVySW50ZXJ2YWxfIiArIGRhdGV0aW1lXzEwOV0pOwogICAgICAgICAgICBpZiAoZWxlbWVudF81NSkgewogICAgICAgICAgICAgIGVsZW1lbnRfNTUudGV4dENvbnRlbnQgPSAiRXhwaXJlZCI7CiAgICAgICAgICAgICAgZWxlbWVudF81NS5zdHlsZS5jb2xvciA9ICIjZmY0NDQ0IjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIDEwMDApOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIGRhdGV0aW1lXzExMShkYXRldGltZV8xMTIpIHsKICAgICAgICBjb25zdCB0aW1lcl84ID0gd2luZG93WyJ0aW1lckludGVydmFsXyIgKyBkYXRldGltZV8xMTJdOwogICAgICAgIGlmICh0aW1lcl84KSB7CiAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyXzgpOwogICAgICAgICAgY29uc29sZS5sb2coIlRpbWVyICIgKyBkYXRldGltZV8xMTIgKyAiIHBhdXNlZCIpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTEzKCkgewogICAgICAgIGRhdGV0aW1lXzEwOCgiY2FwdGNoYS12ZXJpZnktdGltZXIiLCAyKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBoaWRlTG9hZGluZ0luZGljYXRvcigpIHsKICAgICAgICByZXRyeUNvdW50ID0gMDsKICAgICAgICBpZiAobGFzdFJlcXVlc3RUaW1lKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKGxhc3RSZXF1ZXN0VGltZSk7CiAgICAgICAgICBsYXN0UmVxdWVzdFRpbWUgPSBudWxsOwogICAgICAgIH0KICAgICAgICBjb25zdCBlbGVtZW50XzU2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRpdGxlLXRpbWVyLWRpc3BsYXkiKTsKICAgICAgICBpZiAoZWxlbWVudF81NikgewogICAgICAgICAgZWxlbWVudF81Ni50ZXh0Q29udGVudCA9ICIwcyI7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl81NigpIHsKICAgICAgICBpZiAobGFzdFJlcXVlc3RUaW1lKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKGxhc3RSZXF1ZXN0VGltZSk7CiAgICAgICAgfQogICAgICAgIHJldHJ5Q291bnQgPSAwOwogICAgICAgIGxhc3RSZXF1ZXN0VGltZSA9IHNldEludGVydmFsKCgpID0-IHsKICAgICAgICAgIHJldHJ5Q291bnQrKzsKICAgICAgICAgIGNvbnN0IHRleHRfMTggPSBNYXRoLmZsb29yKHJldHJ5Q291bnQgLyA2MCk7CiAgICAgICAgICBjb25zdCB0ZXh0XzE5ID0gcmV0cnlDb3VudCAlIDYwOwogICAgICAgICAgY29uc3QgZWxlbWVudF81NyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0aXRsZS10aW1lci1kaXNwbGF5Iik7CiAgICAgICAgICBpZiAoZWxlbWVudF81NykgewogICAgICAgICAgICBlbGVtZW50XzU3LnRleHRDb250ZW50ID0gdGV4dF8xOC50b1N0cmluZygpLnBhZFN0YXJ0KDIsICIwIikgKyAiOiIgKyB0ZXh0XzE5LnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKTsKICAgICAgICAgIH0KICAgICAgICB9LCAxMDAwKTsKICAgICAgfQogICAgICBjb25zdCBlbGVtZW50XzU4ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfNTguaWQgPSAibG9naW4tY29udGVudCI7CiAgICAgIGVsZW1lbnRfNTguY2xhc3NOYW1lID0gInRhYi1jb250ZW50IGxvZ2luLXRhYiBhY3RpdmUiOwogICAgICBlbGVtZW50XzU4LnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICBjb25zdCB0ZW1wXzg2ID0gdmFyXzk2KCJsb2dpbiIpOwogICAgICBlbGVtZW50XzU4LmFwcGVuZENoaWxkKHRlbXBfODYpOwogICAgICBjb25zdCBidXR0b25fMiA9IHsKICAgICAgICBpZDogIm1vYmlsZS12ZXJpZnktYnRuIiwKICAgICAgICBjbGFzc05hbWU6ICJ0b29sLWJ0biBsb2dpbi1idG4iLAogICAgICAgIHRleHQ6ICJNb2JpbGUgVmVyaWZ5IiwKICAgICAgICBzdHlsZUNsYXNzOiBzdHlsZV8yLnByaW1hcnkKICAgICAgfTsKICAgICAgY29uc3QgdGVtcF84NyA9IHsKICAgICAgICBpbnB1dDogewogICAgICAgICAgaWQ6ICJtdC1tb2JpbGUtbnVtYmVyIiwKICAgICAgICAgIGNsYXNzTmFtZTogInRvb2wtaW5wdXQgbG9naW4taW5wdXQiLAogICAgICAgICAgcGxhY2Vob2xkZXI6ICJNb2JpbGUgTnVtYmVyIgogICAgICAgIH0sCiAgICAgICAgYnV0dG9uOiBidXR0b25fMgogICAgICB9OwogICAgICBjb25zdCBidXR0b25fMyA9IHsKICAgICAgICBpZDogImF1dGhlbnRpY2F0ZS1idG4iLAogICAgICAgIGNsYXNzTmFtZTogInRvb2wtYnRuIGxvZ2luLWJ0biIsCiAgICAgICAgdGV4dDogIkF1dGhlbnRpY2F0ZSIsCiAgICAgICAgc3R5bGVDbGFzczogc3R5bGVfMi5wcmltYXJ5CiAgICAgIH07CiAgICAgIGNvbnN0IHRlbXBfODggPSB7CiAgICAgICAgaW5wdXQ6IHsKICAgICAgICAgIGlkOiAibXQtcGFzc3dvcmQiLAogICAgICAgICAgY2xhc3NOYW1lOiAidG9vbC1pbnB1dCBsb2dpbi1pbnB1dCIsCiAgICAgICAgICBwbGFjZWhvbGRlcjogIlBhc3N3b3JkIiwKICAgICAgICAgIHR5cGU6ICJwYXNzd29yZCIKICAgICAgICB9LAogICAgICAgIGJ1dHRvbjogYnV0dG9uXzMKICAgICAgfTsKICAgICAgY29uc3QgYnV0dG9uXzQgPSB7CiAgICAgICAgaWQ6ICJzdWJtaXQtb3RwLWJ0biIsCiAgICAgICAgY2xhc3NOYW1lOiAidG9vbC1idG4gbG9naW4tYnRuIiwKICAgICAgICB0ZXh0OiAiU3VibWl0IE9UUCIsCiAgICAgICAgc3R5bGVDbGFzczogc3R5bGVfMi5wcmltYXJ5CiAgICAgIH07CiAgICAgIGNvbnN0IHRlbXBfODkgPSB7CiAgICAgICAgaW5wdXQ6IHsKICAgICAgICAgIGlkOiAibXQtb3RwIiwKICAgICAgICAgIGNsYXNzTmFtZTogInRvb2wtaW5wdXQgbG9naW4taW5wdXQiLAogICAgICAgICAgcGxhY2Vob2xkZXI6ICJMb2dpbiBPVFAiCiAgICAgICAgfSwKICAgICAgICBidXR0b246IGJ1dHRvbl80CiAgICAgIH07CiAgICAgIGNvbnN0IHRlbXBfOTAgPSBbdGVtcF84NywgdGVtcF84OCwgdGVtcF84OV07CiAgICAgIHRlbXBfOTAuZm9yRWFjaCgoewogICAgICAgIGlucHV0OiBjaGlsZEVsZW1lbnRfMTE0LAogICAgICAgIGJ1dHRvbjogY2hpbGRFbGVtZW50XzExNQogICAgICB9KSA9PiB7CiAgICAgICAgY29uc3QgZWxlbWVudF81OSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgIGVsZW1lbnRfNTkuY2xhc3NOYW1lID0gIm1iLXNtIjsKICAgICAgICBlbGVtZW50XzU5LmFwcGVuZENoaWxkKGNoaWxkRWxlbWVudF8xMDAoY2hpbGRFbGVtZW50XzExNCkpOwogICAgICAgIGVsZW1lbnRfNTkuYXBwZW5kQ2hpbGQoY2hpbGRFbGVtZW50Xzk5KGNoaWxkRWxlbWVudF8xMTUpKTsKICAgICAgICBlbGVtZW50XzU4LmFwcGVuZENoaWxkKGVsZW1lbnRfNTkpOwogICAgICB9KTsKICAgICAgY29uc3QgZWxlbWVudF82MCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzYwLmlkID0gImxvZ2luLW90cC10aW1lci1kaXNwbGF5IjsKICAgICAgZWxlbWVudF82MC5jbGFzc05hbWUgPSAidGltZXItYm94IjsKICAgICAgZWxlbWVudF82MC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBlbGVtZW50XzYwLnRleHRDb250ZW50ID0gIk9UUDogMDA6MDAiOwogICAgICBlbGVtZW50XzU4LmFwcGVuZENoaWxkKGVsZW1lbnRfNjApOwogICAgICBjb25zdCBlbGVtZW50XzYxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfNjEuaWQgPSAiYmdkLWNvbnRlbnQiOwogICAgICBlbGVtZW50XzYxLmNsYXNzTmFtZSA9ICJ0YWItY29udGVudCI7CiAgICAgIGVsZW1lbnRfNjEuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgY29uc3QgZWxlbWVudF82MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzYyLmNsYXNzTmFtZSA9ICJmbGV4IGdhcC1zbSBtYi1tZCI7CiAgICAgIGVsZW1lbnRfNjIuc3R5bGUuYWxpZ25JdGVtcyA9ICJjZW50ZXIiOwogICAgICBjb25zdCBlbGVtZW50XzYzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgIGVsZW1lbnRfNjMuaWQgPSAiY2YtYnRuLWJnZCI7CiAgICAgIGVsZW1lbnRfNjMuY2xhc3NOYW1lID0gImNmLWF0LWJ0biBnbG9iYWwtY2YtYnRuIGJ0bi1pbmZvIjsKICAgICAgZWxlbWVudF82My50ZXh0Q29udGVudCA9ICJDRiI7CiAgICAgIGVsZW1lbnRfNjMuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiBldmVudEhhbmRsZXJfOTgoImJnZCIpKTsKICAgICAgY29uc3QgZWxlbWVudF82NCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzY0LmlkID0gImJnZC1vdHAtdGltZXItZGlzcGxheSI7CiAgICAgIGVsZW1lbnRfNjQuY2xhc3NOYW1lID0gInRpbWVyLWJveCBmbGV4LTEiOwogICAgICBlbGVtZW50XzY0LnN0eWxlLm1hcmdpbiA9ICIwIjsKICAgICAgZWxlbWVudF82NC5zdHlsZS5wYWRkaW5nID0gIjRweCI7CiAgICAgIGVsZW1lbnRfNjQudGV4dENvbnRlbnQgPSAiT1RQOiAwMDowMCI7CiAgICAgIGVsZW1lbnRfNjIuYXBwZW5kQ2hpbGQoZWxlbWVudF82Myk7CiAgICAgIGVsZW1lbnRfNjIuYXBwZW5kQ2hpbGQoZWxlbWVudF82NCk7CiAgICAgIGVsZW1lbnRfNjEuYXBwZW5kQ2hpbGQoZWxlbWVudF82Mik7CiAgICAgIGNvbnN0IGVsZW1lbnRfNjUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF82NS5jbGFzc05hbWUgPSAiYmdkLWdyaWQiOwogICAgICBjb25zdCB0ZW1wXzkxID0gewogICAgICAgIGlkOiAiYXBwbGljYXRpb24taW5mby1idG4iLAogICAgICAgIHRleHQ6ICJBcHAiLAogICAgICAgIHN0eWxlOiBzdHlsZV8xLnByaW1hcnkKICAgICAgfTsKICAgICAgY29uc3QgdGVtcF85MiA9IHsKICAgICAgICBpZDogInBlcnNvbmFsLWluZm8tYnRuIiwKICAgICAgICB0ZXh0OiAiUGVyc29uYWwiLAogICAgICAgIHN0eWxlOiBzdHlsZV8xLnByaW1hcnkKICAgICAgfTsKICAgICAgY29uc3QgdGVtcF85MyA9IHsKICAgICAgICBpZDogIm92ZXJ2aWV3LWJ0biIsCiAgICAgICAgdGV4dDogIk92ZXJ2aWV3IiwKICAgICAgICBzdHlsZTogc3R5bGVfMS5wcmltYXJ5CiAgICAgIH07CiAgICAgIGNvbnN0IHRlbXBfOTQgPSB7CiAgICAgICAgaWQ6ICJwYXktb3RwLWJ0biIsCiAgICAgICAgdGV4dDogIlNlbmQiLAogICAgICAgIHN0eWxlOiBzdHlsZV8xLnByaW1hcnkKICAgICAgfTsKICAgICAgY29uc3QgdGVtcF85NSA9IHsKICAgICAgICBpZDogInBheS12ZXJpZnktYnRuIiwKICAgICAgICB0ZXh0OiAiVmVyaWZ5IiwKICAgICAgICBzdHlsZTogc3R5bGVfMS5wcmltYXJ5CiAgICAgIH07CiAgICAgIGNvbnN0IHRlbXBfOTYgPSB7CiAgICAgICAgaWQ6ICJyZXNlbmQtcGF5LW90cC1idG4iLAogICAgICAgIHRleHQ6ICJSZXNlbmQiLAogICAgICAgIHN0eWxlOiBzdHlsZV8xLnNlY29uZGFyeQogICAgICB9OwogICAgICBjb25zdCB0ZW1wXzk3ID0gewogICAgICAgIGlkOiAiaW1wb3J0LWNvbmZpZy1idG4iLAogICAgICAgIHRleHQ6ICJJbXBvcnQiLAogICAgICAgIHN0eWxlOiBzdHlsZV8xLndhcm5pbmcsCiAgICAgICAgb25DbGljazogZXZlbnRIYW5kbGVyXzExNgogICAgICB9OwogICAgICBjb25zdCB0ZW1wXzk4ID0gewogICAgICAgIGlkOiAiZXhwb3J0LWNvbmZpZy1idG4iLAogICAgICAgIHRleHQ6ICJFeHBvcnQiLAogICAgICAgIHN0eWxlOiBzdHlsZV8xLnN1Y2Nlc3MsCiAgICAgICAgb25DbGljazogZXZlbnRIYW5kbGVyXzExNwogICAgICB9OwogICAgICBjb25zdCB0ZW1wXzk5ID0gW3RlbXBfOTEsIHRlbXBfOTIsIHRlbXBfOTMsIHRlbXBfOTQsIHRlbXBfOTUsIHRlbXBfOTYsIHRlbXBfOTcsIHRlbXBfOThdOwogICAgICB0ZW1wXzk5LmZvckVhY2goKHsKICAgICAgICBvbkNsaWNrOiBldmVudEhhbmRsZXJfMTE4LAogICAgICAgIC4uLnZhcl8xMTkKICAgICAgfSkgPT4gewogICAgICAgIGNvbnN0IHJvd18xID0gewogICAgICAgICAgLi4udmFyXzExOQogICAgICAgIH07CiAgICAgICAgcm93XzEuY2xhc3NOYW1lID0gInRvb2wtYnRuLXJvdyI7CiAgICAgICAgY29uc3QgdGVtcF8xMDAgPSBjaGlsZEVsZW1lbnRfOTkocm93XzEpOwogICAgICAgIGlmIChldmVudEhhbmRsZXJfMTE4KSB7CiAgICAgICAgICB0ZW1wXzEwMC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGV2ZW50SGFuZGxlcl8xMTgpOwogICAgICAgIH0KICAgICAgICBlbGVtZW50XzY1LmFwcGVuZENoaWxkKHRlbXBfMTAwKTsKICAgICAgfSk7CiAgICAgIGNvbnN0IHRlbXBfMTAxID0gY2hpbGRFbGVtZW50XzEwMCh7CiAgICAgICAgaWQ6ICJwYXltZW50LW90cCIsCiAgICAgICAgcGxhY2Vob2xkZXI6ICJPVFAiCiAgICAgIH0pOwogICAgICBjb25zdCB0ZW1wXzEwMiA9IHRlbXBfOTkuZmluZEluZGV4KGluZGV4XzEgPT4gaW5kZXhfMS5pZCA9PT0gInBheS12ZXJpZnktYnRuIik7CiAgICAgIGlmICh0ZW1wXzEwMiA-PSAwKSB7CiAgICAgICAgZWxlbWVudF82NS5pbnNlcnRCZWZvcmUodGVtcF8xMDEsIGVsZW1lbnRfNjUuY2hpbGRyZW5bdGVtcF8xMDJdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlbGVtZW50XzY1LmFwcGVuZENoaWxkKHRlbXBfMTAxKTsKICAgICAgfQogICAgICBlbGVtZW50XzYxLmFwcGVuZENoaWxkKGVsZW1lbnRfNjUpOwogICAgICBjb25zdCBlbGVtZW50XzY2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfNjYuaWQgPSAicGF5bm93LWNvbnRlbnQiOwogICAgICBlbGVtZW50XzY2LmNsYXNzTmFtZSA9ICJ0YWItY29udGVudCI7CiAgICAgIGVsZW1lbnRfNjYuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgY29uc3QgdGVtcF8xMDMgPSB2YXJfMTAxKCk7CiAgICAgIGVsZW1lbnRfNjYuYXBwZW5kQ2hpbGQodGVtcF8xMDMpOwogICAgICBjb25zdCBlbGVtZW50XzY3ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfNjcuaWQgPSAicGF5LXRpbWVyLWRpc3BsYXkiOwogICAgICBlbGVtZW50XzY3LmNsYXNzTmFtZSA9ICJ0aW1lci1ib3ggZmxleC0xIjsKICAgICAgZWxlbWVudF82Ny5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBlbGVtZW50XzY3LnN0eWxlLm1hcmdpbiA9ICIwIDZweCI7CiAgICAgIGVsZW1lbnRfNjcuc3R5bGUucGFkZGluZyA9ICI0cHgiOwogICAgICBlbGVtZW50XzY3LnRleHRDb250ZW50ID0gIjEwOjAwIjsKICAgICAgdGVtcF8xMDMuaW5zZXJ0QmVmb3JlKGVsZW1lbnRfNjcsIHRlbXBfMTAzLmNoaWxkcmVuWzFdKTsKICAgICAgY29uc3QgZWxlbWVudF82OCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzY4LmNsYXNzTmFtZSA9ICJmbGV4IGdhcC1zbSBtYi1tZCI7CiAgICAgIGNvbnN0IGVsZW1lbnRfNjkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF82OS5jbGFzc05hbWUgPSAiZmxleCBmbGV4LWNvbCBnYXAtc20gZmxleC0xIjsKICAgICAgY29uc3QgZWxlbWVudF83MCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgIGVsZW1lbnRfNzAudHlwZSA9ICJ0ZXh0IjsKICAgICAgZWxlbWVudF83MC5pZCA9ICJhcHBvaW50bWVudF9kYXRlIjsKICAgICAgZWxlbWVudF83MC5jbGFzc05hbWUgPSAidG9vbC1pbnB1dC1yb3ciOwogICAgICBlbGVtZW50XzcwLnBsYWNlaG9sZGVyID0gIllZWVktTU0tREQiOwogICAgICBlbGVtZW50XzcwLnN0eWxlLndpZHRoID0gIjEwMCUiOwogICAgICBjb25zdCBlbGVtZW50XzcxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgIGVsZW1lbnRfNzEuaWQgPSAiZ2V0LXRpbWUtc2xvdC1idG4iOwogICAgICBlbGVtZW50XzcxLmNsYXNzTmFtZSA9ICJ0b29sLWJ0bi1yb3cgYnRuLXByaW1hcnkgdy1mdWxsIjsKICAgICAgZWxlbWVudF83MS50ZXh0Q29udGVudCA9ICJHZXQgU2xvdCI7CiAgICAgIGVsZW1lbnRfNjkuYXBwZW5kQ2hpbGQoZWxlbWVudF83MCk7CiAgICAgIGVsZW1lbnRfNjkuYXBwZW5kQ2hpbGQoZWxlbWVudF83MSk7CiAgICAgIGNvbnN0IGVsZW1lbnRfNzIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF83Mi5jbGFzc05hbWUgPSAiZmxleCBmbGV4LWNvbCBnYXAtc20gZmxleC0xIjsKICAgICAgY29uc3QgZWxlbWVudF83MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpOwogICAgICBlbGVtZW50XzczLmlkID0gImFwcG9pbnRtZW50X3RpbWUiOwogICAgICBlbGVtZW50XzczLmNsYXNzTmFtZSA9ICJ0b29sLWlucHV0LXJvdyI7CiAgICAgIGVsZW1lbnRfNzMuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgIGNvbnN0IGVsZW1lbnRfNzQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsKICAgICAgZWxlbWVudF83NC52YWx1ZSA9ICIiOwogICAgICBlbGVtZW50Xzc0LnRleHRDb250ZW50ID0gIlRpbWUiOwogICAgICBlbGVtZW50XzczLmFwcGVuZENoaWxkKGVsZW1lbnRfNzQpOwogICAgICBjb25zdCBlbGVtZW50Xzc1ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgIGVsZW1lbnRfNzUuaWQgPSAic2V0LXRpbWUtYnRuIjsKICAgICAgZWxlbWVudF83NS5jbGFzc05hbWUgPSAidG9vbC1idG4tcm93IGJ0bi1wcmltYXJ5IHctZnVsbCI7CiAgICAgIGVsZW1lbnRfNzUudGV4dENvbnRlbnQgPSAiU2V0IFRpbWUiOwogICAgICBlbGVtZW50XzcyLmFwcGVuZENoaWxkKGVsZW1lbnRfNzMpOwogICAgICBlbGVtZW50XzcyLmFwcGVuZENoaWxkKGVsZW1lbnRfNzUpOwogICAgICBlbGVtZW50XzY4LmFwcGVuZENoaWxkKGVsZW1lbnRfNjkpOwogICAgICBlbGVtZW50XzY4LmFwcGVuZENoaWxkKGVsZW1lbnRfNzIpOwogICAgICBlbGVtZW50XzY2LmFwcGVuZENoaWxkKGVsZW1lbnRfNjgpOwogICAgICBjb25zdCBlbGVtZW50Xzc2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfNzYuY2xhc3NOYW1lID0gImZsZXggZ2FwLXNtIG1iLW1kIHctZnVsbCI7CiAgICAgIGVsZW1lbnRfNzYuc3R5bGUuYWxpZ25JdGVtcyA9ICJmbGV4LXN0YXJ0IjsKICAgICAgZWxlbWVudF83Ni5zdHlsZS5ib3hTaXppbmcgPSAiYm9yZGVyLWJveCI7CiAgICAgIGNvbnN0IGVsZW1lbnRfNzcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF83Ny5jbGFzc05hbWUgPSAiZmxleCBmbGV4LWNvbCBnYXAtc20gZmxleC0xIjsKICAgICAgY29uc3QgZWxlbWVudF83OCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICBlbGVtZW50Xzc4LmlkID0gImNmLWJ0bi1wYXlub3ctcm93IjsKICAgICAgZWxlbWVudF83OC5jbGFzc05hbWUgPSAidG9vbC1idG4tcm93IGJ0bi13YXJuaW5nIjsKICAgICAgZWxlbWVudF83OC5zdHlsZS5jb2xvciA9ICIjMWYyOTM3IjsKICAgICAgZWxlbWVudF83OC5zdHlsZS5mb250V2VpZ2h0ID0gIjYwMCI7CiAgICAgIGVsZW1lbnRfNzgudGV4dENvbnRlbnQgPSAiTG9hZCI7CiAgICAgIGVsZW1lbnRfNzcuYXBwZW5kQ2hpbGQoZWxlbWVudF83OCk7CiAgICAgIGNvbnN0IGVsZW1lbnRfNzkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF83OS5jbGFzc05hbWUgPSAiZmxleCBmbGV4LWNvbCBnYXAtc20gZmxleC0xIjsKICAgICAgZWxlbWVudF83OS5zdHlsZS5wYWRkaW5nUmlnaHQgPSAiNnB4IjsKICAgICAgZWxlbWVudF83OS5zdHlsZS5ib3hTaXppbmcgPSAiYm9yZGVyLWJveCI7CiAgICAgIGNvbnN0IGVsZW1lbnRfODAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF84MC5pZCA9ICJzbG90LWNvdW50LWRpc3BsYXkiOwogICAgICBlbGVtZW50XzgwLmNsYXNzTmFtZSA9ICJ0aW1lci1ib3ggdGV4dC1jZW50ZXIgdy1mdWxsIjsKICAgICAgZWxlbWVudF84MC5zdHlsZS5tYXJnaW4gPSAiMCI7CiAgICAgIGVsZW1lbnRfODAuc3R5bGUuY29sb3IgPSAidmFyKC0tY29sb3Itc2Vjb25kYXJ5KSI7CiAgICAgIGVsZW1lbnRfODAudGV4dENvbnRlbnQgPSAiU2xvdHM6IDAiOwogICAgICBlbGVtZW50Xzc5LmFwcGVuZENoaWxkKGVsZW1lbnRfODApOwogICAgICBlbGVtZW50Xzc2LmFwcGVuZENoaWxkKGVsZW1lbnRfNzcpOwogICAgICBlbGVtZW50Xzc2LmFwcGVuZENoaWxkKGVsZW1lbnRfNzkpOwogICAgICBlbGVtZW50XzY2LmFwcGVuZENoaWxkKGVsZW1lbnRfNzYpOwogICAgICBjb25zdCBlbGVtZW50XzgxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfODEuaWQgPSAicGF5LWNhcHRjaGEtbW9kYWwiOwogICAgICBlbGVtZW50XzgxLmNsYXNzTmFtZSA9ICJtdC1wYXktbW9kYWwiOwogICAgICBjb25zdCBlbGVtZW50XzgyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfODIuY2xhc3NOYW1lID0gIm10LXBheS1jYXJkIjsKICAgICAgY29uc3QgZWxlbWVudF84MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzgzLmNsYXNzTmFtZSA9ICJtdC1wYXktaGVhZGVyIjsKICAgICAgY29uc3QgZWxlbWVudF84NCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50Xzg0LnRleHRDb250ZW50ID0gIlBheW1lbnQgQ2FwdGNoYSI7CiAgICAgIGVsZW1lbnRfODQuY2xhc3NOYW1lID0gIm10LXBheS10aXRsZSI7CiAgICAgIGNvbnN0IGVsZW1lbnRfODUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgZWxlbWVudF84NS5pZCA9ICJwYXktY2FwdGNoYS1jbG9zZS1idG4iOwogICAgICBlbGVtZW50Xzg1LnRleHRDb250ZW50ID0gIsOXIjsKICAgICAgZWxlbWVudF84NS5jbGFzc05hbWUgPSAibXQtcGF5LWNsb3NlIjsKICAgICAgZWxlbWVudF84My5hcHBlbmRDaGlsZChlbGVtZW50Xzg0KTsKICAgICAgZWxlbWVudF84My5hcHBlbmRDaGlsZChlbGVtZW50Xzg1KTsKICAgICAgZWxlbWVudF84Mi5hcHBlbmRDaGlsZChlbGVtZW50XzgzKTsKICAgICAgY29uc3QgZWxlbWVudF84NiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50Xzg2LmlkID0gInBheS1jYXB0Y2hhLWhpbnQiOwogICAgICBlbGVtZW50Xzg2LnRleHRDb250ZW50ID0gIlNvbHZlIHRoZSBDQVBUQ0hBIGJlbG93LCB0aGVuIGNsaWNrIFZlcmlmeS4iOwogICAgICBlbGVtZW50Xzg2LmNsYXNzTmFtZSA9ICJtdC1wYXktaGludCI7CiAgICAgIGVsZW1lbnRfODIuYXBwZW5kQ2hpbGQoZWxlbWVudF84Nik7CiAgICAgIGNvbnN0IGVsZW1lbnRfODcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF84Ny5jbGFzc05hbWUgPSAibXQtZmxleC1jb2wiOwogICAgICBlbGVtZW50Xzg3LnN0eWxlLndpZHRoID0gIjEwMCUiOwogICAgICBjb25zdCBlbGVtZW50Xzg4ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfODguY2xhc3NOYW1lID0gIm10LWZsZXgtY2VudGVyIjsKICAgICAgY29uc3QgZWxlbWVudF84OSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICBlbGVtZW50Xzg5LmlkID0gInBheS1jYXB0Y2hhLXJlZnJlc2gtYnRuIjsKICAgICAgZWxlbWVudF84OS5jbGFzc05hbWUgPSAidG9vbC1idG4tcm93IjsKICAgICAgZWxlbWVudF84OS5zdHlsZS5iYWNrZ3JvdW5kID0gImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM2MzY2RjEsICM4QjVDRjYpIjsKICAgICAgZWxlbWVudF84OS5zdHlsZS5oZWlnaHQgPSAiMjhweCI7CiAgICAgIGVsZW1lbnRfODkuc3R5bGUud2lkdGggPSAiODBweCI7CiAgICAgIGVsZW1lbnRfODkuc3R5bGUuYm9yZGVyUmFkaXVzID0gIjE0cHgiOwogICAgICBlbGVtZW50Xzg5LnN0eWxlLmZvbnRTaXplID0gIjE0cHgiOwogICAgICBlbGVtZW50Xzg5LnN0eWxlLmZvbnRXZWlnaHQgPSAiNjAwIjsKICAgICAgZWxlbWVudF84OS50ZXh0Q29udGVudCA9ICJSZWZyZXNoIjsKICAgICAgZWxlbWVudF84OC5hcHBlbmRDaGlsZChlbGVtZW50Xzg5KTsKICAgICAgY29uc3QgZWxlbWVudF85MCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzkwLmlkID0gImNmLWNhcHRjaGEtY29udGFpbmVyIjsKICAgICAgZWxlbWVudF85MC5jbGFzc05hbWUgPSAibXQtY2FwdGNoYS1jb250YWluZXIiOwogICAgICBlbGVtZW50XzkwLnRleHRDb250ZW50ID0gIkNhcHRjaGEgd2lsbCBhcHBlYXIgaGVyZSI7CiAgICAgIGVsZW1lbnRfODcuYXBwZW5kQ2hpbGQoZWxlbWVudF84OCk7CiAgICAgIGVsZW1lbnRfODcuYXBwZW5kQ2hpbGQoZWxlbWVudF85MCk7CiAgICAgIGVsZW1lbnRfODIuYXBwZW5kQ2hpbGQoZWxlbWVudF84Nyk7CiAgICAgIGNvbnN0IGVsZW1lbnRfOTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwogICAgICBlbGVtZW50XzkxLmlkID0gInBheS1jYXB0Y2hhLWlucHV0IjsKICAgICAgZWxlbWVudF85MS5jbGFzc05hbWUgPSAidG9vbC1pbnB1dC1yb3cgbXQtaW5wdXQtZW5oYW5jZWQiOwogICAgICBlbGVtZW50XzkxLnBsYWNlaG9sZGVyID0gIkVudGVyIGNhcHRjaGEgdmFsdWUiOwogICAgICBlbGVtZW50XzkxLnN0eWxlLndpZHRoID0gIjEwMCUiOwogICAgICBlbGVtZW50XzkxLnN0eWxlLmZvbnRTaXplID0gIjE4cHgiOwogICAgICBlbGVtZW50XzkxLnN0eWxlLnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICBlbGVtZW50XzkxLnN0eWxlLmZvbnRXZWlnaHQgPSAiNjAwIjsKICAgICAgZWxlbWVudF85MS5kYXRhc2V0Lm9yaWdpbmFsVmFsdWUgPSAiIjsKICAgICAgZWxlbWVudF85MS5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIGZ1bmN0aW9uIChldmVudF8zKSB7CiAgICAgICAgY29uc3QgZGF0YV84ID0gZXZlbnRfMy50YXJnZXQ7CiAgICAgICAgY29uc3QgY291bnRfMTMgPSBkYXRhXzgudmFsdWU7CiAgICAgICAgY29uc3QgY291bnRfMTQgPSBkYXRhXzguc2VsZWN0aW9uU3RhcnQ7CiAgICAgICAgbGV0IGNvdW50XzE1ID0gMDsKICAgICAgICBmb3IgKGxldCBjb3VudF8xNiA9IDA7IGNvdW50XzE2IDwgY291bnRfMTQgJiYgY291bnRfMTYgPCBjb3VudF8xMy5sZW5ndGg7IGNvdW50XzE2KyspIHsKICAgICAgICAgIGlmIChjb3VudF8xM1tjb3VudF8xNl0gIT09ICIgIikgewogICAgICAgICAgICBjb3VudF8xNSsrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBsZXQgZGF0YV85ID0gY291bnRfMTMucmVwbGFjZSgvXHMvZywgIiIpOwogICAgICAgIGRhdGFfOC5kYXRhc2V0Lm9yaWdpbmFsVmFsdWUgPSBkYXRhXzk7CiAgICAgICAgZGF0YV84LnZhbHVlID0gZGF0YV85OwogICAgICAgIGNvbnN0IGNvdW50XzE3ID0gTWF0aC5taW4oY291bnRfMTUsIGRhdGFfOS5sZW5ndGgpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgZGF0YV84LnNldFNlbGVjdGlvblJhbmdlKGNvdW50XzE3LCBjb3VudF8xNyk7CiAgICAgICAgfSwgMCk7CiAgICAgIH0pOwogICAgICBlbGVtZW50XzkxLmFkZEV2ZW50TGlzdGVuZXIoInBhc3RlIiwgZnVuY3Rpb24gKGRhdGFfMTApIHsKICAgICAgICBkYXRhXzEwLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgY29uc3QgZGF0YV8xMSA9IChkYXRhXzEwLmNsaXBib2FyZERhdGEgfHwgd2luZG93LmNsaXBib2FyZERhdGEpLmdldERhdGEoInRleHQiKS5yZXBsYWNlKC9ccy9nLCAiIik7CiAgICAgICAgdGhpcy5kYXRhc2V0Lm9yaWdpbmFsVmFsdWUgPSBkYXRhXzExOwogICAgICAgIHRoaXMudmFsdWUgPSBkYXRhXzExOwogICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoImlucHV0IikpOwogICAgICB9KTsKICAgICAgZWxlbWVudF84Mi5hcHBlbmRDaGlsZChlbGVtZW50XzkxKTsKICAgICAgY29uc3QgZWxlbWVudF85MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICBlbGVtZW50XzkyLmlkID0gInBheS1jYXB0Y2hhLXZlcmlmeS1idG4iOwogICAgICBlbGVtZW50XzkyLmNsYXNzTmFtZSA9ICJ0b29sLWJ0bi1yb3ciOwogICAgICBlbGVtZW50XzkyLnN0eWxlLmJhY2tncm91bmQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzYzNjZGMSwgIzhCNUNGNikiOwogICAgICBlbGVtZW50XzkyLnN0eWxlLmhlaWdodCA9ICIzMHB4IjsKICAgICAgZWxlbWVudF85Mi5zdHlsZS5wYWRkaW5nID0gIjZweCI7CiAgICAgIGVsZW1lbnRfOTIudGV4dENvbnRlbnQgPSAiVmVyaWZ5IjsKICAgICAgZWxlbWVudF84Mi5hcHBlbmRDaGlsZChlbGVtZW50XzkyKTsKICAgICAgY29uc3QgZWxlbWVudF85MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBlbGVtZW50XzkzLmNsYXNzTmFtZSA9ICJtdC1mbGV4LXJvdyI7CiAgICAgIGVsZW1lbnRfOTMuc3R5bGUubWFyZ2luVG9wID0gIjRweCI7CiAgICAgIGNvbnN0IGVsZW1lbnRfOTQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgZWxlbWVudF85NC5pZCA9ICJwYXktY2FwdGNoYS1jcy1idG4iOwogICAgICBlbGVtZW50Xzk0LmNsYXNzTmFtZSA9ICJ0b29sLWJ0bi1yb3ciOwogICAgICBlbGVtZW50Xzk0LnN0eWxlLmJhY2tncm91bmQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzYzNjZGMSwgIzhCNUNGNikiOwogICAgICBlbGVtZW50Xzk0LnN0eWxlLmhlaWdodCA9ICIzMHB4IjsKICAgICAgZWxlbWVudF85NC5zdHlsZS5wYWRkaW5nID0gIjZweCI7CiAgICAgIGVsZW1lbnRfOTQuc3R5bGUuZmxleCA9ICIxIjsKICAgICAgZWxlbWVudF85NC50ZXh0Q29udGVudCA9ICJBdXRvIjsKICAgICAgZWxlbWVudF85My5hcHBlbmRDaGlsZChlbGVtZW50Xzk0KTsKICAgICAgY29uc3QgZWxlbWVudF85NSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICBlbGVtZW50Xzk1LmlkID0gInBheS1jYXB0Y2hhLXN0b3AtYnRuIjsKICAgICAgZWxlbWVudF85NS5jbGFzc05hbWUgPSAidG9vbC1idG4tcm93IjsKICAgICAgZWxlbWVudF85NS5zdHlsZS5iYWNrZ3JvdW5kID0gImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNGNDQzMzYsICNFOTFFNjMpIjsKICAgICAgZWxlbWVudF85NS5zdHlsZS5oZWlnaHQgPSAiMzBweCI7CiAgICAgIGVsZW1lbnRfOTUuc3R5bGUucGFkZGluZyA9ICI2cHgiOwogICAgICBlbGVtZW50Xzk1LnN0eWxlLmZsZXggPSAiMSI7CiAgICAgIGVsZW1lbnRfOTUudGV4dENvbnRlbnQgPSAiU3RvcCI7CiAgICAgIGVsZW1lbnRfOTUuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBldmVudF80ID0-IHsKICAgICAgICBldmVudF80LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgY2FwdGNoYVRhc2tTdGF0ZS5zdG9wUmVxdWVzdGVkID0gdHJ1ZTsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0by1zb2x2aW5nIHN0b3BwZWQgLSBwb3B1cCByZW1haW5zIG9wZW4iLCAiI2ZmOTgwMCIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfOTYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtY3MtYnRuIik7CiAgICAgICAgaWYgKGVsZW1lbnRfOTYpIHsKICAgICAgICAgIGVsZW1lbnRfOTYuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgIGVsZW1lbnRfOTYudGV4dENvbnRlbnQgPSBlbGVtZW50Xzk2LmRhdGFzZXQub3JpZ2luYWxUZXh0IHx8ICJBdXRvIjsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBlbGVtZW50XzkzLmFwcGVuZENoaWxkKGVsZW1lbnRfOTUpOwogICAgICBlbGVtZW50XzgyLmFwcGVuZENoaWxkKGVsZW1lbnRfOTMpOwogICAgICBlbGVtZW50XzgxLmFwcGVuZENoaWxkKGVsZW1lbnRfODIpOwogICAgICBlbGVtZW50Xzg1LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gZXZlbnRIYW5kbGVyXzEyMCgpKTsKICAgICAgZWxlbWVudF84MS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGV2ZW50XzUgPT4gewogICAgICAgIGlmIChldmVudF81LnRhcmdldCA9PT0gZWxlbWVudF84MSkgewogICAgICAgICAgZXZlbnRIYW5kbGVyXzEyMCgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGVsZW1lbnRfODkuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBhc3luYyBldmVudF82ID0-IHsKICAgICAgICBldmVudF82LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgYXdhaXQgYXN5bmNSZXN1bHRfMTIxKCk7CiAgICAgIH0pOwogICAgICBlbGVtZW50XzMxLmFwcGVuZENoaWxkKGVsZW1lbnRfODEpOwogICAgICBjb25zdCBlbGVtZW50Xzk3ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfOTcuY2xhc3NOYW1lID0gImZsZXggZ2FwLXNtIG1iLW1kIjsKICAgICAgY29uc3QgZWxlbWVudF85OCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICBlbGVtZW50Xzk4LmlkID0gInBheS1ub3ciOwogICAgICBlbGVtZW50Xzk4LmNsYXNzTmFtZSA9ICJ0b29sLWJ0bi1yb3cgYnRuLXNlY29uZGFyeSBmbGV4LTEiOwogICAgICBlbGVtZW50Xzk4LnRleHRDb250ZW50ID0gIlBheSBOb3cgKFZJU0EpIjsKICAgICAgZWxlbWVudF85OC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGV2ZW50SGFuZGxlcl8xMjIpOwogICAgICBlbGVtZW50Xzk3LmFwcGVuZENoaWxkKGVsZW1lbnRfOTgpOwogICAgICBlbGVtZW50XzY2LmFwcGVuZENoaWxkKGVsZW1lbnRfOTcpOwogICAgICBjb25zdCBlbGVtZW50Xzk5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfOTkuaWQgPSAiY2FwdGNoYS12ZXJpZnktdGltZXIiOwogICAgICBlbGVtZW50Xzk5LmNsYXNzTmFtZSA9ICJ0aW1lci1ib3ggdGV4dC1jZW50ZXIiOwogICAgICBlbGVtZW50Xzk5LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgIGVsZW1lbnRfOTkuc3R5bGUuY29sb3IgPSAidmFyKC0tY29sb3Itc3VjY2VzcykiOwogICAgICBlbGVtZW50Xzk5LnN0eWxlLmJvcmRlckNvbG9yID0gInZhcigtLWNvbG9yLXN1Y2Nlc3MpIjsKICAgICAgZWxlbWVudF85OS5zdHlsZS5iYWNrZ3JvdW5kID0gInJnYmEoMzQsIDE5NywgOTQsIDAuMikiOwogICAgICBlbGVtZW50Xzk5LnN0eWxlLnRleHRTaGFkb3cgPSAiMCAwIDEwcHggdmFyKC0tY29sb3Itc3VjY2VzcykiOwogICAgICBlbGVtZW50Xzk5LnN0eWxlLmJveFNoYWRvdyA9ICIwIDAgMTBweCByZ2JhKDM0LCAxOTcsIDk0LCAwLjMpIjsKICAgICAgZWxlbWVudF85OS5zdHlsZS5oZWlnaHQgPSAiMjRweCI7CiAgICAgIGVsZW1lbnRfOTkuc3R5bGUubGluZUhlaWdodCA9ICIyNHB4IjsKICAgICAgZWxlbWVudF85OS50ZXh0Q29udGVudCA9ICIwMjowMCI7CiAgICAgIGVsZW1lbnRfNjYuYXBwZW5kQ2hpbGQoZWxlbWVudF85OSk7CiAgICAgIGNvbnN0IGVsZW1lbnRfMTAwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgIGVsZW1lbnRfMTAwLmNsYXNzTmFtZSA9ICJmbGV4IGdhcC1zbSBtYi1tZCI7CiAgICAgIGNvbnN0IGVsZW1lbnRfMTAxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgIGVsZW1lbnRfMTAxLmlkID0gIm1ha2UtcGF5bWVudC1idG4iOwogICAgICBlbGVtZW50XzEwMS5jbGFzc05hbWUgPSAidG9vbC1idG4gYnRuLWluZm8gZmxleC0xIjsKICAgICAgZWxlbWVudF8xMDEuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgZWxlbWVudF8xMDEuc3R5bGUubWluV2lkdGggPSAiMCI7CiAgICAgIGVsZW1lbnRfMTAxLnRleHRDb250ZW50ID0gIk1ha2UgUGF5bWVudCI7CiAgICAgIGVsZW1lbnRfMTAwLmFwcGVuZENoaWxkKGVsZW1lbnRfMTAxKTsKICAgICAgY29uc3QgZWxlbWVudF8xMDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJidXR0b24iKTsKICAgICAgZWxlbWVudF8xMDIuaWQgPSAiY29weS1wYXltZW50LWxpbmstYnRuIjsKICAgICAgZWxlbWVudF8xMDIuY2xhc3NOYW1lID0gInRvb2wtYnRuIGJ0bi1zZWNvbmRhcnkgZmxleC0xIjsKICAgICAgZWxlbWVudF8xMDIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgZWxlbWVudF8xMDIuc3R5bGUubWluV2lkdGggPSAiMCI7CiAgICAgIGVsZW1lbnRfMTAyLnRleHRDb250ZW50ID0gIkNvcHkgTGluayI7CiAgICAgIGVsZW1lbnRfMTAwLmFwcGVuZENoaWxkKGVsZW1lbnRfMTAyKTsKICAgICAgZWxlbWVudF82Ni5hcHBlbmRDaGlsZChlbGVtZW50XzEwMCk7CiAgICAgIGNvbnN0IGVsZW1lbnRfMTAzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsKICAgICAgZWxlbWVudF8xMDMudGV4dENvbnRlbnQgPSAiOnJvb3R7LS1mcC1iZy1wcmltYXJ5OiMwYTBlMTQ7LS1mcC1iZy1zZWNvbmRhcnk6IzBmMTQxOTstLWZwLWJnLXRlcnRpYXJ5OiMxNTFiMjM7LS1mcC1ib3JkZXI6IzFlMjYzMzstLWZwLWFjY2VudDojMDBkNGZmOy0tZnAtYWNjZW50LWdsb3c6cmdiYSgwLDIxMiwyNTUsMC4zKTstLWZwLXN1Y2Nlc3M6IzAwZmY5ZDstLWZwLXdhcm5pbmc6I2ZmYjgwMDstLWZwLWRhbmdlcjojZmYzYjVjOy0tZnAtdGV4dDojZTZlZGYzOy0tZnAtdGV4dC1kaW06IzdkODU5MH0ubXQtY29udGFpbmVye3Bvc2l0aW9uOmZpeGVkO3RvcDoyMHB4O3JpZ2h0OjIwcHg7d2lkdGg6MzAwcHg7YmFja2dyb3VuZDp2YXIoLS1mcC1iZy1wcmltYXJ5KTtib3JkZXItcmFkaXVzOjEycHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpO2JveC1zaGFkb3c6MCAwIDQwcHggcmdiYSgwLDAsMCwwLjUpLDAgMCAyMHB4IHZhcigtLWZwLWFjY2VudC1nbG93KSxpbnNldCAwIDFweCAwIHJnYmEoMjU1LDI1NSwyNTUsMC4wMyk7ei1pbmRleDo5OTk5O2ZvbnQtZmFtaWx5OidKZXRCcmFpbnMgTW9ubycsJ1NGIE1vbm8nLCdGaXJhIENvZGUnLG1vbm9zcGFjZTtjb2xvcjp2YXIoLS1mcC10ZXh0KTtvdmVyZmxvdzpoaWRkZW59Lm10LWNvbnRhaW5lcjo6YmVmb3Jle2NvbnRlbnQ6Jyc7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3JpZ2h0OjA7aGVpZ2h0OjJweDtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCg5MGRlZyx0cmFuc3BhcmVudCx2YXIoLS1mcC1hY2NlbnQpLHRyYW5zcGFyZW50KTthbmltYXRpb246c2NhbmxpbmUgM3MgbGluZWFyIGluZmluaXRlfUBrZXlmcmFtZXMgc2NhbmxpbmV7MCV7b3BhY2l0eTowLjN9NTAle29wYWNpdHk6MX0xMDAle29wYWNpdHk6MC4zfX0ubXQtdGl0bGUtYmFye2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZyx2YXIoLS1mcC1iZy1zZWNvbmRhcnkpLHZhcigtLWZwLWJnLXByaW1hcnkpKTtwYWRkaW5nOjE0cHggMTZweDtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO2N1cnNvcjptb3ZlO3VzZXItc2VsZWN0Om5vbmU7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tZnAtYm9yZGVyKTtwb3NpdGlvbjpyZWxhdGl2ZX0ubXQtdGl0bGV7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NzAwO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEwcHg7Y29sb3I6dmFyKC0tZnAtYWNjZW50KTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6MnB4O3RleHQtc2hhZG93OjAgMCAxMHB4IHZhcigtLWZwLWFjY2VudC1nbG93KX0ubXQtdGl0bGU6OmJlZm9yZXtjb250ZW50OidbJztjb2xvcjp2YXIoLS1mcC10ZXh0LWRpbSl9Lm10LXRpdGxlOjphZnRlcntjb250ZW50OiddJztjb2xvcjp2YXIoLS1mcC10ZXh0LWRpbSl9Lm10LXRpdGxlLXRpbWVye2ZvbnQtc2l6ZToxMXB4O2NvbG9yOnZhcigtLWZwLWFjY2VudCk7dGV4dC1hbGlnbjpjZW50ZXI7ZmxleDoxO2ZvbnQtd2VpZ2h0OjYwMDtvcGFjaXR5OjAuOH0ubXQtY29udHJvbHN7ZGlzcGxheTpmbGV4O2dhcDo2cHh9Lm10LWJ0bi1taW5pbWl6ZSwubXQtYnRuLWNsb3Nle3dpZHRoOjI0cHg7aGVpZ2h0OjI0cHg7Ym9yZGVyLXJhZGl1czo0cHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpO2JhY2tncm91bmQ6dmFyKC0tZnAtYmctdGVydGlhcnkpO2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxMnB4O2NvbG9yOnZhcigtLWZwLXRleHQtZGltKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7dHJhbnNpdGlvbjphbGwgMC4ycyBlYXNlfS5tdC1idG4tbWluaW1pemU6aG92ZXJ7YmFja2dyb3VuZDp2YXIoLS1mcC1hY2NlbnQpO2NvbG9yOnZhcigtLWZwLWJnLXByaW1hcnkpO2JvcmRlci1jb2xvcjp2YXIoLS1mcC1hY2NlbnQpO2JveC1zaGFkb3c6MCAwIDE1cHggdmFyKC0tZnAtYWNjZW50LWdsb3cpfS5tdC1idG4tY2xvc2U6aG92ZXJ7YmFja2dyb3VuZDp2YXIoLS1mcC1kYW5nZXIpO2NvbG9yOiNmZmY7Ym9yZGVyLWNvbG9yOnZhcigtLWZwLWRhbmdlcik7Ym94LXNoYWRvdzowIDAgMTVweCByZ2JhKDI1NSw1OSw5MiwwLjQpfS5tdC10YWJzLWNvbnRhaW5lcntkaXNwbGF5OmZsZXg7YmFja2dyb3VuZDp2YXIoLS1mcC1iZy1zZWNvbmRhcnkpO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWZwLWJvcmRlcik7cGFkZGluZzowfS5tdC1zdGF0dXMtcGFuZWx7cGFkZGluZzoxMHB4IDE2cHg7YmFja2dyb3VuZDp2YXIoLS1mcC1iZy1zZWNvbmRhcnkpO2JvcmRlci10b3A6MXB4IHNvbGlkIHZhcigtLWZwLWJvcmRlcik7Zm9udC1zaXplOjEwcHg7Y29sb3I6dmFyKC0tZnAtYWNjZW50KTt0ZXh0LWFsaWduOmNlbnRlcjttaW4taGVpZ2h0OjM2cHg7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZvbnQtd2VpZ2h0OjUwMDtsZXR0ZXItc3BhY2luZzoxcHg7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlfS5tdC1jb250ZW50e3BhZGRpbmc6MTRweDtvdmVyZmxvdy15OmF1dG87bWF4LWhlaWdodDpjYWxjKDEwMHZoIC0gMjAwcHgpO2JhY2tncm91bmQ6dmFyKC0tZnAtYmctcHJpbWFyeSl9Lm10LWZsZXgtcm93e2Rpc3BsYXk6ZmxleDtnYXA6OHB4fS5tdC1mbGV4LWJldHdlZW57ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6OHB4fS5tdC1mbGV4LWNlbnRlcntkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXJ9Lm10LWZsZXgtY29se2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOjhweH0ubXQtbWItNnttYXJnaW4tYm90dG9tOjhweH0ubXQtc2VjdGlvbnttYXJnaW4tYm90dG9tOjhweH0ubXQtdGltZXItZGlzcGxheXtwYWRkaW5nOjEwcHg7bWFyZ2luOjEwcHggMDtiYWNrZ3JvdW5kOnZhcigtLWZwLWJnLXNlY29uZGFyeSk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpO2JvcmRlci1yYWRpdXM6NnB4O2ZvbnQtc2l6ZToxMnB4O2NvbG9yOnZhcigtLWZwLWFjY2VudCk7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTpub25lO3Bvc2l0aW9uOnJlbGF0aXZlfS5tdC10aW1lci1kaXNwbGF5OjpiZWZvcmV7Y29udGVudDonVElNRVInO3Bvc2l0aW9uOmFic29sdXRlO3RvcDotOHB4O2xlZnQ6MTBweDtmb250LXNpemU6OXB4O2JhY2tncm91bmQ6dmFyKC0tZnAtYmctcHJpbWFyeSk7cGFkZGluZzowIDZweDtjb2xvcjp2YXIoLS1mcC10ZXh0LWRpbSk7bGV0dGVyLXNwYWNpbmc6MXB4fS5tdC1ncmlke2Rpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6NzVweCA3NXB4IDc1cHg7Z3JpZC10ZW1wbGF0ZS1yb3dzOmF1dG8gYXV0byBhdXRvO2dhcDo2cHg7bWFyZ2luLWJvdHRvbTo4cHh9Lm10LXBheS1tb2RhbHtkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMTAsMTQsMjAsMC45NSk7ei1pbmRleDo5OTk5OTk7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7cGFkZGluZzoyMHB4O2JhY2tkcm9wLWZpbHRlcjpibHVyKDEwcHgpfS5tdC1wYXktY2FyZHt3aWR0aDoxMDAlO21heC13aWR0aDo5NjBweDtiYWNrZ3JvdW5kOnZhcigtLWZwLWJnLXByaW1hcnkpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tZnAtYm9yZGVyKTtib3JkZXItcmFkaXVzOjEycHg7cGFkZGluZzoyNHB4O2JveC1zaGFkb3c6MCAwIDYwcHggcmdiYSgwLDAsMCwwLjgpLDAgMCAzMHB4IHZhcigtLWZwLWFjY2VudC1nbG93KTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDoxNnB4fS5tdC1wYXktaGVhZGVye2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjthbGlnbi1pdGVtczpjZW50ZXI7cGFkZGluZy1ib3R0b206MTRweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpfS5tdC1wYXktdGl0bGV7Zm9udC1zaXplOjE2cHg7Zm9udC13ZWlnaHQ6NzAwO2NvbG9yOnZhcigtLWZwLWFjY2VudCk7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO2xldHRlci1zcGFjaW5nOjJweH0ubXQtcGF5LWNsb3Nle2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpO2JvcmRlci1yYWRpdXM6NHB4O2NvbG9yOnZhcigtLWZwLXRleHQtZGltKTtmb250LXNpemU6MTZweDtjdXJzb3I6cG9pbnRlcjtwYWRkaW5nOjZweCAxMHB4O3RyYW5zaXRpb246YWxsIDAuMnN9Lm10LXBheS1jbG9zZTpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLWZwLWRhbmdlcik7Y29sb3I6I2ZmZjtib3JkZXItY29sb3I6dmFyKC0tZnAtZGFuZ2VyKX0ubXQtcGF5LWhpbnR7Zm9udC1zaXplOjExcHg7Y29sb3I6dmFyKC0tZnAtdGV4dC1kaW0pO3RleHQtYWxpZ246Y2VudGVyO2xldHRlci1zcGFjaW5nOjAuNXB4fS5tdC1jYXB0Y2hhLWNvbnRhaW5lcnt3aWR0aDoxMDAlO2hlaWdodDo4MHB4O2JvcmRlci1yYWRpdXM6OHB4O2JhY2tncm91bmQ6dmFyKC0tZnAtYmctc2Vjb25kYXJ5KTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWZwLWJvcmRlcik7Y29sb3I6dmFyKC0tZnAtYWNjZW50KTtmb250LXNpemU6MTNweDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7dGV4dC1hbGlnbjpjZW50ZXJ9Lm10LWlucHV0LWVuaGFuY2Vke2ZvbnQtc2l6ZToxNnB4IWltcG9ydGFudDtjb2xvcjp2YXIoLS1mcC10ZXh0KSFpbXBvcnRhbnQ7dGV4dC1hbGlnbjpjZW50ZXIhaW1wb3J0YW50O2xpbmUtaGVpZ2h0OjEuMiFpbXBvcnRhbnQ7Zm9udC13ZWlnaHQ6NTAwIWltcG9ydGFudH0udG9vbC1idG57ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlO3BhZGRpbmc6MTBweDttYXJnaW46NnB4IDA7Y29sb3I6I2ZmZjtib3JkZXI6MXB4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1yYWRpdXM6NnB4O2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxMXB4O2ZvbnQtd2VpZ2h0OjYwMDtoZWlnaHQ6MzZweDtib3gtc2l6aW5nOmJvcmRlci1ib3g7dHJhbnNpdGlvbjphbGwgMC4ycyBlYXNlO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzoxcHh9LnRvb2wtYnRuOmhvdmVye3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xcHgpO2JveC1zaGFkb3c6MCA0cHggMTVweCByZ2JhKDAsMCwwLDAuMyl9LnRvb2wtYnRuOmFjdGl2ZXt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKX0udG9vbC1idG4tcm93e3BhZGRpbmc6OHB4O2NvbG9yOiNmZmY7Ym9yZGVyOjFweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOjZweDtjdXJzb3I6cG9pbnRlcjtmb250LXNpemU6MTBweDtmb250LXdlaWdodDo2MDA7aGVpZ2h0OjM2cHg7Ym94LXNpemluZzpib3JkZXItYm94O3RyYW5zaXRpb246YWxsIDAuMnMgZWFzZTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6MC41cHh9LnRvb2wtYnRuLXJvdzpob3Zlcnt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMXB4KTtib3gtc2hhZG93OjAgNHB4IDE1cHggcmdiYSgwLDAsMCwwLjMpfS50b29sLWJ0bi1yb3c6ZGlzYWJsZWR7b3BhY2l0eTowLjM7Y3Vyc29yOm5vdC1hbGxvd2VkO3RyYW5zZm9ybTpub25lfS50b29sLWlucHV0e2Rpc3BsYXk6YmxvY2s7d2lkdGg6MTAwJTtwYWRkaW5nOjEwcHggMTJweDttYXJnaW46NnB4IDA7YmFja2dyb3VuZDp2YXIoLS1mcC1iZy1zZWNvbmRhcnkpO2NvbG9yOnZhcigtLWZwLXRleHQpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tZnAtYm9yZGVyKTtib3JkZXItcmFkaXVzOjZweDtmb250LXNpemU6MTJweDtoZWlnaHQ6MzhweDtib3gtc2l6aW5nOmJvcmRlci1ib3g7dHJhbnNpdGlvbjphbGwgMC4ycyBlYXNlO2ZvbnQtZmFtaWx5OmluaGVyaXR9LnRvb2wtaW5wdXQ6Zm9jdXN7b3V0bGluZTpub25lO2JvcmRlci1jb2xvcjp2YXIoLS1mcC1hY2NlbnQpO2JveC1zaGFkb3c6MCAwIDAgM3B4IHZhcigtLWZwLWFjY2VudC1nbG93KX0udG9vbC1pbnB1dC1yb3d7cGFkZGluZzo4cHggMTBweDtiYWNrZ3JvdW5kOnZhcigtLWZwLWJnLXNlY29uZGFyeSk7Y29sb3I6dmFyKC0tZnAtdGV4dCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpO2JvcmRlci1yYWRpdXM6NnB4O2ZvbnQtc2l6ZToxMXB4O2hlaWdodDozNnB4O2JveC1zaXppbmc6Ym9yZGVyLWJveDt0cmFuc2l0aW9uOmFsbCAwLjJzIGVhc2U7Zm9udC1mYW1pbHk6aW5oZXJpdH0udG9vbC1pbnB1dC1yb3c6Zm9jdXN7b3V0bGluZTpub25lO2JvcmRlci1jb2xvcjp2YXIoLS1mcC1hY2NlbnQpO2JveC1zaGFkb3c6MCAwIDAgM3B4IHZhcigtLWZwLWFjY2VudC1nbG93KX0uY2YtYXQtYnRue3dpZHRoOjI2cHg7aGVpZ2h0OjI2cHg7Ym9yZGVyLXJhZGl1czo0cHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpO2NvbG9yOiNmZmY7Zm9udC13ZWlnaHQ6NzAwO2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxMHB4O3RyYW5zaXRpb246YWxsIDAuMnMgZWFzZTtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxMzVkZWcsIzAwYzg1MywjMDBlNjc2KX0uY2YtYXQtYnRuOmhvdmVye3RyYW5zZm9ybTpzY2FsZSgxLjEpO2JveC1zaGFkb3c6MCAwIDE1cHggcmdiYSgwLDIwMCw4MywwLjQpfS5iZ2QtZ3JpZHtkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjc1cHggNzVweCA3NXB4O2dyaWQtdGVtcGxhdGUtcm93czphdXRvIGF1dG8gYXV0bztnYXA6NnB4O21hcmdpbjowIGF1dG8gOHB4IGF1dG87anVzdGlmeS1jb250ZW50OmNlbnRlcn0uZW1wdHktY2VsbHt3aWR0aDo3NXB4O2hlaWdodDozNnB4fS5nbG9iYWwtYXV0by1idXR0b25ze2Rpc3BsYXk6ZmxleDtnYXA6OHB4O21hcmdpbi10b3A6MTBweDtwYWRkaW5nOjAgMTRweCAxNHB4fS5nbG9iYWwtYXV0by1idXR0b25zIC50b29sLWJ0bi1yb3d7aGVpZ2h0OjMycHg7cGFkZGluZzo2cHg7Zm9udC1zaXplOjlweH0ubG9naW4tdGFiIC5sb2dpbi1pbnB1dCwubG9naW4tdGFiIC5sb2dpbi1idG57aGVpZ2h0OjI4cHg7cGFkZGluZzo2cHg7Zm9udC1zaXplOjEwcHg7bWFyZ2luOjRweCAwfSNsb2dpbi1jb250ZW50e21heC1oZWlnaHQ6ODMlO2hlaWdodDo4MyV9I3BheW5vdy1jb250ZW50e21heC1oZWlnaHQ6OTAlO2hlaWdodDo5MCV9I3BheW5vdy1jb250ZW50IC50b29sLWJ0bi1yb3d7aGVpZ2h0OjMwcHg7cGFkZGluZzo1cHg7Zm9udC1zaXplOjlweH0jcGF5bm93LWNvbnRlbnQgLnRvb2wtYnRue2hlaWdodDozMHB4O3BhZGRpbmc6NXB4O2ZvbnQtc2l6ZToxMHB4fSNtdWx0aS10b29scy1jb250YWluZXIgLnRhYi1jb250ZW50e2Rpc3BsYXk6bm9uZX0jbXVsdGktdG9vbHMtY29udGFpbmVyIC50YWItY29udGVudC5hY3RpdmV7ZGlzcGxheTpibG9ja30uZmxleHtkaXNwbGF5OmZsZXh9LmZsZXgtY29se2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0uZmxleC0xe2ZsZXg6MX0uZ2FwLXNte2dhcDo2cHh9LmdhcC1tZHtnYXA6OHB4fS5tYi1zbXttYXJnaW4tYm90dG9tOjZweH0ubWItbWR7bWFyZ2luLWJvdHRvbTo4cHh9LnctZnVsbHt3aWR0aDoxMDAlfS50aW1lci1ib3h7cGFkZGluZzoxMHB4O21hcmdpbjo4cHggMDtiYWNrZ3JvdW5kOnZhcigtLWZwLWJnLXNlY29uZGFyeSk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1mcC1ib3JkZXIpO2JvcmRlci1sZWZ0OjNweCBzb2xpZCB2YXIoLS1mcC1hY2NlbnQpO2JvcmRlci1yYWRpdXM6MCA2cHggNnB4IDA7Zm9udC1zaXplOjExcHg7Y29sb3I6dmFyKC0tZnAtYWNjZW50KTt0ZXh0LWFsaWduOmNlbnRlcn0uYnRuLXByaW1hcnl7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLHZhcigtLWZwLWFjY2VudCksIzAwOTljYyk7Ym9yZGVyLWNvbG9yOnZhcigtLWZwLWFjY2VudCk7Ym94LXNoYWRvdzowIDAgMjBweCB2YXIoLS1mcC1hY2NlbnQtZ2xvdyl9LmJ0bi1zZWNvbmRhcnl7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCM4YjVjZjYsI2E3OGJmYSk7Ym9yZGVyLWNvbG9yOiM4YjVjZjZ9LmJ0bi1zdWNjZXNze2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDEzNWRlZywjMDBjODUzLCMwMGU2NzYpO2JvcmRlci1jb2xvcjojMDBjODUzO2JveC1zaGFkb3c6MCAwIDE1cHggcmdiYSgwLDIwMCw4MywwLjMpfS5idG4td2FybmluZ3tiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxMzVkZWcsI2ZmOTgwMCwjZmZiMzAwKTtib3JkZXItY29sb3I6I2ZmOTgwMDtib3gtc2hhZG93OjAgMCAxNXB4IHJnYmEoMjU1LDE1MiwwLDAuMyl9LmJ0bi1kYW5nZXJ7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCNmNDQzMzYsI2ZmNTI1Mik7Ym9yZGVyLWNvbG9yOiNmNDQzMzY7Ym94LXNoYWRvdzowIDAgMTVweCByZ2JhKDI0NCw2Nyw1NCwwLjMpfS5idG4taW5mb3tiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxMzVkZWcsIzIxOTZmMywjNjRiNWY2KTtib3JkZXItY29sb3I6IzIxOTZmMztib3gtc2hhZG93OjAgMCAxNXB4IHJnYmEoMzMsMTUwLDI0MywwLjMpfUBrZXlmcmFtZXMgbXVsdGlDb2xvckJsaW5rezAlLDEwMCV7Y29sb3I6dmFyKC0tZnAtZGFuZ2VyKTt0ZXh0LXNoYWRvdzowIDAgMTBweCB2YXIoLS1mcC1kYW5nZXIpfTMzJXtjb2xvcjp2YXIoLS1mcC13YXJuaW5nKTt0ZXh0LXNoYWRvdzowIDAgMTBweCB2YXIoLS1mcC13YXJuaW5nKX02NiV7Y29sb3I6dmFyKC0tZnAtc3VjY2Vzcyk7dGV4dC1zaGFkb3c6MCAwIDEwcHggdmFyKC0tZnAtc3VjY2Vzcyl9fS5ibGlua2luZy1vcHRpb257YW5pbWF0aW9uOm11bHRpQ29sb3JCbGluayAxLjVzIGluZmluaXRlO2ZvbnQtd2VpZ2h0OjcwMH1Aa2V5ZnJhbWVzIHB1bHNlLWdsb3d7MCUsMTAwJXtib3gtc2hhZG93OjAgMCA1cHggdmFyKC0tZnAtYWNjZW50LWdsb3cpfTUwJXtib3gtc2hhZG93OjAgMCAyMHB4IHZhcigtLWZwLWFjY2VudC1nbG93KSwwIDAgMzBweCB2YXIoLS1mcC1hY2NlbnQtZ2xvdyl9fSI7CiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZWxlbWVudF8xMDMpOwogICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC10YWItc3R5bGUiKSkgewogICAgICAgIGNvbnN0IGVsZW1lbnRfMTA0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsKICAgICAgICBlbGVtZW50XzEwNC5pZCA9ICJtdC10YWItc3R5bGUiOwogICAgICAgIGVsZW1lbnRfMTA0LnRleHRDb250ZW50ID0gIlxuICAgICAgICAgICAgICAgICNtdWx0aS10b29scy1jb250YWluZXIgLm5lb24tdGFiIHtcbiAgICAgICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDhweDtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCB0cmFuc3BhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLWZwLXRleHQtZGltLCAjN2Q4NTkwKTtcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAxMXB4O1xuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICAgICAgICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgICAgICAgICAgICAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDFweDtcbiAgICAgICAgICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAjbXVsdGktdG9vbHMtY29udGFpbmVyIC5uZW9uLXRhYiAudGFiLWxhYmVsIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgICAgICAgICB6LWluZGV4OiAyO1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1mcC10ZXh0LWRpbSwgIzdkODU5MCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgI211bHRpLXRvb2xzLWNvbnRhaW5lciAubmVvbi10YWIuaW5hY3RpdmUtdGFiOmhvdmVyIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLWZwLXRleHQsICNlNmVkZjMpO1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsMjEyLDI1NSwwLjA1KTtcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogcmdiYSgwLDIxMiwyNTUsMC4zKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAjbXVsdGktdG9vbHMtY29udGFpbmVyIC5uZW9uLXRhYi5hY3RpdmUtdGFiIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLWZwLWFjY2VudCwgIzAwZDRmZik7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b20tY29sb3I6IHZhcigtLWZwLWFjY2VudCwgIzAwZDRmZik7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwyMTIsMjU1LDAuMSk7XG4gICAgICAgICAgICAgICAgICAgIHRleHQtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsMjEyLDI1NSwwLjUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICNtdWx0aS10b29scy1jb250YWluZXIgLm5lb24tdGFiLmFjdGl2ZS10YWIgLnRhYi1sYWJlbCB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1mcC1hY2NlbnQsICMwMGQ0ZmYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICI7CiAgICAgICAgKGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hcHBlbmRDaGlsZChlbGVtZW50XzEwNCk7CiAgICAgIH0KICAgICAgZWxlbWVudF80My5hcHBlbmRDaGlsZChlbGVtZW50XzU4KTsKICAgICAgZWxlbWVudF80My5hcHBlbmRDaGlsZChlbGVtZW50XzYxKTsKICAgICAgZWxlbWVudF80My5hcHBlbmRDaGlsZChlbGVtZW50XzY2KTsKICAgICAgZWxlbWVudF8zMS5hcHBlbmRDaGlsZChlbGVtZW50XzMyKTsKICAgICAgZWxlbWVudF8zMS5hcHBlbmRDaGlsZChlbGVtZW50XzM4KTsKICAgICAgZWxlbWVudF8zMS5hcHBlbmRDaGlsZChlbGVtZW50XzQyKTsKICAgICAgZWxlbWVudF8zMS5hcHBlbmRDaGlsZChlbGVtZW50XzQzKTsKICAgICAgY29uc3QgZWxlbWVudF8xMDUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgZWxlbWVudF8xMDUuY2xhc3NOYW1lID0gImdsb2JhbC1hdXRvLWJ1dHRvbnMiOwogICAgICBlbGVtZW50XzEwNS5pbm5lckhUTUwgPSAiXG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiZ2xvYmFsLWF1dG8tci1idG5cIiBjbGFzcz1cInRvb2wtYnRuLXJvdyBidG4tc3VjY2VzcyBmbGV4LTFcIj5BdXRvPC9idXR0b24-XG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiZ2xvYmFsLXN0b3AtYnRuXCIgY2xhc3M9XCJ0b29sLWJ0bi1yb3cgYnRuLWRhbmdlciBmbGV4LTFcIj5TdG9wPC9idXR0b24-XG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiZ2xvYmFsLWF1dG8tYy1idG5cIiBjbGFzcz1cInRvb2wtYnRuLXJvdyBidG4td2FybmluZyBmbGV4LTFcIj5BUzwvYnV0dG9uPlxuICAgICAgICAiOwogICAgICBlbGVtZW50XzMxLmFwcGVuZENoaWxkKGVsZW1lbnRfMTA1KTsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50XzMxKTsKICAgICAgZnVuY3Rpb24gdmFyXzEyMygpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzEwNiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktY2FwdGNoYS1tb2RhbCIpOwogICAgICAgIGlmIChlbGVtZW50XzEwNikgewogICAgICAgICAgZWxlbWVudF8xMDYuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICAgIGNhcHRjaGFUYXNrU3RhdGUucG9wdXBDbG9zZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgY29uc3QgZWxlbWVudF8xMDcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtaW5wdXQiKTsKICAgICAgICBpZiAoZWxlbWVudF8xMDcpIHsKICAgICAgICAgIGVsZW1lbnRfMTA3LnZhbHVlID0gIiI7CiAgICAgICAgICBlbGVtZW50XzEwNy5kYXRhc2V0Lm9yaWdpbmFsVmFsdWUgPSAiIjsKICAgICAgICAgIGVsZW1lbnRfMTA3LmZvY3VzKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIGV2ZW50SGFuZGxlcl8xMjAoKSB7CiAgICAgICAgY29uc3QgZWxlbWVudF8xMDggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtbW9kYWwiKTsKICAgICAgICBpZiAoZWxlbWVudF8xMDgpIHsKICAgICAgICAgIGVsZW1lbnRfMTA4LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgfQogICAgICAgIGNhcHRjaGFUYXNrU3RhdGUucG9wdXBDbG9zZWQgPSB0cnVlOwogICAgICAgIGNhcHRjaGFUYXNrU3RhdGUuc3RvcFJlcXVlc3RlZCA9IHRydWU7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzEyNChodG1sQ29udGVudF8xMjUpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzEwOSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjZi1jYXB0Y2hhLWNvbnRhaW5lciIpOwogICAgICAgIGlmIChlbGVtZW50XzEwOSkgewogICAgICAgICAgZWxlbWVudF8xMDkuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICAgIGVsZW1lbnRfMTA5LmlubmVySFRNTCA9ICI8ZGl2IGNsYXNzPVwidy1mdWxsIGZsZXhcIiBzdHlsZT1cImhlaWdodDo4MHB4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZvbnQtc2l6ZTp2YXIoLS10ZXh0LW1kKTtjb2xvcjojMTk3NkQyO3RleHQtYWxpZ246Y2VudGVyO1wiPiIgKyBodG1sQ29udGVudF8xMjUgKyAiPC9kaXY-IjsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzEyNih2YXJfMTI3KSB7CiAgICAgICAgY29uc3QgZWxlbWVudF8xMTAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2YtY2FwdGNoYS1jb250YWluZXIiKTsKICAgICAgICBpZiAoIWVsZW1lbnRfMTEwKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJDYXB0Y2hhIGNvbnRhaW5lciBub3QgZm91bmQiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCF2YXJfMTI3KSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJObyBpbWFnZSBzb3VyY2UgcHJvdmlkZWQiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZWxlbWVudF8xMTAuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICBlbGVtZW50XzExMC5pbm5lckhUTUwgPSAiIjsKICAgICAgICBjb25zdCBlbGVtZW50XzExMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpOwogICAgICAgIGlmICh2YXJfMTI3LnN0YXJ0c1dpdGgoImRhdGE6aW1hZ2UiKSkgewogICAgICAgICAgZWxlbWVudF8xMTEuc3JjID0gdmFyXzEyNzsKICAgICAgICB9IGVsc2UgaWYgKHZhcl8xMjcuc3RhcnRzV2l0aCgiaHR0cDovLyIpIHx8IHZhcl8xMjcuc3RhcnRzV2l0aCgiaHR0cHM6Ly8iKSkgewogICAgICAgICAgZWxlbWVudF8xMTEuc3JjID0gdmFyXzEyNzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWxlbWVudF8xMTEuc3JjID0gImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwiICsgdmFyXzEyNzsKICAgICAgICB9CiAgICAgICAgZWxlbWVudF8xMTEub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkZhaWxlZCB0byBsb2FkIGNhcHRjaGEgaW1hZ2UiKTsKICAgICAgICAgIGVsZW1lbnRfMTEwLmlubmVySFRNTCA9ICI8cCBzdHlsZT1cImNvbG9yOiByZWQ7XCI-RmFpbGVkIHRvIGxvYWQgY2FwdGNoYSBpbWFnZTwvcD4iOwogICAgICAgIH07CiAgICAgICAgZWxlbWVudF8xMTEub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc29sZS5sb2coIkNhcHRjaGEgaW1hZ2UgbG9hZGVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgIH07CiAgICAgICAgZWxlbWVudF8xMTEuYWx0ID0gIkNhcHRjaGEiOwogICAgICAgIGVsZW1lbnRfMTExLmNsYXNzTmFtZSA9ICJ3LWZ1bGwiOwogICAgICAgIGVsZW1lbnRfMTExLnN0eWxlLmhlaWdodCA9ICIxMDAlIjsKICAgICAgICBlbGVtZW50XzExMS5zdHlsZS5vYmplY3RGaXQgPSAiY29udGFpbiI7CiAgICAgICAgZWxlbWVudF8xMTEuc3R5bGUuYm9yZGVyUmFkaXVzID0gInZhcigtLXJhZGl1cy1zbSkiOwogICAgICAgIGVsZW1lbnRfMTEwLmFwcGVuZENoaWxkKGVsZW1lbnRfMTExKTsKICAgICAgfQogICAgICBhc3luYyBmdW5jdGlvbiBhc3luY1Jlc3VsdF8xMjEoKSB7CiAgICAgICAgdmFyXzEyOCgpOwogICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJSZWxvYWRpbmcgUGF5bWVudCBDYXB0Y2hhLi4uIiwgIiNGRkQ3MDAiKTsKICAgICAgICBjb25zdCBlbGVtZW50XzExMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHBvaW50bWVudF9kYXRlIik7CiAgICAgICAgaWYgKCFlbGVtZW50XzExMiB8fCAhZWxlbWVudF8xMTIudmFsdWUudHJpbSgpKSB7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXBwb2ludG1lbnQgZGF0ZSBpcyByZXF1aXJlZCB0byByZWxvYWQgY2FwdGNoYSIsICIjZmY0NDQ0Iik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNhcHRjaGFQcm92aWRlckNvbmZpZy5wYXkuZW5hYmxlZCA9IGZhbHNlOwogICAgICAgIGNhcHRjaGFQcm92aWRlckNvbmZpZy5wYXkudG9rZW4gPSAiIjsKICAgICAgICB0ZXh0Q2FwdGNoYVdpZGdldCA9IG51bGw7CiAgICAgICAgaXNJbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgIG1hdGhDYXB0Y2hhV2lkZ2V0ID0gbnVsbDsKICAgICAgICB2YXJfNTUoInBheSIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCB0ZW1wXzEwNCA9IGVsZW1lbnRfMTEyLnZhbHVlLnRyaW0oKTsKICAgICAgICAgIGNvbnN0IGRlbGF5XzE2ID0gYXdhaXQgYXN5bmNSZXN1bHRfMTI5KCk7CiAgICAgICAgICBjb25zdCB0ZXh0XzIwID0gW3RlbXBfMTA0LCBkZWxheV8xNl07CiAgICAgICAgICBjb25zdCB0ZXh0XzIxID0gSlNPTi5zdHJpbmdpZnkodGV4dF8yMCk7CiAgICAgICAgICBjb25zdCBkZWxheV8xNyA9IGRhdGV0aW1lXzEzMCgicGF5U2xvdFRpbWUiKTsKICAgICAgICAgIGNvbnN0IHRleHRfMjIgPSBhd2FpdCBmZXRjaChkZWxheV8xNywgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIC4uLmNyZWF0ZU5leHRBY3Rpb25IZWFkZXJzKG5leHRBY3Rpb25Db25maWcuZ2V0U2xvdEluZm8pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAiaW5jbHVkZSIsCiAgICAgICAgICAgIHJlZmVycmVyOiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgICAgICAgICByZWZlcnJlclBvbGljeTogInNhbWUtb3JpZ2luIiwKICAgICAgICAgICAgYm9keTogdGV4dF8yMQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIXRleHRfMjIub2spIHsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkZhaWxlZCB0byByZWxvYWQgY2FwdGNoYSAoIiArIHRleHRfMjIuc3RhdHVzICsgIikiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB0ZXh0XzIzID0gYXdhaXQgdGV4dF8yMi50ZXh0KCk7CiAgICAgICAgICBjb25zdCBjb3VudF8xOCA9IHRleHRfMjMuc3BsaXQoL1xyP1xuLyk7CiAgICAgICAgICBsZXQgZGF0YV8xMiA9IG51bGw7CiAgICAgICAgICBmb3IgKGxldCBjb3VudF8xOSA9IDA7IGNvdW50XzE5IDwgY291bnRfMTgubGVuZ3RoOyBjb3VudF8xOSsrKSB7CiAgICAgICAgICAgIGNvbnN0IHRleHRfMjQgPSBjb3VudF8xOFtjb3VudF8xOV0udHJpbSgpOwogICAgICAgICAgICBpZiAodGV4dF8yNC5zdGFydHNXaXRoKCIyOiIpKSB7CiAgICAgICAgICAgICAgY29uc3QgZGF0YV8xMyA9IHRleHRfMjQuc3Vic3RyaW5nKDIpLnRyaW0oKTsKICAgICAgICAgICAgICBjb25zdCB0ZXh0XzI1ID0gZGF0YV8xMy5pbmRleE9mKCIsIik7CiAgICAgICAgICAgICAgaWYgKHRleHRfMjUgPiAtMSkgewogICAgICAgICAgICAgICAgY29uc3QgdGV4dF8yNiA9IGRhdGFfMTMuc3Vic3RyaW5nKDAsIHRleHRfMjUpLnRyaW0oKTsKICAgICAgICAgICAgICAgIGlmICh0ZXh0XzI2LmluY2x1ZGVzKCItIikgJiYgdGV4dF8yNi5sZW5ndGggPT09IDM2KSB7CiAgICAgICAgICAgICAgICAgIG1hdGhDYXB0Y2hhV2lkZ2V0ID0gdGV4dF8yNjsKICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImNhcHRjaGFfaWQiLCB0ZXh0XzI2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKGRhdGFfMTMuaW5jbHVkZXMoImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwiKSkgewogICAgICAgICAgICAgICAgY29uc3QgZGF0YV8xNCA9IGRhdGFfMTMuaW5kZXhPZigiZGF0YTppbWFnZS9wbmc7YmFzZTY0LCIpOwogICAgICAgICAgICAgICAgbGV0IHRleHRfMjcgPSBkYXRhXzEzLnN1YnN0cmluZyhkYXRhXzE0KTsKICAgICAgICAgICAgICAgIGNvbnN0IHRleHRfMjggPSB0ZXh0XzI3LmluZGV4T2YoIjE6eyIpOwogICAgICAgICAgICAgICAgaWYgKHRleHRfMjggPiAtMSkgewogICAgICAgICAgICAgICAgICB0ZXh0XzI3ID0gdGV4dF8yNy5zdWJzdHJpbmcoMCwgdGV4dF8yOCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0XzI5ID0gdGV4dF8yNy5pbmRleE9mKCJiYXNlNjQsIikgKyA3OwogICAgICAgICAgICAgICAgaWYgKHRleHRfMjkgPiA2KSB7CiAgICAgICAgICAgICAgICAgIGxldCB0ZXh0XzMwID0gdGV4dF8yNy5zdWJzdHJpbmcodGV4dF8yOSkucmVwbGFjZSgvXHMvZywgIiIpOwogICAgICAgICAgICAgICAgICBsZXQgZGF0YV8xNSA9ICIiOwogICAgICAgICAgICAgICAgICBmb3IgKGxldCBjb3VudF8yMCA9IDA7IGNvdW50XzIwIDwgdGV4dF8zMC5sZW5ndGg7IGNvdW50XzIwKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoL1tBLVphLXowLTkrXC89XS8udGVzdCh0ZXh0XzMwW2NvdW50XzIwXSkpIHsKICAgICAgICAgICAgICAgICAgICAgIGRhdGFfMTUgKz0gdGV4dF8zMFtjb3VudF8yMF07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoZGF0YV8xNS5sZW5ndGggPiAxMDApIHsKICAgICAgICAgICAgICAgICAgICBkYXRhXzEyID0gImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwiICsgZGF0YV8xNTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKGRhdGFfMTIpIHsKICAgICAgICAgICAgY2FwdGNoYVN0YXRlLmltYWdlRGF0YSA9IGRhdGFfMTI7CiAgICAgICAgICAgIHZhcl8xMjYoZGF0YV8xMik7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJDYXB0Y2hhIHJlbG9hZGVkIHN1Y2Nlc3NmdWxseSIsICIjMDBGRjAwIik7CiAgICAgICAgICAgIHZhcl84NChbNTIzLCA2NTksIDc4NCwgMTA0N10sIDAuNik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLwn5SKIENhcHRjaGEgbG9hZGVkIHNvdW5kIGFsZXJ0IHBsYXllZCIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIk5vIGNhcHRjaGEgaW1hZ2UgaW4gcmVzcG9uc2UiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKHZhcl8xMzEpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIHJlbG9hZGluZyBjYXB0Y2hhOiIsIHZhcl8xMzEpOwogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkZhaWxlZCB0byByZWxvYWQgY2FwdGNoYSIsICIjZmY0NDQ0Iik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIGV2ZW50SGFuZGxlcl8xMzIoZXZlbnRIYW5kbGVyXzEzMykgewogICAgICAgIGlmIChldmVudEhhbmRsZXJfMTMzKSB7CiAgICAgICAgICBldmVudEhhbmRsZXJfMTMzLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQogICAgICAgIGNhcHRjaGFUYXNrU3RhdGUuc3RvcFJlcXVlc3RlZCA9IGZhbHNlOwogICAgICAgIGNhcHRjaGFUYXNrU3RhdGUucG9wdXBDbG9zZWQgPSBmYWxzZTsKICAgICAgICB2YXJfMTIzKCk7CiAgICAgICAgYXN5bmNSZXN1bHRfMTIxKCk7CiAgICAgIH0KICAgICAgYXN5bmMgZnVuY3Rpb24gYXN5bmNSZXN1bHRfMTM0KGFzeW5jUmVzdWx0XzEzNSwgYXN5bmNSZXN1bHRfMTM2ID0gIm1hbnVhbCIpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzExMyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktY2FwdGNoYS1pbnB1dCIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTE0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheS1jYXB0Y2hhLW1vZGFsIik7CiAgICAgICAgbGV0IGRhdGFfMTYgPSAiIjsKICAgICAgICBpZiAoZWxlbWVudF8xMTMgJiYgZWxlbWVudF8xMTMuZGF0YXNldC5vcmlnaW5hbFZhbHVlKSB7CiAgICAgICAgICBkYXRhXzE2ID0gZWxlbWVudF8xMTMuZGF0YXNldC5vcmlnaW5hbFZhbHVlLnRyaW0oKTsKICAgICAgICB9IGVsc2UgaWYgKGFzeW5jUmVzdWx0XzEzNSkgewogICAgICAgICAgZGF0YV8xNiA9IGFzeW5jUmVzdWx0XzEzNS5yZXBsYWNlKC9ccy9nLCAiIikudHJpbSgpOwogICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudF8xMTMpIHsKICAgICAgICAgIGRhdGFfMTYgPSBlbGVtZW50XzExMy52YWx1ZS5yZXBsYWNlKC9ccy9nLCAiIikudHJpbSgpOwogICAgICAgIH0KICAgICAgICBpZiAoIWRhdGFfMTYpIHsKICAgICAgICAgIGlmIChhc3luY1Jlc3VsdF8xMzYgPT09ICJtYW51YWwiKSB7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJFbnRlciB0aGUgY2FwdGNoYSB2YWx1ZSBiZWZvcmUgdmVyaWZ5aW5nLiIsICIjZmY5ODAwIik7CiAgICAgICAgICAgIGlmIChlbGVtZW50XzExMykgewogICAgICAgICAgICAgIGVsZW1lbnRfMTEzLmZvY3VzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJDYXB0Y2hhIHNvbHV0aW9uIG1pc3NpbmcgZm9yIEF1dG8gU29sdmUuIiwgIiNmZjQ0NDQiKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKCFtYXRoQ2FwdGNoYVdpZGdldCkgewogICAgICAgICAgY29uc3QgdGVtcF8xMDUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiY2FwdGNoYV9pZCIpOwogICAgICAgICAgaWYgKHRlbXBfMTA1KSB7CiAgICAgICAgICAgIG1hdGhDYXB0Y2hhV2lkZ2V0ID0gdGVtcF8xMDU7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJMb2FkZWQgY2FwdGNoYSBJRCBmcm9tIGxvY2FsU3RvcmFnZToiLCBtYXRoQ2FwdGNoYVdpZGdldCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghbWF0aENhcHRjaGFXaWRnZXQpIHsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJMb2FkIHRoZSBjYXB0Y2hhIGJlZm9yZSB2ZXJpZnlpbmcuIiwgIiNmZjk4MDAiKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlZlcmlmeWluZyBjYXB0Y2hhLi4uIiwgIiNGRkE1MDAiKTsKICAgICAgICBjb25zdCB0ZW1wXzEwNiA9ICgpID0-IGFzeW5jUmVzdWx0XzEzNChkYXRhXzE2LCBhc3luY1Jlc3VsdF8xMzYpOwogICAgICAgIGNvbnN0IHRlbXBfMTA3ID0gKCkgPT4gewogICAgICAgICAgY29uc3QgZWxlbWVudF8xMTUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2YtYnRuLXBheW5vdy1yb3ciKTsKICAgICAgICAgIGlmIChlbGVtZW50XzExNSkgewogICAgICAgICAgICBlbGVtZW50XzExNS50ZXh0Q29udGVudCA9ICJMb2FkIjsKICAgICAgICAgICAgZWxlbWVudF8xMTUuc3R5bGUuYmFja2dyb3VuZCA9ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjRkZFQjNCLCAjRkZDMTA3KSI7CiAgICAgICAgICAgIGVsZW1lbnRfMTE1LnN0eWxlLmNvbG9yID0gIiMzMzMzMzMiOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhcl8xMjgoKTsKICAgICAgICAgIGNvbnN0IGRlbGF5XzE4ID0gYXdhaXQgYXN5bmNSZXN1bHRfMTI5KCk7CiAgICAgICAgICBjb25zdCB0ZXh0XzMxID0gW21hdGhDYXB0Y2hhV2lkZ2V0LCBkYXRhXzE2LCBkZWxheV8xOF07CiAgICAgICAgICBjb25zdCB0ZXh0XzMyID0gSlNPTi5zdHJpbmdpZnkodGV4dF8zMSk7CiAgICAgICAgICBjb25zb2xlLmxvZygiQ2FwdGNoYSBWZXJpZnkgcGF5bG9hZCBwcmVwYXJlZDoiLCB0ZXh0XzMyKTsKICAgICAgICAgIGNvbnN0IGRlbGF5XzE5ID0gZGF0ZXRpbWVfMTMwKCJjYXB0Y2hhVmVyaWZ5Iik7CiAgICAgICAgICBjb25zdCBlcnJvcl8xMyA9IGF3YWl0IGZldGNoKGRlbGF5XzE5LCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgLi4uY3JlYXRlTmV4dEFjdGlvbkhlYWRlcnMobmV4dEFjdGlvbkNvbmZpZy5jYXB0Y2hhVmVyaWZ5SW5mbykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY3JlZGVudGlhbHM6ICJpbmNsdWRlIiwKICAgICAgICAgICAgcmVmZXJyZXI6ICJodHRwczovL3BheW1lbnQuaXZhY2JkLmNvbS9hcHBsaWNhdGlvbiIsCiAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiAic2FtZS1vcmlnaW4iLAogICAgICAgICAgICBib2R5OiB0ZXh0XzMyCiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICghZXJyb3JfMTMub2spIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJlcXVlc3QgZmFpbGVkIHdpdGggc3RhdHVzICIgKyBlcnJvcl8xMy5zdGF0dXMpOwogICAgICAgICAgICBoYW5kbGVBdXRvU2VxdWVuY2VFcnJvcihlcnJvcl8xMy5zdGF0dXMpOwogICAgICAgICAgICBpZiAoZXJyb3JfMTMuc3RhdHVzID09PSA1MDAgfHwgZXJyb3JfMTMuc3RhdHVzID09PSA1MDIgfHwgZXJyb3JfMTMuc3RhdHVzID09PSA1MDQpIHsKICAgICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRlbXBfMTA3KCk7CiAgICAgICAgICAgIGlmIChlcnJvcl8xMy5zdGF0dXMgPT09IDQyMikgewogICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJDYXB0Y2hhIGluY29ycmVjdC4gUGxlYXNlIHRyeSBhZ2Fpbi4iLCAiI2ZmOTgwMCIpOwogICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTE2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheS1jYXB0Y2hhLXZlcmlmeS1idG4iKTsKICAgICAgICAgICAgICBpZiAoZWxlbWVudF8xMTYpIHsKICAgICAgICAgICAgICAgIGVsZW1lbnRfMTE2LmRhdGFzZXQubGFzdEVycm9yID0gIjQyMiI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LWNhcHRjaGEtdmVyaWZ5IiwgNDIyLCB0ZW1wXzEwNik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJwYXktY2FwdGNoYS12ZXJpZnkiLCBlcnJvcl8xMy5zdGF0dXMsIHRlbXBfMTA2KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCByZXN1bHRfNSA9IGF3YWl0IGVycm9yXzEzLnRleHQoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJDYXB0Y2hhIFZlcmlmeSByYXcgcmVzcG9uc2U6IiwgcmVzdWx0XzUpOwogICAgICAgICAgY29uc3QgY291bnRfMjEgPSByZXN1bHRfNS5zcGxpdCgvXHI_XG4vKTsKICAgICAgICAgIGxldCB0ZW1wXzEwOCA9IG51bGw7CiAgICAgICAgICBpZiAoY291bnRfMjEubGVuZ3RoID49IDIpIHsKICAgICAgICAgICAgY29uc3QgdGVtcF8xMDkgPSBjb3VudF8yMVsxXS50cmltKCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDYXB0Y2hhIFZlcmlmeSBsaW5lIDE6IiwgdGVtcF8xMDkpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGxldCB0ZW1wXzExMCA9IHRlbXBfMTA5OwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfMTExID0gdGVtcF8xMDkuaW5kZXhPZigiOiIpOwogICAgICAgICAgICAgIGlmICh0ZW1wXzExMSA-IC0xKSB7CiAgICAgICAgICAgICAgICB0ZW1wXzExMCA9IHRlbXBfMTA5LnNsaWNlKHRlbXBfMTExICsgMSkudHJpbSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0ZW1wXzEwOCA9IEpTT04ucGFyc2UodGVtcF8xMTApOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDYXB0Y2hhIFZlcmlmeSBwYXJzZWQgbGluZSAxOiIsIHRlbXBfMTA4KTsKICAgICAgICAgICAgfSBjYXRjaCAoanNvbkRhdGFfMTM3KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBwYXJzZSBsaW5lIDE6IiwganNvbkRhdGFfMTM3KTsKICAgICAgICAgICAgICB0ZW1wXzEwOCA9IHZhcl8xMzgocmVzdWx0XzUsIHsKICAgICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICAgIGxhYmVsOiAiQ2FwdGNoYSBWZXJpZnkiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRlbXBfMTA4ID0gdmFyXzEzOChyZXN1bHRfNSwgewogICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICBsYWJlbDogIkNhcHRjaGEgVmVyaWZ5IgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKCJDYXB0Y2hhIFZlcmlmeSBmaW5hbCBwYXJzZWQgcGF5bG9hZDoiLCB0ZW1wXzEwOCk7CiAgICAgICAgICBpZiAoIXRlbXBfMTA4KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gcGFyc2UgY2FwdGNoYSB2ZXJpZnkgcmVzcG9uc2UgcGF5bG9hZCIpOwogICAgICAgICAgICB0ZW1wXzEwNygpOwogICAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoInBheS1jYXB0Y2hhLXZlcmlmeSIsIG51bGwsIHRlbXBfMTA2KTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgdGVtcF8xMTIgPSBvdXRjb21lXzEzOSh0ZW1wXzEwOCwgcmVzdWx0XzUgfHwgIiIsICJDQVBUQ0hBIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgaWYgKCF0ZW1wXzExMikgewogICAgICAgICAgICBjb25zdCB0ZW1wXzExMyA9IHRlbXBfMTA4Py5tZXNzYWdlIHx8ICJDYXB0Y2hhIHZlcmlmaWNhdGlvbiBmYWlsZWQiOwogICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSh0ZW1wXzExMywgIiNmZjk4MDAiKTsKICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xMTcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtdmVyaWZ5LWJ0biIpOwogICAgICAgICAgICBpZiAoZWxlbWVudF8xMTcpIHsKICAgICAgICAgICAgICBlbGVtZW50XzExNy5kYXRhc2V0Lmxhc3RFcnJvciA9ICI0MjIiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRlbXBfMTA3KCk7CiAgICAgICAgICAgIGlmIChhdXRvUmV0cnlTdGF0ZS5lbmFibGVkKSB7CiAgICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJwYXktY2FwdGNoYS12ZXJpZnkiLCA0MjIsIHRlbXBfMTA2KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXModGVtcF8xMDgsICJDQVBUQ0hBIiwgcmVzdWx0XzUgfHwgIiIsICJDQVBUQ0hBIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseS4iLCAiQ0FQVENIQSB2ZXJpZmljYXRpb24gZmFpbGVkIik7CiAgICAgICAgICBjb25zdCBjb25maWdfMiA9IG1hdGhDYXB0Y2hhV2lkZ2V0IHx8IGRhdGFfMTY7CiAgICAgICAgICBpZiAoIW1hdGhDYXB0Y2hhV2lkZ2V0KSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybigiQ2FwdGNoYSBJRCBub3QgYXZhaWxhYmxlLCB1c2luZyBjYXB0Y2hhIGNvZGUgYXMgdG9rZW4iKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVc2luZyBjYXB0Y2hhIElEIGFzIHRva2VuOiIsIG1hdGhDYXB0Y2hhV2lkZ2V0KTsKICAgICAgICAgIH0KICAgICAgICAgIGNhcHRjaGFQcm92aWRlckNvbmZpZy5wYXkudG9rZW4gPSBjb25maWdfMjsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS50b2tlbiA9IGNvbmZpZ18yOwogICAgICAgICAgY2FwdGNoYVN0YXRlLmNmVG9rZW4gPSBjb25maWdfMjsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS5zb2x2ZWQgPSB0cnVlOwogICAgICAgICAgdGV4dENhcHRjaGFXaWRnZXQgPSBtYXRoQ2FwdGNoYVdpZGdldDsKICAgICAgICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlOwogICAgICAgICAgdmFyXzEwMyhjb25maWdfMik7CiAgICAgICAgICB2YXJfMTQwKCk7CiAgICAgICAgICB2YXJfMTQxKCk7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzExOCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjZi1idG4tcGF5bm93LXJvdyIpOwogICAgICAgICAgaWYgKGVsZW1lbnRfMTE4KSB7CiAgICAgICAgICAgIGVsZW1lbnRfMTE4LnRleHRDb250ZW50ID0gIlNvbHZlZCI7CiAgICAgICAgICAgIGVsZW1lbnRfMTE4LnN0eWxlLmJhY2tncm91bmQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzRDQUY1MCwgIzhCQzM0QSkiOwogICAgICAgICAgICBlbGVtZW50XzExOC5zdHlsZS5jb2xvciA9ICIjZmZmZmZmIjsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChlbGVtZW50XzExMykgewogICAgICAgICAgICBlbGVtZW50XzExMy52YWx1ZSA9ICIiOwogICAgICAgICAgICBlbGVtZW50XzExMy5kYXRhc2V0Lm9yaWdpbmFsVmFsdWUgPSAiIjsKICAgICAgICAgIH0KICAgICAgICAgIHZhcl83NSgpOwogICAgICAgICAgdmFyXzExMygpOwogICAgICAgICAgY29uc3QgZWxlbWVudF8xMTkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtdmVyaWZ5LWJ0biIpOwogICAgICAgICAgaWYgKGVsZW1lbnRfMTE5KSB7CiAgICAgICAgICAgIGVsZW1lbnRfMTE5LmRhdGFzZXQubGFzdEVycm9yID0gIiI7CiAgICAgICAgICB9CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IGV2ZW50SGFuZGxlcl8xMjAoKSwgMTUwKTsKICAgICAgICAgIGlmIChhdXRvUmV0cnlTdGF0ZS5lbmFibGVkICYmIGF1dG9TZXF1ZW5jZVN0YXRlLmVuYWJsZWQgJiYgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPT09IEFVVE9fU0VRVUVOQ0VfU1RFUFMuUEFZX0NBUFRDSEEpIHsKICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9XQUlUX1BBWV9OT1c7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMTE0ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMCkgKyAyMDAwOwogICAgICAgICAgICBjb25zdCBkZWxheV8yMCA9ICh0ZW1wXzExNCAvIDEwMDApLnRvRml4ZWQoMSk7CiAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBDYXB0Y2hhIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseSwgd2FpdGluZyAiICsgZGVsYXlfMjAgKyAicyBiZWZvcmUgUGF5IE5vdyIsICIjMDBGRjAwIik7CiAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLnBheU5vd1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGNhbkF1dG9TZXF1ZW5jZVByb2NlZWQoKSAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfV0FJVF9QQVlfTk9XKSB7CiAgICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9IEFVVE9fU0VRVUVOQ0VfU1RFUFMuUEFZX05PVzsKICAgICAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5lbmFibGVkKSB7CiAgICAgICAgICAgICAgICAgIHNldEF1dG9TZXF1ZW5jZUVuYWJsZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogUGF5IE5vdyB0cmlnZ2VyZWQgLSBBUyBidXR0b24gdHVybmVkIG9mZiIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoaXNCdXR0b25FbmFibGVkKCJwYXktbm93IikpIHsKICAgICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkF1dG8gU2VxdWVuY2U6IFBheSBOb3cgY2xpY2tlZCIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB0ZW1wXzExNCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGNhdGNoICh2YXJfMTQyKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJDYXB0Y2hhIHZlcmlmaWNhdGlvbiBlcnJvcjoiLCB2YXJfMTQyKTsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJDYXB0Y2hhIHZlcmlmaWNhdGlvbiBmYWlsZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgaWYgKGFzeW5jUmVzdWx0XzEzNiA9PT0gIm1hbnVhbCIgJiYgZWxlbWVudF8xMTMpIHsKICAgICAgICAgICAgZWxlbWVudF8xMTMuZm9jdXMoKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChlbGVtZW50XzExNCkgewogICAgICAgICAgICBlbGVtZW50XzExNC5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICAgICAgfQogICAgICAgICAgdGVtcF8xMDcoKTsKICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LWNhcHRjaGEtdmVyaWZ5IiwgbnVsbCwgdGVtcF8xMDYsIHsKICAgICAgICAgICAgaXNOZXR3b3JrRXJyb3I6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgICBhc3luYyBmdW5jdGlvbiBhc3luY1Jlc3VsdF8xNDMoYXN5bmNSZXN1bHRfMTQ0KSB7CiAgICAgICAgaWYgKGFzeW5jUmVzdWx0XzE0NCkgewogICAgICAgICAgYXN5bmNSZXN1bHRfMTQ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGVsZW1lbnRfMTIwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheS1jYXB0Y2hhLWlucHV0Iik7CiAgICAgICAgY29uc3QgZGVsYXlfMjEgPSBlbGVtZW50XzEyMCA_IGVsZW1lbnRfMTIwLnZhbHVlIDogIiI7CiAgICAgICAgYXdhaXQgYXN5bmNSZXN1bHRfMTM0KGRlbGF5XzIxLCAibWFudWFsIik7CiAgICAgIH0KICAgICAgYXN5bmMgZnVuY3Rpb24gYXN5bmNSZXN1bHRfMTQ1KGFzeW5jUmVzdWx0XzE0NikgewogICAgICAgIGlmIChhc3luY1Jlc3VsdF8xNDYpIHsKICAgICAgICAgIGFzeW5jUmVzdWx0XzE0Ni5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0KICAgICAgICBpZiAoIWNhcHRjaGFTdGF0ZS5pbWFnZURhdGEpIHsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJMb2FkIHRoZSBjYXB0Y2hhIGJlZm9yZSB1c2luZyBBdXRvIFNvbHZlLiIsICIjZmY5ODAwIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICghbWF0aENhcHRjaGFXaWRnZXQpIHsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJMb2FkIHRoZSBjYXB0Y2hhIGJlZm9yZSB1c2luZyBBdXRvIFNvbHZlLiIsICIjZmY5ODAwIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IGRhdGFfMTcgPSBhc3luY1Jlc3VsdF8xNDY_LmN1cnJlbnRUYXJnZXQ7CiAgICAgICAgaWYgKGRhdGFfMTcpIHsKICAgICAgICAgIGRhdGFfMTcuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgZGF0YV8xNy5kYXRhc2V0Lm9yaWdpbmFsVGV4dCA9IGRhdGFfMTcudGV4dENvbnRlbnQ7CiAgICAgICAgICBkYXRhXzE3LnRleHRDb250ZW50ID0gIi4uLiI7CiAgICAgICAgfQogICAgICAgIGNhcHRjaGFUYXNrU3RhdGUuc3RvcFJlcXVlc3RlZCA9IGZhbHNlOwogICAgICAgIGNhcHRjaGFUYXNrU3RhdGUucG9wdXBDbG9zZWQgPSBmYWxzZTsKICAgICAgICB0cnkgewogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlNvbHZpbmcgY2FwdGNoYSB2aWEgMkNhcHRjaGEuLi4iLCAiI0ZGQTUwMCIpOwogICAgICAgICAgY29uc3QgZGVsYXlfMjIgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIGlmIChjYXB0Y2hhU3RhdGUuaW1hZ2VEYXRhLnN0YXJ0c1dpdGgoImh0dHA6Ly8iKSB8fCBjYXB0Y2hhU3RhdGUuaW1hZ2VEYXRhLnN0YXJ0c1dpdGgoImh0dHBzOi8vIikpIHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IGVycm9yXzE0OwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgZXJyb3JfMTQgPSBhd2FpdCBmZXRjaChjYXB0Y2hhU3RhdGUuaW1hZ2VEYXRhLCB7CiAgICAgICAgICAgICAgICAgICAgbW9kZTogImNvcnMiLAogICAgICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAib21pdCIKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoICh2YXJfMTQ3KSB7CiAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFfMTggPSAiaHR0cHM6Ly9jb3JzcHJveHkuaW8vPyIgKyBlbmNvZGVVUklDb21wb25lbnQoY2FwdGNoYVN0YXRlLmltYWdlRGF0YSk7CiAgICAgICAgICAgICAgICAgIGVycm9yXzE0ID0gYXdhaXQgZmV0Y2goZGF0YV8xOCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIWVycm9yXzE0IHx8ICFlcnJvcl8xNC5vaykgewogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZhaWxlZCB0byBmZXRjaCBpbWFnZTogIiArIChlcnJvcl8xND8uc3RhdHVzIHx8ICJVbmtub3duIGVycm9yIikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgdXJsXzQgPSBhd2FpdCBlcnJvcl8xNC5ibG9iKCk7CiAgICAgICAgICAgICAgICBjb25zdCB1cmxfNSA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgICBjb25zdCBkZWxheV8yMyA9IG5ldyBQcm9taXNlKChwYXJhbV8xMywgYXN5bmNSZXN1bHRfMTQ4KSA9PiB7CiAgICAgICAgICAgICAgICAgIHVybF81Lm9ubG9hZGVuZCA9ICgpID0-IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRfNiA9IHVybF81LnJlc3VsdDsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wXzExNSA9IHJlc3VsdF82LmluY2x1ZGVzKCIsIikgPyByZXN1bHRfNi5zcGxpdCgiLCIpWzFdIDogcmVzdWx0XzY7CiAgICAgICAgICAgICAgICAgICAgcGFyYW1fMTModGVtcF8xMTUpOwogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB1cmxfNS5vbmVycm9yID0gYXN5bmNSZXN1bHRfMTQ4OwogICAgICAgICAgICAgICAgICB1cmxfNS5yZWFkQXNEYXRhVVJMKHVybF80KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGRlbGF5XzIzOwogICAgICAgICAgICAgIH0gY2F0Y2ggKG1lc3NhZ2VfMTQ5KSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZhaWxlZCB0byBjb252ZXJ0IGltYWdlIFVSTCB0byBiYXNlNjQ6ICIgKyBtZXNzYWdlXzE0OS5tZXNzYWdlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGNhcHRjaGFTdGF0ZS5pbWFnZURhdGEuaW5jbHVkZXMoIiwiKSkgewogICAgICAgICAgICAgIHJldHVybiBjYXB0Y2hhU3RhdGUuaW1hZ2VEYXRhLnNwbGl0KCIsIilbMV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGNhcHRjaGFTdGF0ZS5pbWFnZURhdGE7CiAgICAgICAgICB9OwogICAgICAgICAgY29uc3QgZGVsYXlfMjQgPSBhd2FpdCBkZWxheV8yMigpOwogICAgICAgICAgaWYgKCFkZWxheV8yNCkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhcHRjaGEgaW1hZ2UgZGF0YSBpcyBlbXB0eSIpOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgdGVtcF8xMTYgPSAiNzI5OTlkOTkzZTdjYTNiZWM3OTYzMGYzNmRiNjMxMDkiOwogICAgICAgICAgY29uc3QgZmV0Y2hXaXRoQ29ycyA9IGFzeW5jICh1cmxfNiwgYXN5bmNSZXN1bHRfMTUwKSA9PiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMjUgPSBhd2FpdCBmZXRjaCh1cmxfNiwgewogICAgICAgICAgICAgICAgLi4uYXN5bmNSZXN1bHRfMTUwLAogICAgICAgICAgICAgICAgbW9kZTogImNvcnMiLAogICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6ICJvbWl0IgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGlmIChkZWxheV8yNS5vaykgewogICAgICAgICAgICAgICAgcmV0dXJuIGRlbGF5XzI1OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAob3V0Y29tZV8xNTEpIHsKICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIkRpcmVjdCBmZXRjaCBmYWlsZWQsIHRyeWluZyBDT1JTIHByb3h5Li4uIiwgb3V0Y29tZV8xNTEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMjYgPSAiaHR0cHM6Ly9jb3JzcHJveHkuaW8vPyIgKyBlbmNvZGVVUklDb21wb25lbnQodXJsXzYpOwogICAgICAgICAgICAgIGNvbnN0IGRlbGF5XzI3ID0gYXdhaXQgZmV0Y2goZGVsYXlfMjYsIHsKICAgICAgICAgICAgICAgIG1ldGhvZDogYXN5bmNSZXN1bHRfMTUwLm1ldGhvZCB8fCAiUE9TVCIsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBib2R5OiBhc3luY1Jlc3VsdF8xNTAuYm9keQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGlmIChkZWxheV8yNy5vaykgewogICAgICAgICAgICAgICAgcmV0dXJuIGRlbGF5XzI3OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAob3V0Y29tZV8xNTIpIHsKICAgICAgICAgICAgICBjb25zb2xlLndhcm4oImNvcnNwcm94eS5pbyBmYWlsZWQsIHRyeWluZyBhbHRlcm5hdGl2ZS4uLiIsIG91dGNvbWVfMTUyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGNvbnN0IHVybF83ID0gImh0dHBzOi8vYXBpLmFsbG9yaWdpbnMud2luL3Jhdz91cmw9IiArIGVuY29kZVVSSUNvbXBvbmVudCh1cmxfNik7CiAgICAgICAgICAgICAgY29uc3QgaGVhZGVyc182ID0gewogICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7fSwKICAgICAgICAgICAgICAgIGJvZHk6IGFzeW5jUmVzdWx0XzE1MC5ib2R5CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBoZWFkZXJzXzYuaGVhZGVyc1siQ29udGVudC1UeXBlIl0gPSAiYXBwbGljYXRpb24vanNvbiI7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMjggPSBhd2FpdCBmZXRjaCh1cmxfNywgaGVhZGVyc182KTsKICAgICAgICAgICAgICBpZiAoZGVsYXlfMjgub2spIHsKICAgICAgICAgICAgICAgIHJldHVybiBkZWxheV8yODsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKG91dGNvbWVfMTUzKSB7CiAgICAgICAgICAgICAgY29uc29sZS53YXJuKCJhbGxvcmlnaW5zLndpbiBmYWlsZWQiLCBvdXRjb21lXzE1Myk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBjb25zdCBkZWxheV8yOSA9ICJodHRwczovL2NvcnMtYW55d2hlcmUuaGVyb2t1YXBwLmNvbS8iICsgdXJsXzY7CiAgICAgICAgICAgICAgY29uc3QgZGVsYXlfMzAgPSBhd2FpdCBmZXRjaChkZWxheV8yOSwgewogICAgICAgICAgICAgICAgbWV0aG9kOiBhc3luY1Jlc3VsdF8xNTAubWV0aG9kIHx8ICJQT1NUIiwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgICAgIlgtUmVxdWVzdGVkLVdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYm9keTogYXN5bmNSZXN1bHRfMTUwLmJvZHkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBpZiAoZGVsYXlfMzAub2spIHsKICAgICAgICAgICAgICAgIHJldHVybiBkZWxheV8zMDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKG91dGNvbWVfMTU0KSB7CiAgICAgICAgICAgICAgY29uc29sZS53YXJuKCJjb3JzLWFueXdoZXJlIGZhaWxlZCIsIG91dGNvbWVfMTU0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkFsbCBDT1JTIHByb3h5IG1ldGhvZHMgZmFpbGVkLiBQbGVhc2UgY2hlY2sgeW91ciBuZXR3b3JrIGNvbm5lY3Rpb24uIik7CiAgICAgICAgICB9OwogICAgICAgICAgY29uc3QgdGVtcF8xMTcgPSB7CiAgICAgICAgICAgIHR5cGU6ICJJbWFnZVRvVGV4dFRhc2siLAogICAgICAgICAgICBib2R5OiBkZWxheV8yNCwKICAgICAgICAgICAgcGhyYXNlOiBmYWxzZSwKICAgICAgICAgICAgY2FzZTogdHJ1ZSwKICAgICAgICAgICAgbnVtZXJpYzogMAogICAgICAgICAgfTsKICAgICAgICAgIGNvbnN0IHRlbXBfMTE4ID0gewogICAgICAgICAgICBjbGllbnRLZXk6IHRlbXBfMTE2LAogICAgICAgICAgICB0YXNrOiB0ZW1wXzExNwogICAgICAgICAgfTsKICAgICAgICAgIGNvbnN0IHRleHRfMzMgPSB0ZW1wXzExODsKICAgICAgICAgIGNvbnN0IGRlbGF5XzMxID0gYXdhaXQgZmV0Y2hXaXRoQ29ycygiaHR0cHM6Ly9hcGkuMmNhcHRjaGEuY29tL2NyZWF0ZVRhc2siLCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICB9LAogICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0ZXh0XzMzKQogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCBlcnJvcl8xNSA9IGF3YWl0IGRlbGF5XzMxLmpzb24oKTsKICAgICAgICAgIGlmIChlcnJvcl8xNS5lcnJvcklkICE9PSAwKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcl8xNS5lcnJvckRlc2NyaXB0aW9uIHx8ICJGYWlsZWQgdG8gY3JlYXRlIHRhc2siKTsKICAgICAgICAgIH0KICAgICAgICAgIGNhcHRjaGFUYXNrU3RhdGUuY3VycmVudFRhc2tJZCA9IGVycm9yXzE1LnRhc2tJZDsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJXYWl0aW5nIGZvciBzb2x1dGlvbi4uLiIsICIjRkZBNTAwIik7CiAgICAgICAgICBjb25zdCBkZWxheV8zMiA9ICgpID0-IHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChwYXJhbV8xNCwgYXN5bmNSZXN1bHRfMTU1KSA9PiB7CiAgICAgICAgICAgICAgbGV0IHRpbWVyXzk7CiAgICAgICAgICAgICAgY29uc3QgdGltZXJfMTAgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBpZiAoY2FwdGNoYVRhc2tTdGF0ZS5zdG9wUmVxdWVzdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyXzkpOwogICAgICAgICAgICAgICAgICAgIGFzeW5jUmVzdWx0XzE1NShuZXcgRXJyb3IoIkF1dG8gc29sdmUgc3RvcHBlZCBieSB1c2VyIikpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoY2FwdGNoYVRhc2tTdGF0ZS5wb3B1cENsb3NlZCkgewogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcl85KTsKICAgICAgICAgICAgICAgICAgICBhc3luY1Jlc3VsdF8xNTUobmV3IEVycm9yKCJQb3B1cCBjbG9zZWQgLSBBdXRvIFNvbHZlIGNhbmNlbGxlZCIpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dF8zNCA9IHsKICAgICAgICAgICAgICAgICAgICBjbGllbnRLZXk6IHRlbXBfMTE2LAogICAgICAgICAgICAgICAgICAgIHRhc2tJZDogZXJyb3JfMTUudGFza0lkCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdF83ID0gYXdhaXQgZmV0Y2hXaXRoQ29ycygiaHR0cHM6Ly9hcGkuMmNhcHRjaGEuY29tL2dldFRhc2tSZXN1bHQiLCB7CiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodGV4dF8zNCkKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yXzE2ID0gYXdhaXQgcmVzdWx0XzcuanNvbigpOwogICAgICAgICAgICAgICAgICBpZiAoZXJyb3JfMTYuZXJyb3JJZCAhPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcl85KTsKICAgICAgICAgICAgICAgICAgICBhc3luY1Jlc3VsdF8xNTUobmV3IEVycm9yKGVycm9yXzE2LmVycm9yRGVzY3JpcHRpb24gfHwgIlVua25vd24gZXJyb3IiKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChlcnJvcl8xNi5zdGF0dXMgPT09ICJyZWFkeSIpIHsKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXJfOSk7CiAgICAgICAgICAgICAgICAgICAgcGFyYW1fMTQoZXJyb3JfMTYuc29sdXRpb24udGV4dCk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCh0aW1lcl8xMCwgNTAwMCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHZhcl8xNTYpIHsKICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyXzkpOwogICAgICAgICAgICAgICAgICBhc3luY1Jlc3VsdF8xNTUodmFyXzE1Nik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB0aW1lcl8xMCgpOwogICAgICAgICAgICAgIHRpbWVyXzkgPSBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgIGFzeW5jUmVzdWx0XzE1NShuZXcgRXJyb3IoIjJDYXB0Y2hhIHNvbHZlIHRpbWVkIG91dC4iKSk7CiAgICAgICAgICAgICAgfSwgMjAwMDAwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwogICAgICAgICAgY29uc3QgZGVsYXlfMzMgPSBhd2FpdCBkZWxheV8zMigpOwogICAgICAgICAgY29uc3QgZWxlbWVudF8xMjEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtaW5wdXQiKTsKICAgICAgICAgIGlmIChlbGVtZW50XzEyMSAmJiBkZWxheV8zMykgewogICAgICAgICAgICBjb25zdCBkYXRhXzE5ID0gZGVsYXlfMzMucmVwbGFjZSgvXHMvZywgIiIpOwogICAgICAgICAgICBlbGVtZW50XzEyMS5kYXRhc2V0Lm9yaWdpbmFsVmFsdWUgPSBkYXRhXzE5OwogICAgICAgICAgICBlbGVtZW50XzEyMS52YWx1ZSA9IGRhdGFfMTk7CiAgICAgICAgICB9CiAgICAgICAgICBhd2FpdCBhc3luY1Jlc3VsdF8xMzQoZGVsYXlfMzMsICJjcyIpOwogICAgICAgIH0gY2F0Y2ggKHBvc2l0aW9uXzE1NykgewogICAgICAgICAgY29uc29sZS5lcnJvcigiQXV0byBzb2x2ZSBlcnJvcjoiLCBwb3NpdGlvbl8xNTcpOwogICAgICAgICAgaWYgKHBvc2l0aW9uXzE1Ny5tZXNzYWdlICYmIHBvc2l0aW9uXzE1Ny5tZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoInN0b3AiKSkgewogICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0by1zb2x2aW5nIHN0b3BwZWQiLCAiI2ZmOTgwMCIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkZhaWxlZDogIiArIHBvc2l0aW9uXzE1Ny5tZXNzYWdlLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoZGF0YV8xNykgewogICAgICAgICAgICBkYXRhXzE3LmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgIGRhdGFfMTcudGV4dENvbnRlbnQgPSBkYXRhXzE3LmRhdGFzZXQub3JpZ2luYWxUZXh0IHx8ICJBdXRvIjsKICAgICAgICAgIH0KICAgICAgICAgIGNhcHRjaGFUYXNrU3RhdGUuY3VycmVudFRhc2tJZCA9IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl8xNTgoKSB7CiAgICAgICAgY29uc3QgZWxlbWVudF8xMjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJpZnJhbWVbc3JjKj1cImNoYWxsZW5nZXMuY2xvdWRmbGFyZS5jb21cIl0iKTsKICAgICAgICBmb3IgKGNvbnN0IHRlbXBfMTE5IG9mIGVsZW1lbnRfMTIyKSB7CiAgICAgICAgICBjb25zdCB0ZW1wXzEyMCA9IHRlbXBfMTE5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgaWYgKHRlbXBfMTIwLndpZHRoID4gMCAmJiB0ZW1wXzEyMC5oZWlnaHQgPiAwKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb25zdCBlbGVtZW50XzEyMyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIi5jZi10dXJuc3RpbGUiKTsKICAgICAgICBmb3IgKGNvbnN0IGNvbnRhaW5lcl8xIG9mIGVsZW1lbnRfMTIzKSB7CiAgICAgICAgICBpZiAoY29udGFpbmVyXzEuaWQgPT09ICJjZi1jYXB0Y2hhLWNvbnRhaW5lciIpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB0ZW1wXzEyMSA9IGNvbnRhaW5lcl8xLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgaWYgKHRlbXBfMTIxLndpZHRoID4gMCAmJiB0ZW1wXzEyMS5oZWlnaHQgPiAwKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzE1OSgpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzEyNCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC1jYXB0Y2hhLXRva2VuLWlucHV0Iik7CiAgICAgICAgaWYgKGVsZW1lbnRfMTI0ICYmIGVsZW1lbnRfMTI0LnZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gZWxlbWVudF8xMjQudmFsdWU7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGVsZW1lbnRfMTI1ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2NmLWNhcHRjaGEtY29udGFpbmVyIGlucHV0W25hbWU9XCJjZi10dXJuc3RpbGUtcmVzcG9uc2VcIl0iKTsKICAgICAgICBpZiAoZWxlbWVudF8xMjUgJiYgZWxlbWVudF8xMjUudmFsdWUpIHsKICAgICAgICAgIHJldHVybiBlbGVtZW50XzEyNS52YWx1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGNhcHRjaGFTdGF0ZS50b2tlbikgewogICAgICAgICAgcmV0dXJuIGNhcHRjaGFTdGF0ZS50b2tlbjsKICAgICAgICB9CiAgICAgICAgY29uc3QgZWxlbWVudF8xMjYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJpbnB1dFtuYW1lPVwiY2YtdHVybnN0aWxlLXJlc3BvbnNlXCJdOm5vdCgjbXQtY2FwdGNoYS10b2tlbi1pbnB1dCkiKTsKICAgICAgICBpZiAoZWxlbWVudF8xMjYgJiYgZWxlbWVudF8xMjYudmFsdWUpIHsKICAgICAgICAgIHJldHVybiBlbGVtZW50XzEyNi52YWx1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdGltZXJDYWxsYmFja18xNjAoKSB7CiAgICAgICAgaWYgKCF2YXJfMTU4KCkpIHsKICAgICAgICAgIGlmIChjYXB0Y2hhU3RhdGUubW9uaXRvckludGVydmFsKSB7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoY2FwdGNoYVN0YXRlLm1vbml0b3JJbnRlcnZhbCk7CiAgICAgICAgICAgIGNhcHRjaGFTdGF0ZS5tb25pdG9ySW50ZXJ2YWwgPSBudWxsOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCB0b2tlbl85ID0gdmFyXzE1OSgpOwogICAgICAgIGlmICh0b2tlbl85ICYmIHRva2VuXzkgIT09IGNhcHRjaGFTdGF0ZS50b2tlbikgewogICAgICAgICAgY2FwdGNoYVN0YXRlLnRva2VuID0gdG9rZW5fOTsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS5zb2x2ZWQgPSB0cnVlOwogICAgICAgICAgY2FwdGNoYVN0YXRlLmlzUGFnZUNhcHRjaGEgPSB0cnVlOwogICAgICAgICAgdmFyXzE0MCgpOwogICAgICAgICAgdmFyXzE0MSgpOwogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlBhZ2UgQ0FQVENIQSBTb2x2ZWQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgdmFyXzc1KCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHRpbWVyQ2FsbGJhY2tfMTYxKCkgewogICAgICAgIGNvbnN0IHRlbXBfMTIyID0gdmFyXzE1OCgpOwogICAgICAgIGlmICh0ZW1wXzEyMikgewogICAgICAgICAgaWYgKCFjYXB0Y2hhU3RhdGUubW9uaXRvckludGVydmFsKSB7CiAgICAgICAgICAgIGNhcHRjaGFTdGF0ZS5tb25pdG9ySW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh0aW1lckNhbGxiYWNrXzE2MCwgNTAwKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIlN0YXJ0ZWQgbW9uaXRvcmluZyBwYWdlIENBUFRDSEEiKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNhcHRjaGFTdGF0ZS5tb25pdG9ySW50ZXJ2YWwpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoY2FwdGNoYVN0YXRlLm1vbml0b3JJbnRlcnZhbCk7CiAgICAgICAgICBjYXB0Y2hhU3RhdGUubW9uaXRvckludGVydmFsID0gbnVsbDsKICAgICAgICAgIGNvbnNvbGUubG9nKCJTdG9wcGVkIG1vbml0b3JpbmcgcGFnZSBDQVBUQ0hBIik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl8xNjIoKSB7CiAgICAgICAgY29uc29sZS5sb2coIlJlbG9hZGluZyBDQVBUQ0hBIik7CiAgICAgICAgdmFyXzE2MygpOwogICAgICAgIGlmIChjYXB0Y2hhU3RhdGUuaGlkZVRpbWVvdXQpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChjYXB0Y2hhU3RhdGUuaGlkZVRpbWVvdXQpOwogICAgICAgICAgY2FwdGNoYVN0YXRlLmhpZGVUaW1lb3V0ID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKHZhcl8xNTgoKSkgewogICAgICAgICAgY29uc29sZS5sb2coIlBhZ2UgaGFzIGl0cyBvd24gQ0FQVENIQSwgdHJ5aW5nIHRvIHJlc2V0IGl0Iik7CiAgICAgICAgICBjYXB0Y2hhU3RhdGUuaXNQYWdlQ2FwdGNoYSA9IHRydWU7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAod2luZG93LnR1cm5zdGlsZSAmJiB0eXBlb2Ygd2luZG93LnR1cm5zdGlsZS5yZW5kZXIgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICBjb25zdCBjb3VudF8yMiA9IHdpbmRvdy50dXJuc3RpbGUuZ2V0V2lkZ2V0cygpOwogICAgICAgICAgICAgIGlmIChjb3VudF8yMiAmJiBjb3VudF8yMi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cudHVybnN0aWxlLnJlc2V0KGNvdW50XzIyWzBdKTsKICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJQYWdlIENBUFRDSEEgUmVsb2FkZWQiLCAiIzAwQzg1MSIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAodmFyXzE2NCkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciByZXNldHRpbmcgcGFnZSBDQVBUQ0hBOiIsIHZhcl8xNjQpOwogICAgICAgICAgfQogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlBsZWFzZSByZWxvYWQgdGhlIHBhZ2UgdG8gcmVzZXQgQ0FQVENIQSIsICIjZmY5ODAwIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCJQYWdlIGRvZXNuJ3QgaGF2ZSBDQVBUQ0hBLCBjcmVhdGluZyBvdXIgb3duIik7CiAgICAgICAgY2FwdGNoYVN0YXRlLmlzUGFnZUNhcHRjaGEgPSBmYWxzZTsKICAgICAgICBjb25zdCBlbGVtZW50XzEyNyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjZi1jYXB0Y2hhLWNvbnRhaW5lciIpOwogICAgICAgIGlmICghZWxlbWVudF8xMjcpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkNBUFRDSEEgY29udGFpbmVyIG5vdCBmb3VuZCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBlbGVtZW50XzEyNy5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBjYXB0Y2hhU3RhdGUudmlzaWJsZSA9IHRydWU7CiAgICAgICAgaWYgKHdpbmRvdy50dXJuc3RpbGUgJiYgY2FwdGNoYVN0YXRlLndpZGdldCkgewogICAgICAgICAgdHVybnN0aWxlLnJlc2V0KGNhcHRjaGFTdGF0ZS53aWRnZXQpOwogICAgICAgICAgY29uc29sZS5sb2coIkNBUFRDSEEgd2lkZ2V0IHJlc2V0Iik7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQ0FQVENIQSBSZWxvYWRlZCIsICIjMDBDODUxIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChjYXB0Y2hhU3RhdGUud2lkZ2V0KSB7CiAgICAgICAgICAgIHR1cm5zdGlsZS5yZW1vdmUoY2FwdGNoYVN0YXRlLndpZGdldCk7CiAgICAgICAgICAgIGNhcHRjaGFTdGF0ZS53aWRnZXQgPSBudWxsOwogICAgICAgICAgfQogICAgICAgICAgZWxlbWVudF8xMjcuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICB2YXJfMTY1KCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl8xNjUoKSB7CiAgICAgICAgY29uc29sZS5sb2coIlJlbmRlcmluZyBDQVBUQ0hBIHdpZGdldCIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTI4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNmLWNhcHRjaGEtY29udGFpbmVyIik7CiAgICAgICAgaWYgKCFlbGVtZW50XzEyOCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCB0YWJfMSA9IGdldFNpdGVLZXkoY3VycmVudFRhYik7CiAgICAgICAgY2FwdGNoYVN0YXRlLndpZGdldCA9IHR1cm5zdGlsZS5yZW5kZXIoZWxlbWVudF8xMjgsIHsKICAgICAgICAgIHNpdGVrZXk6IHRhYl8xLAogICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFja18xKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDYXB0Y2hhIGNhbGxiYWNrIHJlY2VpdmVkIHRva2VuIik7CiAgICAgICAgICAgIGNhcHRjaGFTdGF0ZS50b2tlbiA9IGNhbGxiYWNrXzE7CiAgICAgICAgICAgIGNhcHRjaGFTdGF0ZS5jZlRva2VuID0gY2FsbGJhY2tfMTsKICAgICAgICAgICAgY2FwdGNoYVN0YXRlLnNvbHZlZCA9IHRydWU7CiAgICAgICAgICAgIHZhcl8xNDAoKTsKICAgICAgICAgICAgdmFyXzc1KCk7CiAgICAgICAgICAgIHZhcl8xNDEoKTsKICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkNsb3VkZmxhcmUgVmVyaWZpZWQiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICBjYXB0Y2hhU3RhdGUuaGlkZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICBpZiAoZWxlbWVudF8xMjgpIHsKICAgICAgICAgICAgICAgIGVsZW1lbnRfMTI4LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNhcHRjaGFTdGF0ZS52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgfSwKICAgICAgICAgICJleHBpcmVkLWNhbGxiYWNrIjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiQ2FwdGNoYSBleHBpcmVkIik7CiAgICAgICAgICAgIHZhcl8xNjMoKTsKICAgICAgICAgIH0sCiAgICAgICAgICAiZXJyb3ItY2FsbGJhY2siOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDYXB0Y2hhIGVycm9yIik7CiAgICAgICAgICAgIHZhcl8xNjMoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB2YXJfMTY2KCk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzE2MygpIHsKICAgICAgICBjb25zb2xlLmxvZygiUmVzZXR0aW5nIENBUFRDSEEgc3RhdGUiKTsKICAgICAgICBjYXB0Y2hhU3RhdGUudG9rZW4gPSAiIjsKICAgICAgICBjYXB0Y2hhU3RhdGUuY2ZUb2tlbiA9ICIiOwogICAgICAgIGNhcHRjaGFTdGF0ZS5jZnBUb2tlbiA9ICIiOwogICAgICAgIGNhcHRjaGFTdGF0ZS5zb2x2ZWQgPSBmYWxzZTsKICAgICAgICBjb25zdCBlbGVtZW50XzEyOSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC1jYXB0Y2hhLXRva2VuLWlucHV0Iik7CiAgICAgICAgaWYgKGVsZW1lbnRfMTI5KSB7CiAgICAgICAgICBlbGVtZW50XzEyOS52YWx1ZSA9ICIiOwogICAgICAgIH0KICAgICAgICB2YXJfMTQwKCk7CiAgICAgICAgdmFyXzE2NygpOwogICAgICAgIHZhcl8xNDEoKTsKICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTY2KCkgewogICAgICAgIGNvbnNvbGUubG9nKCJTZXR0aW5nIHVwIENBUFRDSEEgY2hlY2tib3ggdGlja2luZyIpOwogICAgICAgIGlmIChjYXB0Y2hhU3RhdGUuYXV0b0NoZWNrSW50ZXJ2YWwpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoY2FwdGNoYVN0YXRlLmF1dG9DaGVja0ludGVydmFsKTsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS5hdXRvQ2hlY2tJbnRlcnZhbCA9IG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChjYXB0Y2hhU3RhdGUuaXNQYWdlQ2FwdGNoYSkgewogICAgICAgICAgY29uc29sZS5sb2coIlVzaW5nIHBhZ2UncyBDQVBUQ0hBLCBub3Qgc2V0dGluZyB1cCBhdXRvbWF0aWMgdGlja2luZyIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjYXB0Y2hhU3RhdGUuYXV0b0NoZWNrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzEzMCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjZi1jYXB0Y2hhLWNvbnRhaW5lciIpOwogICAgICAgICAgaWYgKGVsZW1lbnRfMTMwKSB7CiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTMxID0gZWxlbWVudF8xMzAucXVlcnlTZWxlY3RvckFsbCgiaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdIik7CiAgICAgICAgICAgIGVsZW1lbnRfMTMxLmZvckVhY2goaXRlbV85ID0-IHsKICAgICAgICAgICAgICBpZiAoIWl0ZW1fOS5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRm91bmQgY2hlY2tib3ggaW4gb3VyIGNhcHRjaGEgY29udGFpbmVyLCBhdHRlbXB0aW5nIHRvIHRpY2sgaXQgYXV0b21hdGljYWxseSIpOwogICAgICAgICAgICAgICAgdmFyXzE2OChpdGVtXzkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgNTAwKTsKICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTY4KGV2ZW50SGFuZGxlcl8xNjkpIHsKICAgICAgICBpZiAoIWV2ZW50SGFuZGxlcl8xNjkuY2hlY2tlZCkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlRpY2tpbmcgY2hlY2tib3giKTsKICAgICAgICAgICAgY29uc3QgdGVtcF8xMjMgPSB7CiAgICAgICAgICAgICAgYnViYmxlczogdHJ1ZSwKICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLAogICAgICAgICAgICAgIHZpZXc6IHdpbmRvdwogICAgICAgICAgICB9OwogICAgICAgICAgICBjb25zdCB0ZW1wXzEyNCA9IG5ldyBNb3VzZUV2ZW50KCJtb3VzZWRvd24iLCB0ZW1wXzEyMyk7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMTI1ID0gewogICAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsCiAgICAgICAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICB2aWV3OiB3aW5kb3cKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3QgdGVtcF8xMjYgPSBuZXcgTW91c2VFdmVudCgibW91c2V1cCIsIHRlbXBfMTI1KTsKICAgICAgICAgICAgY29uc3QgdGVtcF8xMjcgPSB7CiAgICAgICAgICAgICAgYnViYmxlczogdHJ1ZSwKICAgICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLAogICAgICAgICAgICAgIHZpZXc6IHdpbmRvdwogICAgICAgICAgICB9OwogICAgICAgICAgICBjb25zdCB0ZW1wXzEyOCA9IG5ldyBNb3VzZUV2ZW50KCJjbGljayIsIHRlbXBfMTI3KTsKICAgICAgICAgICAgY29uc3QgdGVtcF8xMjkgPSBuZXcgRXZlbnQoImNoYW5nZSIsIHsKICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLAogICAgICAgICAgICAgIGNhbmNlbGFibGU6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGV2ZW50SGFuZGxlcl8xNjkuZGlzcGF0Y2hFdmVudCh0ZW1wXzEyNCk7CiAgICAgICAgICAgIGV2ZW50SGFuZGxlcl8xNjkuZGlzcGF0Y2hFdmVudChtb3VzZXVwKTsKICAgICAgICAgICAgZXZlbnRIYW5kbGVyXzE2OS5kaXNwYXRjaEV2ZW50KHRlbXBfMTI4KTsKICAgICAgICAgICAgZXZlbnRIYW5kbGVyXzE2OS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgZXZlbnRIYW5kbGVyXzE2OS5kaXNwYXRjaEV2ZW50KHRlbXBfMTI5KTsKICAgICAgICAgICAgY29uc29sZS5sb2coIlN1Y2Nlc3NmdWxseSB0aWNrZWQgY2hlY2tib3giKTsKICAgICAgICAgIH0gY2F0Y2ggKHZhcl8xNzApIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgdGlja2luZyBjaGVja2JveDoiLCB2YXJfMTcwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgbGV0IHRlbXBfMTMwID0gZmFsc2U7CiAgICAgIGxldCBmb3JtRGF0YV8xOwogICAgICBsZXQgZm9ybURhdGFfMjsKICAgICAgbGV0IHRlbXBfMTMxOwogICAgICBsZXQgdGVtcF8xMzI7CiAgICAgIGxldCB0ZW1wXzEzMyA9IDA7CiAgICAgIGxldCB0ZW1wXzEzNCA9IDA7CiAgICAgIGVsZW1lbnRfMzIuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgZXZlbnRIYW5kbGVyXzE3MSk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIGV2ZW50SGFuZGxlcl8xNzIpOwogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwgZXZlbnRIYW5kbGVyXzE3Myk7CiAgICAgIGZ1bmN0aW9uIGV2ZW50SGFuZGxlcl8xNzEodmFyXzE3NCkgewogICAgICAgIHRlbXBfMTMxID0gdmFyXzE3NC5jbGllbnRYIC0gdGVtcF8xMzM7CiAgICAgICAgdGVtcF8xMzIgPSB2YXJfMTc0LmNsaWVudFkgLSB0ZW1wXzEzNDsKICAgICAgICBpZiAodmFyXzE3NC50YXJnZXQgPT09IGVsZW1lbnRfMzIgfHwgdmFyXzE3NC50YXJnZXQucGFyZW50Tm9kZSA9PT0gZWxlbWVudF8zMikgewogICAgICAgICAgdGVtcF8xMzAgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiBldmVudEhhbmRsZXJfMTcyKGV2ZW50SGFuZGxlcl8xNzUpIHsKICAgICAgICBpZiAodGVtcF8xMzApIHsKICAgICAgICAgIGV2ZW50SGFuZGxlcl8xNzUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIGZvcm1EYXRhXzEgPSBldmVudEhhbmRsZXJfMTc1LmNsaWVudFggLSB0ZW1wXzEzMTsKICAgICAgICAgIGZvcm1EYXRhXzIgPSBldmVudEhhbmRsZXJfMTc1LmNsaWVudFkgLSB0ZW1wXzEzMjsKICAgICAgICAgIHRlbXBfMTMzID0gZm9ybURhdGFfMTsKICAgICAgICAgIHRlbXBfMTM0ID0gZm9ybURhdGFfMjsKICAgICAgICAgIGVsZW1lbnRfMzEuc3R5bGUudHJhbnNmb3JtID0gInRyYW5zbGF0ZSgiICsgZm9ybURhdGFfMSArICJweCwgIiArIGZvcm1EYXRhXzIgKyAicHgpIjsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZXZlbnRIYW5kbGVyXzE3Myh2YXJfMTc2KSB7CiAgICAgICAgdGVtcF8xMzEgPSBmb3JtRGF0YV8xOwogICAgICAgIHRlbXBfMTMyID0gZm9ybURhdGFfMjsKICAgICAgICB0ZW1wXzEzMCA9IGZhbHNlOwogICAgICB9CiAgICAgIGVsZW1lbnRfMzYuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgZWxlbWVudF8zMS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTMyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgICAgZWxlbWVudF8xMzIuaWQgPSAibXQtcmVzdG9yZS1idG4iOwogICAgICAgIGVsZW1lbnRfMTMyLnRleHRDb250ZW50ID0gIk1UIjsKICAgICAgICBlbGVtZW50XzEzMi5zdHlsZS5jc3NUZXh0ID0gIlxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgICAgICBib3R0b206IDIwcHg7XG4gICAgICAgICAgICAgICAgcmlnaHQ6IDIwcHg7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDQwcHg7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA0MHB4O1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjRkY0MDgxLCAjMjE5NkYzKTtcbiAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICAgICAgICAgICAgY29sb3I6IHdoaXRlO1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMThweDtcbiAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICAgICAgei1pbmRleDogOTk5OTtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlO1xuICAgICAgICAgICAgIjsKICAgICAgICBlbGVtZW50XzEzMi5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWVudGVyIiwgKCkgPT4gewogICAgICAgICAgZWxlbWVudF8xMzIuc3R5bGUudHJhbnNmb3JtID0gInNjYWxlKDEuMSkiOwogICAgICAgIH0pOwogICAgICAgIGVsZW1lbnRfMTMyLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbGVhdmUiLCAoKSA9PiB7CiAgICAgICAgICBlbGVtZW50XzEzMi5zdHlsZS50cmFuc2Zvcm0gPSAic2NhbGUoMSkiOwogICAgICAgIH0pOwogICAgICAgIGVsZW1lbnRfMTMyLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAgICAgZWxlbWVudF8zMS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgIGVsZW1lbnRfMTMyLnJlbW92ZSgpOwogICAgICAgIH0pOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudF8xMzIpOwogICAgICB9KTsKICAgICAgbGV0IHRpbWVyXzExID0gbnVsbDsKICAgICAgZWxlbWVudF8zNy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0-IHsKICAgICAgICBpZiAoY2FwdGNoYVN0YXRlLmF1dG9DaGVja0ludGVydmFsKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKGNhcHRjaGFTdGF0ZS5hdXRvQ2hlY2tJbnRlcnZhbCk7CiAgICAgICAgICBjYXB0Y2hhU3RhdGUuYXV0b0NoZWNrSW50ZXJ2YWwgPSBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAoY2FwdGNoYVN0YXRlLm1vbml0b3JJbnRlcnZhbCkgewogICAgICAgICAgY2xlYXJJbnRlcnZhbChjYXB0Y2hhU3RhdGUubW9uaXRvckludGVydmFsKTsKICAgICAgICAgIGNhcHRjaGFTdGF0ZS5tb25pdG9ySW50ZXJ2YWwgPSBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAodGltZXJfMTEpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXJfMTEpOwogICAgICAgICAgdGltZXJfMTEgPSBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAobGFzdFJlcXVlc3RUaW1lKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKGxhc3RSZXF1ZXN0VGltZSk7CiAgICAgICAgICBsYXN0UmVxdWVzdFRpbWUgPSBudWxsOwogICAgICAgIH0KICAgICAgICB2YXJfMTc3KCk7CiAgICAgICAgaWYgKHJlZnJlc2hUaW1lcnMuY29udGludWVUaW1lb3V0KSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQocmVmcmVzaFRpbWVycy5jb250aW51ZVRpbWVvdXQpOwogICAgICAgICAgcmVmcmVzaFRpbWVycy5jb250aW51ZVRpbWVvdXQgPSBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAocmVmcmVzaFRpbWVycy5yZWZyZXNoSW50ZXJ2YWwpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwocmVmcmVzaFRpbWVycy5yZWZyZXNoSW50ZXJ2YWwpOwogICAgICAgICAgcmVmcmVzaFRpbWVycy5yZWZyZXNoSW50ZXJ2YWwgPSBudWxsOwogICAgICAgIH0KICAgICAgICBjb25zdCB0aW1lcl8xMiA9IFsibG9naW4tb3RwLXRpbWVyLWRpc3BsYXkiLCAiYmdkLW90cC10aW1lci1kaXNwbGF5IiwgInBheS10aW1lci1kaXNwbGF5Il07CiAgICAgICAgdGltZXJfMTIuZm9yRWFjaChpdGVtXzEwID0-IHsKICAgICAgICAgIGNvbnN0IHRpbWVyXzEzID0gd2luZG93WyJ0aW1lckludGVydmFsXyIgKyBpdGVtXzEwXTsKICAgICAgICAgIGlmICh0aW1lcl8xMykgewogICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyXzEzKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3VzZWRvd24iLCBldmVudEhhbmRsZXJfMTcxKTsKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLCBldmVudEhhbmRsZXJfMTcyKTsKICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwgZXZlbnRIYW5kbGVyXzE3Myk7CiAgICAgICAgY29uc3QgZWxlbWVudF8xMzMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtbW9kYWwiKTsKICAgICAgICBpZiAoZWxlbWVudF8xMzMpIHsKICAgICAgICAgIGVsZW1lbnRfMTMzLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgfQogICAgICAgIGlmIChlbGVtZW50XzMxICYmIGVsZW1lbnRfMzEucGFyZW50Tm9kZSkgewogICAgICAgICAgZWxlbWVudF8zMS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnRfMzEpOwogICAgICAgIH0KICAgICAgICBjb25zdCBlbGVtZW50XzEzNCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC1yZXN0b3JlLWJ0biIpOwogICAgICAgIGlmIChlbGVtZW50XzEzNCkgewogICAgICAgICAgZWxlbWVudF8xMzQucmVtb3ZlKCk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGVsZW1lbnRfMTM1ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRva2VuLW9wdGlvbnMtY29udGFpbmVyIik7CiAgICAgICAgaWYgKGVsZW1lbnRfMTM1KSB7CiAgICAgICAgICBlbGVtZW50XzEzNS5yZW1vdmUoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGVsZW1lbnRfMTAzICYmIGVsZW1lbnRfMTAzLnBhcmVudE5vZGUpIHsKICAgICAgICAgIGVsZW1lbnRfMTAzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudF8xMDMpOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZygiV2lkZ2V0IGNvbXBsZXRlbHkgcmVtb3ZlZCIpOwogICAgICB9KTsKICAgICAgZnVuY3Rpb24gZXZlbnRIYW5kbGVyXzE3OChldmVudEhhbmRsZXJfMTc5LCBldmVudEhhbmRsZXJfMTgwLCBldmVudEhhbmRsZXJfMTgxKSB7CiAgICAgICAgY29uc3QgZWxlbWVudF8xMzYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChldmVudEhhbmRsZXJfMTc5KTsKICAgICAgICBpZiAoZWxlbWVudF8xMzYpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJBdHRhY2hpbmcgZXZlbnQgbGlzdGVuZXIgdG8gZWxlbWVudCB3aXRoIGlkICciICsgZXZlbnRIYW5kbGVyXzE3OSArICInIik7CiAgICAgICAgICBlbGVtZW50XzEzNi5hZGRFdmVudExpc3RlbmVyKGV2ZW50SGFuZGxlcl8xODAsIGV2ZW50SGFuZGxlcl8xODEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJFbGVtZW50IHdpdGggaWQgJyIgKyBldmVudEhhbmRsZXJfMTc5ICsgIicgbm90IGZvdW5kIik7CiAgICAgICAgfQogICAgICB9CiAgICAgIGV2ZW50SGFuZGxlcl8xNzgoImdsb2JhbC1hdXRvLXItYnRuIiwgImNsaWNrIiwgZXZlbnRIYW5kbGVyXzY0KTsKICAgICAgZXZlbnRIYW5kbGVyXzE3OCgiZ2xvYmFsLWF1dG8tYy1idG4iLCAiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgc2V0QXV0b1NlcXVlbmNlRW5hYmxlZCghYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCk7CiAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmVuYWJsZWQpIHsKICAgICAgICAgIHZhcl82MCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXJfNjEoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBldmVudEhhbmRsZXJfMTc4KCJnbG9iYWwtc3RvcC1idG4iLCAiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coIlN0b3AgYnV0dG9uIGNsaWNrZWQgLSBjbGVhcmluZyBhbGwgcHJvY2Vzc2VzIik7CiAgICAgICAgdmFyXzE3NygpOwogICAgICAgIGNsZWFyQWxsQXV0b1JldHJ5VGltZXJzKCk7CiAgICAgICAgcmVzZXRBdXRvU2VxdWVuY2VTdGF0ZSgpOwogICAgICAgIHZhcl82MSgpOwogICAgICAgIGlmIChyZWZyZXNoVGltZXJzLmNvbnRpbnVlVGltZW91dCkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHJlZnJlc2hUaW1lcnMuY29udGludWVUaW1lb3V0KTsKICAgICAgICAgIHJlZnJlc2hUaW1lcnMuY29udGludWVUaW1lb3V0ID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKHJlZnJlc2hUaW1lcnMucmVmcmVzaEludGVydmFsKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKHJlZnJlc2hUaW1lcnMucmVmcmVzaEludGVydmFsKTsKICAgICAgICAgIHJlZnJlc2hUaW1lcnMucmVmcmVzaEludGVydmFsID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGxhc3RSZXF1ZXN0VGltZSkgewogICAgICAgICAgY2xlYXJJbnRlcnZhbChsYXN0UmVxdWVzdFRpbWUpOwogICAgICAgICAgbGFzdFJlcXVlc3RUaW1lID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGNhcHRjaGFTdGF0ZS5hdXRvQ2hlY2tJbnRlcnZhbCkgewogICAgICAgICAgY2xlYXJJbnRlcnZhbChjYXB0Y2hhU3RhdGUuYXV0b0NoZWNrSW50ZXJ2YWwpOwogICAgICAgICAgY2FwdGNoYVN0YXRlLmF1dG9DaGVja0ludGVydmFsID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGNhcHRjaGFTdGF0ZS5tb25pdG9ySW50ZXJ2YWwpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoY2FwdGNoYVN0YXRlLm1vbml0b3JJbnRlcnZhbCk7CiAgICAgICAgICBjYXB0Y2hhU3RhdGUubW9uaXRvckludGVydmFsID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKHRpbWVyXzExKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyXzExKTsKICAgICAgICAgIHRpbWVyXzExID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkFsbCBwcm9jZXNzZXMgc3RvcHBlZCIsICIjZmY0NDQ0Iik7CiAgICAgIH0pOwogICAgICBmdW5jdGlvbiB2YXJfMTgyKHJlZ2V4TWF0Y2hfMTgzKSB7CiAgICAgICAgaWYgKCFyZWdleE1hdGNoXzE4MykgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGlmICgvXmh0dHBzPzpcL1wvL2kudGVzdChyZWdleE1hdGNoXzE4MykpIHsKICAgICAgICAgIHJldHVybiByZWdleE1hdGNoXzE4MzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFwaUJhc2VVcmwgKyByZWdleE1hdGNoXzE4MzsKICAgICAgfQogICAgICBmdW5jdGlvbiBkYXRldGltZV8xMzAodmFyXzE4NCkgewogICAgICAgIGlmIChlbmRwb2ludHMubG9naW5bdmFyXzE4NF0pIHsKICAgICAgICAgIHJldHVybiB2YXJfMTgyKGVuZHBvaW50cy5sb2dpblt2YXJfMTg0XSk7CiAgICAgICAgfQogICAgICAgIGlmIChlbmRwb2ludHMucGF5bWVudFt2YXJfMTg0XSkgewogICAgICAgICAgcmV0dXJuIHZhcl8xODIoZW5kcG9pbnRzLnBheW1lbnRbdmFyXzE4NF0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdmFyXzE4Mih2YXJfMTg0KSB8fCBhcGlCYXNlVXJsICsgdmFyXzE4NDsKICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTg1KCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiaXZhY19lZGl0ZWRfZGF0YSIsIEpTT04uc3RyaW5naWZ5KGVkaXRlZERhdGEpKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJTYXZlZCBlZGl0ZWQgZGF0YSB0byBsb2NhbFN0b3JhZ2U6IiwgZWRpdGVkRGF0YSk7CiAgICAgICAgfSBjYXRjaCAodmFyXzE4NikgewogICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3Igc2F2aW5nIGVkaXRlZCBkYXRhIHRvIGxvY2FsU3RvcmFnZToiLCB2YXJfMTg2KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzE4NygpIHsKICAgICAgICB0cnkgewogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oIml2YWNfZWRpdGVkX2VuZHBvaW50cyIsIEpTT04uc3RyaW5naWZ5KGVuZHBvaW50cykpOwogICAgICAgICAgY29uc29sZS5sb2coIlNhdmVkIGVkaXRlZCBlbmRwb2ludHMgdG8gbG9jYWxTdG9yYWdlOiIsIGVuZHBvaW50cyk7CiAgICAgICAgfSBjYXRjaCAodmFyXzE4OCkgewogICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3Igc2F2aW5nIGVkaXRlZCBlbmRwb2ludHMgdG8gbG9jYWxTdG9yYWdlOiIsIHZhcl8xODgpOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTg5KCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiaXZhY19lZGl0ZWRfY2FwdGNoYV90b2tlbl9uYW1lcyIsIEpTT04uc3RyaW5naWZ5KGNhcHRjaGFUb2tlbk5hbWVzKSk7CiAgICAgICAgICBjb25zb2xlLmxvZygiU2F2ZWQgZWRpdGVkIGNhcHRjaGEgdG9rZW4gbmFtZXMgdG8gbG9jYWxTdG9yYWdlOiIsIGNhcHRjaGFUb2tlbk5hbWVzKTsKICAgICAgICB9IGNhdGNoICh2YXJfMTkwKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBzYXZpbmcgZWRpdGVkIGNhcHRjaGEgdG9rZW4gbmFtZXMgdG8gbG9jYWxTdG9yYWdlOiIsIHZhcl8xOTApOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTkxKCkgewogICAgICAgIGNvbnNvbGUubG9nKCJSZXNldCBidXR0b24gY2xpY2tlZCAtIHJlc2V0dGluZyBhbGwgZWRpdGVkIGRhdGEiKTsKICAgICAgICBlZGl0ZWREYXRhID0gewogICAgICAgICAgYXBwOiBudWxsLAogICAgICAgICAgcGVyc29uYWw6IG51bGwsCiAgICAgICAgICBvdmVydmlldzogbnVsbCwKICAgICAgICAgIHNlbmQ6IG51bGwsCiAgICAgICAgICB2ZXJpZnk6IG51bGwsCiAgICAgICAgICBtb2JpbGU6IG51bGwsCiAgICAgICAgICBwYXNzd29yZDogbnVsbCwKICAgICAgICAgIG90cDogbnVsbCwKICAgICAgICAgIHBheW5vdzogbnVsbCwKICAgICAgICAgIHBheW5vd2J1dHRvbjogbnVsbAogICAgICAgIH07CiAgICAgICAgT2JqZWN0LmtleXMoZW5kcG9pbnRzLmxvZ2luKS5mb3JFYWNoKGVsZW1lbnRfMTM3ID0-IHsKICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTM4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVuZHBvaW50LWxvZ2luLSIgKyBlbGVtZW50XzEzNyk7CiAgICAgICAgICBpZiAoZWxlbWVudF8xMzgpIHsKICAgICAgICAgICAgZWxlbWVudF8xMzgudmFsdWUgPSBlbmRwb2ludHMubG9naW5bZWxlbWVudF8xMzddOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIE9iamVjdC5rZXlzKGVuZHBvaW50cy5wYXltZW50KS5mb3JFYWNoKGVsZW1lbnRfMTM5ID0-IHsKICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTQwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImVuZHBvaW50LXBheW1lbnQtIiArIGVsZW1lbnRfMTM5KTsKICAgICAgICAgIGlmIChlbGVtZW50XzE0MCkgewogICAgICAgICAgICBlbGVtZW50XzE0MC52YWx1ZSA9IGVuZHBvaW50cy5wYXltZW50W2VsZW1lbnRfMTM5XTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBPYmplY3Qua2V5cyhjYXB0Y2hhVG9rZW5OYW1lcykuZm9yRWFjaChlbGVtZW50XzE0MSA9PiB7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE0MiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYXB0Y2hhLXRva2VuLSIgKyBlbGVtZW50XzE0MSk7CiAgICAgICAgICBpZiAoZWxlbWVudF8xNDIpIHsKICAgICAgICAgICAgZWxlbWVudF8xNDIudmFsdWUgPSBjYXB0Y2hhVG9rZW5OYW1lc1tlbGVtZW50XzE0MV07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oIml2YWNfZWRpdGVkX2RhdGEiKTsKICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgiaXZhY19lZGl0ZWRfZW5kcG9pbnRzIik7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oIml2YWNfZWRpdGVkX2NhcHRjaGFfdG9rZW5fbmFtZXMiKTsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQWxsIGVkaXRlZCBkYXRhIHJlc2V0IiwgIiMwMEM4NTEiKTsKICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTkyKGxvb3BWYXJfMTkzLCB2YXJfMTk0LCB2YXJfMTk1KSB7CiAgICAgICAgbGV0IHRlbXBfMTM1ID0gZmFsc2U7CiAgICAgICAgZm9yIChjb25zdCB0b2tlbl8xMCBpbiBsb29wVmFyXzE5MykgewogICAgICAgICAgaWYgKHRva2VuXzEwLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoImNhcHRjaGEiKSAmJiBsb29wVmFyXzE5M1t0b2tlbl8xMF0gPT09ICIiKSB7CiAgICAgICAgICAgIGxvb3BWYXJfMTkzW3Rva2VuXzEwXSA9IHZhcl8xOTQ7CiAgICAgICAgICAgIHRlbXBfMTM1ID0gdHJ1ZTsKICAgICAgICAgICAgY29uc29sZS5sb2coIlNldCB0b2tlbiBmaWVsZCAnIiArIHRva2VuXzEwICsgIicgdG8gZnJlc2ggdG9rZW4iKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghdGVtcF8xMzUpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJObyBlbXB0eSBjYXB0Y2hhIGZpZWxkIGZvdW5kIGluIHJlcXVlc3QgYm9keSAtIGFkZGluZyBkZWZhdWx0IHRva2VuIGZpZWxkIik7CiAgICAgICAgICBsb29wVmFyXzE5M1t2YXJfMTk1XSA9IHZhcl8xOTQ7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl8xMjgoKSB7CiAgICAgICAgdmFyXzc0KCk7CiAgICAgICAgdmFyXzU2KCk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzE5Nihsb29wVmFyXzE5NykgewogICAgICAgIGZvciAoY29uc3QgW2xvb3BWYXJfMTk4LCBsb29wVmFyXzE5OV0gb2YgT2JqZWN0LmVudHJpZXMobG9vcFZhcl8xOTcpKSB7CiAgICAgICAgICBpZiAoIWxvb3BWYXJfMTk5KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGxvb3BWYXJfMTk4ICsgIiBpcyByZXF1aXJlZCIpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGxldCB0ZW1wXzEzNiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpdmFjX2NsaWVudF9pcCIpIHx8ICIiOwogICAgICBhc3luYyBmdW5jdGlvbiBhc3luY1Jlc3VsdF8xMjkoKSB7CiAgICAgICAgaWYgKHRlbXBfMTM2KSB7CiAgICAgICAgICByZXR1cm4gdGVtcF8xMzY7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBmb3JtRGF0YV8zID0gYXdhaXQgZmV0Y2goImh0dHBzOi8vYXBpLmlwaWZ5Lm9yZz9mb3JtYXQ9anNvbiIpOwogICAgICAgICAgaWYgKGZvcm1EYXRhXzMub2spIHsKICAgICAgICAgICAgY29uc3QgZGVsYXlfMzQgPSBhd2FpdCBmb3JtRGF0YV8zLmpzb24oKTsKICAgICAgICAgICAgaWYgKGRlbGF5XzM0Py5pcCkgewogICAgICAgICAgICAgIHRlbXBfMTM2ID0gZGVsYXlfMzQuaXA7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oIml2YWNfY2xpZW50X2lwIiwgdGVtcF8xMzYpOwogICAgICAgICAgICAgIHJldHVybiB0ZW1wXzEzNjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKHZhcl8yMDApIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gZmV0Y2ggY2xpZW50IElQOiIsIHZhcl8yMDApOwogICAgICAgIH0KICAgICAgICByZXR1cm4gIiI7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzIwMSh2YXJfMjAyLCB2YXJfMjAzID0gIiIpIHsKICAgICAgICBjb25zdCB0ZXh0XzM1ID0gW3Zhcl8yMDIsIHZhcl8yMDMgfHwgIiJdOwogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0ZXh0XzM1KTsKICAgICAgfQogICAgICBmdW5jdGlvbiBjcmVhdGVOZXh0QWN0aW9uSGVhZGVycyh2YXJfMjA0ID0ge30pIHsKICAgICAgICBjb25zdCB0ZW1wXzEzNyA9IHsKICAgICAgICAgIGFjY2VwdDogInRleHQveC1jb21wb25lbnQiLAogICAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJ0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgiCiAgICAgICAgfTsKICAgICAgICBpZiAodmFyXzIwNC5uZXh0QWN0aW9uKSB7CiAgICAgICAgICB0ZW1wXzEzN1sibmV4dC1hY3Rpb24iXSA9IHZhcl8yMDQubmV4dEFjdGlvbjsKICAgICAgICB9CiAgICAgICAgaWYgKHZhcl8yMDQucm91dGVyU3RhdGVUcmVlKSB7CiAgICAgICAgICB0ZW1wXzEzN1sibmV4dC1yb3V0ZXItc3RhdGUtdHJlZSJdID0gdmFyXzIwNC5yb3V0ZXJTdGF0ZVRyZWU7CiAgICAgICAgfQogICAgICAgIGlmICh2YXJfMjA0LnhBY3Rpb25SZXZhbGlkYXRlZCkgewogICAgICAgICAgdGVtcF8xMzdbIngtYWN0aW9uLXJldmFsaWRhdGVkIl0gPSB2YXJfMjA0LnhBY3Rpb25SZXZhbGlkYXRlZDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRlbXBfMTM3OwogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl8yMDUodmFyXzIwNikgewogICAgICAgIGlmICghdmFyXzIwNiB8fCB0eXBlb2YgdmFyXzIwNiAhPT0gIm9iamVjdCIpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGVvZiB2YXJfMjA2LnN0YXR1cyAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIHZhcl8yMDYuc3RhdHVzX2NvZGUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKHZhcl8yMDYucmVnaXN0ZXJlZCA9PT0gdHJ1ZSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmICh2YXJfMjA2LnN1Y2Nlc3MgPT09IHRydWUpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpZiAodmFyXzIwNi5kYXRhICYmIHR5cGVvZiB2YXJfMjA2LmRhdGEgPT09ICJvYmplY3QiKSB7CiAgICAgICAgICByZXR1cm4gdmFyXzIwNSh2YXJfMjA2LmRhdGEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzEzOCh2YXJfMjA3LCB7CiAgICAgICAgcHJlZmVyU3RhdHVzT2JqZWN0ID0gZmFsc2UsCiAgICAgICAgbGFiZWwgPSAicmVzcG9uc2UiCiAgICAgIH0gPSB7fSkgewogICAgICAgIGlmICghdmFyXzIwNykgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMTM4ID0gdmFyXzIwNy50cmltKCk7CiAgICAgICAgaWYgKCF0ZW1wXzEzOCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBjb3VudF8yMyA9IEpTT04ucGFyc2UodGVtcF8xMzgpOwogICAgICAgICAgaWYgKHByZWZlclN0YXR1c09iamVjdCAmJiBBcnJheS5pc0FycmF5KGNvdW50XzIzKSkgewogICAgICAgICAgICByZXR1cm4gY291bnRfMjMuZmluZCh2YXJfMjA1KSB8fCBjb3VudF8yM1tjb3VudF8yMy5sZW5ndGggLSAxXSB8fCBudWxsOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGNvdW50XzIzOwogICAgICAgIH0gY2F0Y2ggKHZhcl8yMDgpIHsKICAgICAgICAgIGNvbnN0IGNvdW50XzI0ID0gW107CiAgICAgICAgICBjb25zdCB0ZW1wXzEzOSA9IHRlbXBfMTM4LnJlcGxhY2UoL31ccyooPz1cZCs6KS9nLCAifVxuIikuc3BsaXQoL1xyP1xuLykubWFwKHBhcmFtXzE1ID0-IHBhcmFtXzE1LnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pOwogICAgICAgICAgZm9yIChjb25zdCB0ZW1wXzE0MCBvZiB0ZW1wXzEzOSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGNvbnN0IHRlbXBfMTQxID0gdGVtcF8xNDAuaW5kZXhPZigiOiIpOwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfMTQyID0gdGVtcF8xNDEgPiAtMSA_IHRlbXBfMTQwLnNsaWNlKHRlbXBfMTQxICsgMSkgOiB0ZW1wXzE0MDsKICAgICAgICAgICAgICBjb3VudF8yNC5wdXNoKEpTT04ucGFyc2UodGVtcF8xNDIpKTsKICAgICAgICAgICAgfSBjYXRjaCAoanNvbkRhdGFfMjA5KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBwYXJzZSAiICsgbGFiZWwgKyAiIGZyYWdtZW50OiIsIHRlbXBfMTQwLCBqc29uRGF0YV8yMDkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIWNvdW50XzI0Lmxlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChwcmVmZXJTdGF0dXNPYmplY3QpIHsKICAgICAgICAgICAgcmV0dXJuIGNvdW50XzI0LmZpbmQodmFyXzIwNSkgfHwgY291bnRfMjRbY291bnRfMjQubGVuZ3RoIC0gMV0gfHwgbnVsbDsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChjb3VudF8yNC5sZW5ndGggPT09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIGNvdW50XzI0WzBdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGNvdW50XzI0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMjEwKGFycmF5SXRlbV8yMTEpIHsKICAgICAgICBpZiAoIWFycmF5SXRlbV8yMTEpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyYXlJdGVtXzIxMSkpIHsKICAgICAgICAgIHJldHVybiBhcnJheUl0ZW1fMjExLnNvbWUocGFyYW1fMTYgPT4gdmFyXzIxMChwYXJhbV8xNikpOwogICAgICAgIH0KICAgICAgICBpZiAoYXJyYXlJdGVtXzIxMS5zdWNjZXNzID09PSB0cnVlKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGVvZiBhcnJheUl0ZW1fMjExLnN0YXR1cyA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIHJldHVybiBhcnJheUl0ZW1fMjExLnN0YXR1cy50b0xvd2VyQ2FzZSgpID09PSAic3VjY2VzcyI7CiAgICAgICAgfQogICAgICAgIGlmIChhcnJheUl0ZW1fMjExLnN0YXR1cyA9PT0gdHJ1ZSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlb2YgYXJyYXlJdGVtXzIxMS5zdGF0dXNfY29kZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIGNvbnN0IHRlbXBfMTQzID0gTnVtYmVyKGFycmF5SXRlbV8yMTEuc3RhdHVzX2NvZGUpOwogICAgICAgICAgaWYgKCFOdW1iZXIuaXNOYU4odGVtcF8xNDMpICYmIHRlbXBfMTQzID49IDIwMCAmJiB0ZW1wXzE0MyA8IDMwMCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGFycmF5SXRlbV8yMTEucmVnaXN0ZXJlZCA9PT0gdHJ1ZSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChhcnJheUl0ZW1fMjExLmRhdGEgJiYgdHlwZW9mIGFycmF5SXRlbV8yMTEuZGF0YSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIGlmICh2YXJfMjEwKGFycmF5SXRlbV8yMTEuZGF0YSkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChhcnJheUl0ZW1fMjExLm1lc3NhZ2UgJiYgdHlwZW9mIGFycmF5SXRlbV8yMTEubWVzc2FnZSA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIGNvbnN0IHRlbXBfMTQ0ID0gYXJyYXlJdGVtXzIxMS5tZXNzYWdlLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICBpZiAodGVtcF8xNDQuaW5jbHVkZXMoInN1Y2Nlc3MiKSB8fCB0ZW1wXzE0NC5pbmNsdWRlcygicmVnaXN0ZXJlZCIpKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gb3V0Y29tZV8xMzkobWVzc2FnZV8yMTIsIHZhcl8yMTMgPSAiIiwgdmFyXzIxNCA9ICIiKSB7CiAgICAgICAgaWYgKCF2YXJfMjE0KSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMTQ1ID0gdmFyXzIxNC50b0xvd2VyQ2FzZSgpLnRyaW0oKTsKICAgICAgICBjb25zdCB0ZW1wXzE0NiA9IC9zbG90XHMrZGF0ZVxzK2ZvdW5kL2kudGVzdCh0ZW1wXzE0NSk7CiAgICAgICAgaWYgKG1lc3NhZ2VfMjEyPy5tZXNzYWdlICYmIHR5cGVvZiBtZXNzYWdlXzIxMi5tZXNzYWdlID09PSAic3RyaW5nIikgewogICAgICAgICAgY29uc3QgdGVtcF8xNDcgPSBtZXNzYWdlXzIxMi5tZXNzYWdlLnRvTG93ZXJDYXNlKCkudHJpbSgpOwogICAgICAgICAgaWYgKHRlbXBfMTQ2KSB7CiAgICAgICAgICAgIGlmICgvc2xvdFxzK2RhdGVccytmb3VuZC9pLnRlc3QodGVtcF8xNDcpKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAodGVtcF8xNDcgPT09IHRlbXBfMTQ1KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAobWVzc2FnZV8yMTI_LmRhdGE_Lm1lc3NhZ2UgJiYgdHlwZW9mIG1lc3NhZ2VfMjEyLmRhdGEubWVzc2FnZSA9PT0gInN0cmluZyIpIHsKICAgICAgICAgIGNvbnN0IGRhdGFfMjAgPSBtZXNzYWdlXzIxMi5kYXRhLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS50cmltKCk7CiAgICAgICAgICBpZiAodGVtcF8xNDYpIHsKICAgICAgICAgICAgaWYgKC9zbG90XHMrZGF0ZVxzK2ZvdW5kL2kudGVzdChkYXRhXzIwKSkgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFfMjAgPT09IHRlbXBfMTQ1KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAodmFyXzIxMykgewogICAgICAgICAgY29uc3QgdGVtcF8xNDggPSB2YXJfMjEzLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICBpZiAodGVtcF8xNDYpIHsKICAgICAgICAgICAgaWYgKC9zbG90XHMrZGF0ZVxzK2ZvdW5kL2kudGVzdCh0ZW1wXzE0OCkpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgdGVtcF8xNDkgPSB0ZW1wXzE0NS5yZXBsYWNlKC9bLiorP14ke30oKXxbXF1cXF0vZywgIlxcJCYiKTsKICAgICAgICAgICAgY29uc3QgdGVtcF8xNTAgPSBuZXcgUmVnRXhwKCJcIm1lc3NhZ2VcIlxccyo6XFxzKlwiIiArIHRlbXBfMTQ5LnJlcGxhY2UoLyIvZywgIlxcXCIiKSArICJcIiIsICJpIik7CiAgICAgICAgICAgIGlmICh0ZW1wXzE1MC50ZXN0KHZhcl8yMTMpKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRlbXBfMTQ4LmluY2x1ZGVzKHRlbXBfMTQ1KSkgewogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBmdW5jdGlvbiBvdXRjb21lXzIxNSh2YXJfMjE2LCB2YXJfMjE3ID0gIiIsIGFycmF5SXRlbV8yMTggPSAiIikgewogICAgICAgIGlmIChhcnJheUl0ZW1fMjE4KSB7CiAgICAgICAgICBjb25zdCB0ZW1wXzE1MSA9IFtdOwogICAgICAgICAgY29uc3QgdGVtcF8xNTIgPSBhcnJheUl0ZW1fMjE4LnNwbGl0KC9ccj9cbi8pLm1hcChwYXJhbV8xNyA9PiBwYXJhbV8xNy50cmltKCkpLmZpbHRlcihCb29sZWFuKTsKICAgICAgICAgIGZvciAoY29uc3QgdGVtcF8xNTMgb2YgdGVtcF8xNTIpIHsKICAgICAgICAgICAgbGV0IHRlbXBfMTU0ID0gdGVtcF8xNTM7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMTU1ID0gdGVtcF8xNTMuaW5kZXhPZigiOiIpOwogICAgICAgICAgICBpZiAodGVtcF8xNTUgPiAtMSAmJiB0ZW1wXzE1M1t0ZW1wXzE1NSArIDFdID09PSAieyIpIHsKICAgICAgICAgICAgICB0ZW1wXzE1NCA9IHRlbXBfMTUzLnNsaWNlKHRlbXBfMTU1ICsgMSkudHJpbSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8xNTYgPSBKU09OLnBhcnNlKHRlbXBfMTU0KTsKICAgICAgICAgICAgICBpZiAodHlwZW9mIHRlbXBfMTU2ID09PSAib2JqZWN0IiAmJiB0ZW1wXzE1NiAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgdGVtcF8xNTEucHVzaCh0ZW1wXzE1Nik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoICh2YXJfMjE5KSB7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8xNTcgPSB0ZW1wXzE1NC5tYXRjaCgvIm1lc3NhZ2UiXHMqOlxzKiIoW14iXSspIi9pKTsKICAgICAgICAgICAgICBpZiAodGVtcF8xNTcgJiYgdGVtcF8xNTdbMV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiB0ZW1wXzE1N1sxXS50cmltKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBmb3IgKGNvbnN0IGRhdGFfMjEgb2YgdGVtcF8xNTEpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhXzIxLm1lc3NhZ2UgPT09ICJzdHJpbmciICYmIGRhdGFfMjEubWVzc2FnZS50cmltKCkpIHsKICAgICAgICAgICAgICByZXR1cm4gZGF0YV8yMS5tZXNzYWdlLnRyaW0oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZGF0YV8yMS5kYXRhICYmIHR5cGVvZiBkYXRhXzIxLmRhdGEgPT09ICJvYmplY3QiICYmIHR5cGVvZiBkYXRhXzIxLmRhdGEubWVzc2FnZSA9PT0gInN0cmluZyIgJiYgZGF0YV8yMS5kYXRhLm1lc3NhZ2UudHJpbSgpKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGRhdGFfMjEuZGF0YS5tZXNzYWdlLnRyaW0oKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc3QgdGVtcF8xNTggPSBhcnJheUl0ZW1fMjE4Lm1hdGNoKC8ibWVzc2FnZSJccyo6XHMqIihbXiJdKykiL2kpIHx8IGFycmF5SXRlbV8yMTgubWF0Y2goL21lc3NhZ2VbOlxzPV0rKFteXHMsfV0rKS9pKTsKICAgICAgICAgIGlmICh0ZW1wXzE1OCAmJiB0ZW1wXzE1OFsxXSkgewogICAgICAgICAgICByZXR1cm4gdGVtcF8xNThbMV0udHJpbSgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIXZhcl8yMTYpIHsKICAgICAgICAgIHJldHVybiB2YXJfMjE3OwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIHZhcl8yMTYgIT09ICJvYmplY3QiKSB7CiAgICAgICAgICByZXR1cm4gdmFyXzIxNzsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGVvZiB2YXJfMjE2Lm1lc3NhZ2UgPT09ICJzdHJpbmciICYmIHZhcl8yMTYubWVzc2FnZS50cmltKCkpIHsKICAgICAgICAgIHJldHVybiB2YXJfMjE2Lm1lc3NhZ2UudHJpbSgpOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIHZhcl8yMTYuZXJyb3IgPT09ICJzdHJpbmciICYmIHZhcl8yMTYuZXJyb3IudHJpbSgpKSB7CiAgICAgICAgICByZXR1cm4gdmFyXzIxNi5lcnJvci50cmltKCk7CiAgICAgICAgfQogICAgICAgIGlmICh2YXJfMjE2LmRhdGEgJiYgdHlwZW9mIHZhcl8yMTYuZGF0YSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIGlmICh0eXBlb2YgdmFyXzIxNi5kYXRhLm1lc3NhZ2UgPT09ICJzdHJpbmciICYmIHZhcl8yMTYuZGF0YS5tZXNzYWdlLnRyaW0oKSkgewogICAgICAgICAgICByZXR1cm4gdmFyXzIxNi5kYXRhLm1lc3NhZ2UudHJpbSgpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHR5cGVvZiB2YXJfMjE2LmRhdGEuZXJyb3IgPT09ICJzdHJpbmciICYmIHZhcl8yMTYuZGF0YS5lcnJvci50cmltKCkpIHsKICAgICAgICAgICAgcmV0dXJuIHZhcl8yMTYuZGF0YS5lcnJvci50cmltKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICh2YXJfMjE2LmVycm9yICYmIHR5cGVvZiB2YXJfMjE2LmVycm9yID09PSAib2JqZWN0IikgewogICAgICAgICAgaWYgKHR5cGVvZiB2YXJfMjE2LmVycm9yLm1lc3NhZ2UgPT09ICJzdHJpbmciICYmIHZhcl8yMTYuZXJyb3IubWVzc2FnZS50cmltKCkpIHsKICAgICAgICAgICAgcmV0dXJuIHZhcl8yMTYuZXJyb3IubWVzc2FnZS50cmltKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB2YXJfMjE3OwogICAgICB9CiAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJ1dHRvblN0YXR1cyhkYXRldGltZV8yMjAsIGRhdGV0aW1lXzIyMSwgZGF0ZXRpbWVfMjIyID0gIiIsIGRhdGV0aW1lXzIyMyA9ICIiLCBkYXRldGltZV8yMjQgPSAiIikgewogICAgICAgIGNvbnN0IHRlbXBfMTU5ID0gdmFyXzIxMChkYXRldGltZV8yMjApOwogICAgICAgIGlmICh0ZW1wXzE1OSkgewogICAgICAgICAgY29uc3QgdGVtcF8xNjAgPSBvdXRjb21lXzIxNShkYXRldGltZV8yMjAsIGRhdGV0aW1lXzIyMyB8fCBkYXRldGltZV8yMjEgKyAiIFN1Y2Nlc3MiLCBkYXRldGltZV8yMjIpOwogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlN1Y2Nlc3M6ICIgKyB0ZW1wXzE2MCwgIiMwMEZGMDAiKTsKICAgICAgICAgIGNvbnN0IHRlbXBfMTYxID0gewogICAgICAgICAgICBzdWNjZXNzOiB0cnVlLAogICAgICAgICAgICBtZXNzYWdlOiB0ZW1wXzE2MAogICAgICAgICAgfTsKICAgICAgICAgIHJldHVybiB0ZW1wXzE2MTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgdGVtcF8xNjIgPSBvdXRjb21lXzIxNShkYXRldGltZV8yMjAsIGRhdGV0aW1lXzIyNCB8fCBkYXRldGltZV8yMjEgKyAiIEZhaWxlZCIsIGRhdGV0aW1lXzIyMik7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiRmFpbGVkOiAiICsgdGVtcF8xNjIsICIjZmY0NDQ0Iik7CiAgICAgICAgICBjb25zdCB0ZW1wXzE2MyA9IHsKICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsCiAgICAgICAgICAgIG1lc3NhZ2U6IHRlbXBfMTYyCiAgICAgICAgICB9OwogICAgICAgICAgcmV0dXJuIHRlbXBfMTYzOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMjI1KHZhcl8yMjYsIHZhcl8yMjcpIHsKICAgICAgICByZXR1cm4gb3V0Y29tZV8yMTUodmFyXzIyNiwgdmFyXzIyNyk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzIyOCh0aW1lckNhbGxiYWNrXzIyOSwgdmFyXzIzMCA9IHZhcl83NSkgewogICAgICAgIHZhcl84OSh0aW1lckNhbGxiYWNrXzIyOSk7CiAgICAgICAgdmFyXzIzMCgpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzZXRCdXR0b25TdGF0ZSh0aW1lckNhbGxiYWNrXzIyOSksIDMwMDApOwogICAgICB9CiAgICAgIGZ1bmN0aW9uIHZhcl8yMzEodmFyXzIzMikge30KICAgICAgZXZlbnRIYW5kbGVyXzE3OCgibW9iaWxlLXZlcmlmeS1idG4iLCAiY2xpY2siLCBhc3luYyBmdW5jdGlvbiAocGFyYW1fMTgpIHsKICAgICAgICBjb25zdCB0ZW1wXzE2NCA9ICJtb2JpbGUiOwogICAgICAgIHZhcl8yMzEodGVtcF8xNjQpOwogICAgICAgIGNvbnN0IHRlbXBfMTY1ID0gdGhpcy5pZDsKICAgICAgICB2YXJfNTYoKTsKICAgICAgICBjb25zdCB0ZW1wXzE2NiA9IGVkaXRlZEVuZHBvaW50c1t0ZW1wXzE2NV07CiAgICAgICAgaWYgKHRlbXBfMTY2KSB7CiAgICAgICAgICBhc3luY1Jlc3VsdF8yMzModGVtcF8xNjYpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhc3luY1Jlc3VsdF8yMzMoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBhc3luYyBmdW5jdGlvbiBhc3luY1Jlc3VsdF8yMzMoYXN5bmNSZXN1bHRfMjM0ID0gbnVsbCkgewogICAgICAgIHZhcl8xMjgoKTsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiVHJ5IFRvIFZlcmlmeSBNb2JpbGUgTnVtYmVyIiwgIiNGRkQ3MDAiKTsKICAgICAgICBjb25zdCBlbGVtZW50XzE0MyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC1tb2JpbGUtbnVtYmVyIik7CiAgICAgICAgaWYgKCFlbGVtZW50XzE0MykgewogICAgICAgICAgY29uc29sZS5sb2coIk1vYmlsZSBudW1iZXIgaW5wdXQgbm90IGZvdW5kIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMTY3ID0gZWxlbWVudF8xNDMudmFsdWUudHJpbSgpOwogICAgICAgIGlmICghdGVtcF8xNjcpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJNb2JpbGUgbnVtYmVyIGlzIHJlcXVpcmVkIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICghY2FwdGNoYVByb3ZpZGVyQ29uZmlnLmxvZ2luLmVuYWJsZWQgfHwgIWNhcHRjaGFQcm92aWRlckNvbmZpZy5sb2dpbi50b2tlbikgewogICAgICAgICAgY29uc29sZS5sb2coIkNGIG5vdCBlbmFibGVkIG9yIHRva2VuIG5vdCBhdmFpbGFibGUgZm9yIExvZ2luIHRhYiIpOwogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkVuYWJsZSBDRiBpbiBMb2dpbiB0YWIiLCAiI2ZmOTgwMCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCB0ZW1wXzE2OCA9ICgpID0-IGFzeW5jUmVzdWx0XzIzMyhhc3luY1Jlc3VsdF8yMzQpOwogICAgICAgIHRyeSB7CiAgICAgICAgICBsZXQgaW5wdXRfMzsKICAgICAgICAgIGlmIChlZGl0ZWREYXRhLm1vYmlsZSkgewogICAgICAgICAgICBjb25zdCB0ZW1wXzE2OSA9IHsKICAgICAgICAgICAgICAuLi5lZGl0ZWREYXRhLm1vYmlsZQogICAgICAgICAgICB9OwogICAgICAgICAgICBpbnB1dF8zID0gdGVtcF8xNjk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCB0ZW1wXzE3MCA9IHsKICAgICAgICAgICAgICBtb2JpbGVfbm86IHRlbXBfMTY3CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlucHV0XzMgPSB0ZW1wXzE3MDsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTQ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhcHRjaGEtZW5hYmxlLWNoZWNrYm94Iik7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE0NSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYXRoLWNhcHRjaGEtaW5wdXQiKTsKICAgICAgICAgIGlmIChlbGVtZW50XzE0NCAmJiBlbGVtZW50XzE0NC5jaGVja2VkICYmIGVsZW1lbnRfMTQ1KSB7CiAgICAgICAgICAgIGNvbnN0IGlucHV0XzQgPSBlbGVtZW50XzE0NS52YWx1ZS50cmltKCk7CiAgICAgICAgICAgIGlmIChpbnB1dF80KSB7CiAgICAgICAgICAgICAgaW5wdXRfMy5hbnN3ZXIgPSBwYXJzZUludChpbnB1dF80KTsKICAgICAgICAgICAgICBpbnB1dF8zLnVzZXJfaW5wdXQgPSBpbnB1dF80OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB2YXJfMTkyKGlucHV0XzMsIGNhcHRjaGFQcm92aWRlckNvbmZpZy5sb2dpbi50b2tlbiwgImNhcHRjaGFfdG9rZW4iKTsKICAgICAgICAgIGNvbnN0IGRlbGF5XzM1ID0gYXdhaXQgYXN5bmNSZXN1bHRfMTI5KCk7CiAgICAgICAgICBjb25zdCB0ZW1wXzE3MSA9IHZhcl8yMDEoaW5wdXRfMywgZGVsYXlfMzUpOwogICAgICAgICAgY29uc29sZS5sb2coIk1vYmlsZSB2ZXJpZnkgcGF5bG9hZCBwcmVwYXJlZDoiLCB0ZW1wXzE3MSk7CiAgICAgICAgICBjb25zdCBkZWxheV8zNiA9IGFzeW5jUmVzdWx0XzIzNCB8fCBkYXRldGltZV8xMzAoIm1vYmlsZVZlcmlmeSIpOwogICAgICAgICAgY29uc3QgZXJyb3JfMTcgPSBhd2FpdCBmZXRjaChkZWxheV8zNiwgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIC4uLmNyZWF0ZU5leHRBY3Rpb25IZWFkZXJzKG5leHRBY3Rpb25Db25maWcubW9iaWxlVmVyaWZ5KQogICAgICAgICAgICB9LAogICAgICAgICAgICBjcmVkZW50aWFsczogImluY2x1ZGUiLAogICAgICAgICAgICByZWZlcnJlcjogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tLyIsCiAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiAic2FtZS1vcmlnaW4iLAogICAgICAgICAgICBib2R5OiB0ZW1wXzE3MQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIWVycm9yXzE3Lm9rKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyAiICsgZXJyb3JfMTcuc3RhdHVzKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1NlcXVlbmNlRXJyb3IoZXJyb3JfMTcuc3RhdHVzKTsKICAgICAgICAgICAgaWYgKGVycm9yXzE3LnN0YXR1cyA9PT0gNTAwIHx8IGVycm9yXzE3LnN0YXR1cyA9PT0gNTAyIHx8IGVycm9yXzE3LnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBidXR0b25fNSA9IGF3YWl0IGVycm9yXzE3LnRleHQoKTsKICAgICAgICAgICAgY29uc3QgYnV0dG9uXzYgPSB2YXJfMTM4KGJ1dHRvbl81LCB7CiAgICAgICAgICAgICAgcHJlZmVyU3RhdHVzT2JqZWN0OiB0cnVlLAogICAgICAgICAgICAgIGxhYmVsOiAiTW9iaWxlIFZlcmlmeSIKICAgICAgICAgICAgfSkgfHwge307CiAgICAgICAgICAgIHVwZGF0ZUJ1dHRvblN0YXR1cyhidXR0b25fNiwgIk1vYmlsZSBWZXJpZnkiLCBidXR0b25fNSwgIk1vYmlsZSBWZXJpZnkgU3VjY2VzcyIsICJNb2JpbGUgVmVyaWZ5IEZhaWxlZCIpOwogICAgICAgICAgICB2YXJfMjM1KCJtb2JpbGUtdmVyaWZ5LWJ0biIsICJNb2JpbGUgVmVyaWZ5Iik7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgibG9naW4tbW9iaWxlIiwgZXJyb3JfMTcuc3RhdHVzLCB0ZW1wXzE2OCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGJ1dHRvbl83ID0gYXdhaXQgZXJyb3JfMTcudGV4dCgpOwogICAgICAgICAgY29uc3QgZGF0YV8yMiA9IHZhcl8xMzgoYnV0dG9uXzcsIHsKICAgICAgICAgICAgcHJlZmVyU3RhdHVzT2JqZWN0OiB0cnVlLAogICAgICAgICAgICBsYWJlbDogIk1vYmlsZSBWZXJpZnkiCiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJNb2JpbGUgdmVyaWZpY2F0aW9uIHJhdyByZXNwb25zZToiLCBidXR0b25fNyk7CiAgICAgICAgICBjb25zb2xlLmxvZygiTW9iaWxlIHZlcmlmaWNhdGlvbiBwYXJzZWQgcGF5bG9hZDoiLCBkYXRhXzIyKTsKICAgICAgICAgIGlmICghZGF0YV8yMikgewogICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHBhcnNlIG1vYmlsZSB2ZXJpZnkgcmVzcG9uc2UgcGF5bG9hZCIpOwogICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXMobnVsbCwgIk1vYmlsZSBWZXJpZnkiLCBidXR0b25fNywgIk1vYmlsZSBWZXJpZnkgU3VjY2VzcyIsICJNb2JpbGUgVmVyaWZ5IEZhaWxlZCIpOwogICAgICAgICAgICB2YXJfMjM1KCJtb2JpbGUtdmVyaWZ5LWJ0biIsICJNb2JpbGUgVmVyaWZ5Iik7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgibG9naW4tbW9iaWxlIiwgbnVsbCwgdGVtcF8xNjgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodmFyXzIxMChkYXRhXzIyKSkgewogICAgICAgICAgICBpZiAoZGF0YV8yMj8uZGF0YSAmJiBkYXRhXzIyLmRhdGE_LnJlZ2lzdGVyZWQpIHsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidXNlcl9waG9uZSIsIGRhdGFfMjIuZGF0YS5tb2JpbGVfbm8pOwogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJhdXRoU3RlcCIsICIzIik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIk1vYmlsZSBWZXJpZnkgU3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKGRhdGFfMjIsICJNb2JpbGUgVmVyaWZ5IiwgYnV0dG9uXzcsICJNb2JpbGUgVmVyaWZ5IFN1Y2Nlc3MiLCAiTW9iaWxlIFZlcmlmeSBGYWlsZWQiKTsKICAgICAgICAgICAgICBhc3luY1Jlc3VsdF85Myhkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW9iaWxlLXZlcmlmeS1idG4iKSk7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNldEJ1dHRvblN0YXRlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb2JpbGUtdmVyaWZ5LWJ0biIpKSwgMzAwMCk7CiAgICAgICAgICAgICAgY2FwdGNoYVByb3ZpZGVyQ29uZmlnLmxvZ2luLmVuYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICBjYXB0Y2hhUHJvdmlkZXJDb25maWcubG9naW4udG9rZW4gPSAiIjsKICAgICAgICAgICAgICB2YXJfNTUoImxvZ2luIik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkNGIEJ1dHRvbiB0dXJuZWQgb2ZmIGFmdGVyIE1vYmlsZSBWZXJpZnkgc3VjY2VzcyIpOwogICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTQ2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhcHRjaGEtZW5hYmxlLWNoZWNrYm94Iik7CiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xNDcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWF0aC1jYXB0Y2hhLWlucHV0Iik7CiAgICAgICAgICAgICAgaWYgKGVsZW1lbnRfMTQ2ICYmIGVsZW1lbnRfMTQ2LmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgIGVsZW1lbnRfMTQ2LmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmIChlbGVtZW50XzE0NykgewogICAgICAgICAgICAgICAgICBlbGVtZW50XzE0Ny52YWx1ZSA9ICIiOwogICAgICAgICAgICAgICAgICBlbGVtZW50XzE0Ny5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQ2FwdGNoYSBjaGVja2JveCB1bmNoZWNrZWQgYWZ0ZXIgTW9iaWxlIFZlcmlmeSBzdWNjZXNzIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhcl82MigibW9iaWxlIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dGhTdGVwIiwgIjEiKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiTW9iaWxlIG51bWJlciBub3QgcmVnaXN0ZXJlZCIpOwogICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJNb2JpbGUgTm90IFJlZ2lzdGVyZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgICAgIHZhcl8yMzUoIm1vYmlsZS12ZXJpZnktYnRuIiwgIk1vYmlsZSBWZXJpZnkiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dGhTdGVwIiwgIjEiKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIk1vYmlsZSBWZXJpZnkgZmFpbGVkIik7CiAgICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgIHVwZGF0ZUJ1dHRvblN0YXR1cyhkYXRhXzIyLCAiTW9iaWxlIFZlcmlmeSIsIGJ1dHRvbl83LCAiTW9iaWxlIFZlcmlmeSBTdWNjZXNzIiwgIk1vYmlsZSBWZXJpZnkgRmFpbGVkIik7CiAgICAgICAgICAgIHZhcl8yMzUoIm1vYmlsZS12ZXJpZnktYnRuIiwgIk1vYmlsZSBWZXJpZnkiKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJsb2dpbi1tb2JpbGUiLCBudWxsLCB0ZW1wXzE2OCk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAobWVzc2FnZV8yMzYpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciB2ZXJpZnlpbmcgbW9iaWxlIG51bWJlcjoiLCBtZXNzYWdlXzIzNik7CiAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgY29uc3QgYnV0dG9uXzggPSB7CiAgICAgICAgICAgIGVycm9yOiBtZXNzYWdlXzIzNi5tZXNzYWdlCiAgICAgICAgICB9OwogICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKGJ1dHRvbl84LCAiTW9iaWxlIFZlcmlmeSIsICIiLCAiTW9iaWxlIFZlcmlmeSBTdWNjZXNzIiwgIk1vYmlsZSBWZXJpZnkgRmFpbGVkIik7CiAgICAgICAgICB2YXJfMjM1KCJtb2JpbGUtdmVyaWZ5LWJ0biIsICJNb2JpbGUgVmVyaWZ5Iik7CiAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoImxvZ2luLW1vYmlsZSIsIG51bGwsIHRlbXBfMTY4LCB7CiAgICAgICAgICAgIGlzTmV0d29ya0Vycm9yOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZXZlbnRIYW5kbGVyXzE3OCgiYXV0aGVudGljYXRlLWJ0biIsICJjbGljayIsIGFzeW5jIGZ1bmN0aW9uIChwYXJhbV8xOSkgewogICAgICAgIGNvbnN0IHRlbXBfMTcyID0gInBhc3N3b3JkIjsKICAgICAgICB2YXJfMjMxKHRlbXBfMTcyKTsKICAgICAgICBjb25zdCB0ZW1wXzE3MyA9IHRoaXMuaWQ7CiAgICAgICAgdmFyXzU2KCk7CiAgICAgICAgY29uc3QgdGVtcF8xNzQgPSBlZGl0ZWRFbmRwb2ludHNbdGVtcF8xNzNdOwogICAgICAgIGlmICh0ZW1wXzE3NCkgewogICAgICAgICAgYXN5bmNSZXN1bHRfMjM3KHRlbXBfMTc0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXN5bmNSZXN1bHRfMjM3KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgYXN5bmMgZnVuY3Rpb24gYXN5bmNSZXN1bHRfMjM3KGFzeW5jUmVzdWx0XzIzOCA9IG51bGwpIHsKICAgICAgICB2YXJfMTI4KCk7CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlRyeSBUbyBBdXRoZW50aWNhdGUiLCAiI0ZGRDcwMCIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTQ4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm10LW1vYmlsZS1udW1iZXIiKTsKICAgICAgICBjb25zdCBlbGVtZW50XzE0OSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtdC1wYXNzd29yZCIpOwogICAgICAgIGlmICghZWxlbWVudF8xNDgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJNb2JpbGUgbnVtYmVyIGlucHV0IG5vdCBmb3VuZCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoIWVsZW1lbnRfMTQ5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiUGFzc3dvcmQgaW5wdXQgbm90IGZvdW5kIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMTc1ID0gZWxlbWVudF8xNDgudmFsdWUudHJpbSgpOwogICAgICAgIGNvbnN0IHRlbXBfMTc2ID0gZWxlbWVudF8xNDkudmFsdWU7CiAgICAgICAgaWYgKCF0ZW1wXzE3NSkgewogICAgICAgICAgY29uc29sZS5sb2coIk1vYmlsZSBudW1iZXIgaXMgcmVxdWlyZWQiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCF0ZW1wXzE3NikgewogICAgICAgICAgY29uc29sZS5sb2coIlBhc3N3b3JkIGlzIHJlcXVpcmVkIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMTc3ID0gKCkgPT4gYXN5bmNSZXN1bHRfMjM3KGFzeW5jUmVzdWx0XzIzOCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGxldCBpbnB1dF81OwogICAgICAgICAgaWYgKGVkaXRlZERhdGEucGFzc3dvcmQpIHsKICAgICAgICAgICAgY29uc3QgdGVtcF8xNzggPSB7CiAgICAgICAgICAgICAgLi4uZWRpdGVkRGF0YS5wYXNzd29yZAogICAgICAgICAgICB9OwogICAgICAgICAgICBpbnB1dF81ID0gdGVtcF8xNzg7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCB0ZW1wXzE3OSA9IHsKICAgICAgICAgICAgICBtb2JpbGVfbm86IHRlbXBfMTc1LAogICAgICAgICAgICAgIHBhc3N3b3JkOiB0ZW1wXzE3NgogICAgICAgICAgICB9OwogICAgICAgICAgICBpbnB1dF81ID0gdGVtcF8xNzk7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE1MCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYXB0Y2hhLWVuYWJsZS1jaGVja2JveCIpOwogICAgICAgICAgY29uc3QgZWxlbWVudF8xNTEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWF0aC1jYXB0Y2hhLWlucHV0Iik7CiAgICAgICAgICBpZiAoZWxlbWVudF8xNTAgJiYgZWxlbWVudF8xNTAuY2hlY2tlZCAmJiBlbGVtZW50XzE1MSkgewogICAgICAgICAgICBjb25zdCBpbnB1dF82ID0gZWxlbWVudF8xNTEudmFsdWUudHJpbSgpOwogICAgICAgICAgICBpZiAoaW5wdXRfNikgewogICAgICAgICAgICAgIGlucHV0XzUuYW5zd2VyID0gcGFyc2VJbnQoaW5wdXRfNik7CiAgICAgICAgICAgICAgaW5wdXRfNS51c2VyX2lucHV0ID0gaW5wdXRfNjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc3QgZGVsYXlfMzcgPSBhd2FpdCBhc3luY1Jlc3VsdF8xMjkoKTsKICAgICAgICAgIGNvbnN0IHRlbXBfMTgwID0gdmFyXzIwMShpbnB1dF81LCBkZWxheV8zNyk7CiAgICAgICAgICBjb25zb2xlLmxvZygiQXV0aGVudGljYXRlIHBheWxvYWQgcHJlcGFyZWQ6IiwgdGVtcF8xODApOwogICAgICAgICAgY29uc3QgZGVsYXlfMzggPSBhc3luY1Jlc3VsdF8yMzggfHwgZGF0ZXRpbWVfMTMwKCJsb2dpbiIpOwogICAgICAgICAgY29uc3QgZXJyb3JfMTggPSBhd2FpdCBmZXRjaChkZWxheV8zOCwgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIC4uLmNyZWF0ZU5leHRBY3Rpb25IZWFkZXJzKG5leHRBY3Rpb25Db25maWcuYXV0aGVudGljYXRlKQogICAgICAgICAgICB9LAogICAgICAgICAgICBjcmVkZW50aWFsczogImluY2x1ZGUiLAogICAgICAgICAgICByZWZlcnJlcjogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tLyIsCiAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiAic2FtZS1vcmlnaW4iLAogICAgICAgICAgICBib2R5OiB0ZW1wXzE4MAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIWVycm9yXzE4Lm9rKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyAiICsgZXJyb3JfMTguc3RhdHVzKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1NlcXVlbmNlRXJyb3IoZXJyb3JfMTguc3RhdHVzKTsKICAgICAgICAgICAgaWYgKGVycm9yXzE4LnN0YXR1cyA9PT0gNTAwIHx8IGVycm9yXzE4LnN0YXR1cyA9PT0gNTAyIHx8IGVycm9yXzE4LnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBidXR0b25fOSA9IGF3YWl0IGVycm9yXzE4LnRleHQoKTsKICAgICAgICAgICAgY29uc3QgYnV0dG9uXzEwID0gdmFyXzEzOChidXR0b25fOSwgewogICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICBsYWJlbDogIkF1dGhlbnRpY2F0ZSIKICAgICAgICAgICAgfSkgfHwge307CiAgICAgICAgICAgIHVwZGF0ZUJ1dHRvblN0YXR1cyhidXR0b25fMTAsICJBdXRoZW50aWNhdGUiLCBidXR0b25fOSwgIkF1dGhlbnRpY2F0ZSBTdWNjZXNzIiwgIkF1dGhlbnRpY2F0ZSBGYWlsZWQiKTsKICAgICAgICAgICAgdmFyXzIzNSgiYXV0aGVudGljYXRlLWJ0biIsICJBdXRoZW50aWNhdGUiKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJsb2dpbi1hdXRoZW50aWNhdGUiLCBlcnJvcl8xOC5zdGF0dXMsIHRlbXBfMTc3KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgYnV0dG9uXzExID0gYXdhaXQgZXJyb3JfMTgudGV4dCgpOwogICAgICAgICAgY29uc3QgZGF0YV8yMyA9IHZhcl8xMzgoYnV0dG9uXzExLCB7CiAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgbGFiZWw6ICJBdXRoZW50aWNhdGUiCiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJBdXRoZW50aWNhdGUgcmF3IHJlc3BvbnNlOiIsIGJ1dHRvbl8xMSk7CiAgICAgICAgICBjb25zb2xlLmxvZygiQXV0aGVudGljYXRlIHBhcnNlZCBwYXlsb2FkOiIsIGRhdGFfMjMpOwogICAgICAgICAgaWYgKCFkYXRhXzIzKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gcGFyc2UgYXV0aGVudGljYXRlIHJlc3BvbnNlIHBheWxvYWQiKTsKICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKG51bGwsICJBdXRoZW50aWNhdGUiLCBidXR0b25fMTEsICJBdXRoZW50aWNhdGUgU3VjY2VzcyIsICJBdXRoZW50aWNhdGUgRmFpbGVkIik7CiAgICAgICAgICAgIHZhcl8yMzUoImF1dGhlbnRpY2F0ZS1idG4iLCAiQXV0aGVudGljYXRlIik7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgibG9naW4tYXV0aGVudGljYXRlIiwgbnVsbCwgdGVtcF8xNzcpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodmFyXzIxMChkYXRhXzIzKSkgewogICAgICAgICAgICBpZiAoZGF0YV8yMz8uZGF0YSAmJiBkYXRhXzIzLmRhdGE_LmVtYWlsX2NvbmZpcm1lZCkgewogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ1c2VyX2VtYWlsIiwgZGF0YV8yMy5kYXRhLmVtYWlsKTsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidXNlcl9wd2QiLCB0ZW1wXzE3Nik7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dGhTdGVwIiwgIjEwMCIpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJBdXRoZW50aWNhdGUgU3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKGRhdGFfMjMsICJBdXRoZW50aWNhdGUiLCBidXR0b25fMTEsICJBdXRoZW50aWNhdGUgU3VjY2VzcyIsICJBdXRoZW50aWNhdGUgRmFpbGVkIik7CiAgICAgICAgICAgICAgYXN5bmNSZXN1bHRfOTMoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImF1dGhlbnRpY2F0ZS1idG4iKSk7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNldEJ1dHRvblN0YXRlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhdXRoZW50aWNhdGUtYnRuIikpLCAzMDAwKTsKICAgICAgICAgICAgICBkYXRldGltZV8xMDgoImxvZ2luLW90cC10aW1lci1kaXNwbGF5IiwgNSk7CiAgICAgICAgICAgICAgdmFyXzYyKCJwYXNzd29yZCIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJhdXRoU3RlcCIsICIzIik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBhdXRoZW50aWNhdGUiKTsKICAgICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXMoZGF0YV8yMywgIkF1dGhlbnRpY2F0ZSIsIGJ1dHRvbl8xMSwgIkF1dGhlbnRpY2F0ZSBTdWNjZXNzIiwgIkZhaWxlZCB0byBBdXRoZW50aWNhdGUiKTsKICAgICAgICAgICAgICB2YXJfMjM1KCJhdXRoZW50aWNhdGUtYnRuIiwgIkF1dGhlbnRpY2F0ZSIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYXV0aFN0ZXAiLCAiMyIpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiQXV0aGVudGljYXRlIGZhaWxlZCIpOwogICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXMoZGF0YV8yMywgIkF1dGhlbnRpY2F0ZSIsIGJ1dHRvbl8xMSwgIkF1dGhlbnRpY2F0ZSBTdWNjZXNzIiwgIkF1dGhlbnRpY2F0ZSBGYWlsZWQiKTsKICAgICAgICAgICAgdmFyXzIzNSgiYXV0aGVudGljYXRlLWJ0biIsICJBdXRoZW50aWNhdGUiKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJsb2dpbi1hdXRoZW50aWNhdGUiLCBudWxsLCB0ZW1wXzE3Nyk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoYXN5bmNSZXN1bHRfMjM5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgYXV0aGVudGljYXRpbmc6IiwgYXN5bmNSZXN1bHRfMjM5KTsKICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICBjb25zdCBidXR0b25fMTIgPSB7CiAgICAgICAgICAgIGVycm9yOiBhc3luY1Jlc3VsdF8yMzkubWVzc2FnZQogICAgICAgICAgfTsKICAgICAgICAgIHVwZGF0ZUJ1dHRvblN0YXR1cyhidXR0b25fMTIsICJBdXRoZW50aWNhdGUiLCAiIiwgIkF1dGhlbnRpY2F0ZSBTdWNjZXNzIiwgIkF1dGhlbnRpY2F0ZSBGYWlsZWQiKTsKICAgICAgICAgIHZhcl8yMzUoImF1dGhlbnRpY2F0ZS1idG4iLCAiQXV0aGVudGljYXRlIik7CiAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoImxvZ2luLWF1dGhlbnRpY2F0ZSIsIG51bGwsIHRlbXBfMTc3LCB7CiAgICAgICAgICAgIGlzTmV0d29ya0Vycm9yOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZXZlbnRIYW5kbGVyXzE3OCgic3VibWl0LW90cC1idG4iLCAiY2xpY2siLCBhc3luYyBmdW5jdGlvbiAoZXZlbnRfNykgewogICAgICAgIGlmIChldmVudF83KSB7CiAgICAgICAgICBldmVudF83LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBldmVudF83LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIH0KICAgICAgICBjb25zdCB0ZW1wXzE4MSA9ICJvdHAiOwogICAgICAgIHZhcl8yMzEodGVtcF8xODEpOwogICAgICAgIGNvbnN0IHRlbXBfMTgyID0gdGhpcy5pZDsKICAgICAgICB2YXJfNTYoKTsKICAgICAgICBjb25zdCB0ZW1wXzE4MyA9IGVkaXRlZEVuZHBvaW50c1t0ZW1wXzE4Ml07CiAgICAgICAgaWYgKHRlbXBfMTgzKSB7CiAgICAgICAgICBzdWJtaXRMb2dpbk90cCh0ZW1wXzE4Myk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN1Ym1pdExvZ2luT3RwKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgbGV0IGRlbGF5XzggPSBmYWxzZTsKICAgICAgYXN5bmMgZnVuY3Rpb24gc3VibWl0TG9naW5PdHAoYXN5bmNSZXN1bHRfMjQwID0gbnVsbCkgewogICAgICAgIGlmIChkZWxheV84KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiU3VibWl0IE9UUCBhbHJlYWR5IHByb2Nlc3NpbmcsIGlnbm9yaW5nIGR1cGxpY2F0ZSBjYWxsIik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGRlbGF5XzggPSB0cnVlOwogICAgICAgIHRyeSB7CiAgICAgICAgICB2YXJfMTI4KCk7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiVHJ5IFN1Y2Nlc3NmdWxseSBMb2dpbiIsICIjRkZENzAwIik7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE1MiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdWJtaXQtb3RwLWJ0biIpOwogICAgICAgICAgY29uc3QgZWxlbWVudF8xNTMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXQtbW9iaWxlLW51bWJlciIpOwogICAgICAgICAgY29uc3QgZWxlbWVudF8xNTQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibXQtcGFzc3dvcmQiKTsKICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTU1ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm10LW90cCIpOwogICAgICAgICAgaWYgKCF2YXJfMTk2KHsKICAgICAgICAgICAgIk1vYmlsZSBudW1iZXIiOiBlbGVtZW50XzE1Mz8udmFsdWUudHJpbSgpLAogICAgICAgICAgICBQYXNzd29yZDogZWxlbWVudF8xNTQ_LnZhbHVlLAogICAgICAgICAgICBPVFA6IGVsZW1lbnRfMTU1Py52YWx1ZS50cmltKCkKICAgICAgICAgIH0pKSB7CiAgICAgICAgICAgIGRlbGF5XzggPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgdGVtcF8xODQgPSBlbGVtZW50XzE1My52YWx1ZS50cmltKCk7CiAgICAgICAgICBjb25zdCB0ZW1wXzE4NSA9IGVsZW1lbnRfMTU0LnZhbHVlOwogICAgICAgICAgY29uc3QgY291bnRfMjUgPSBlbGVtZW50XzE1NS52YWx1ZS50cmltKCk7CiAgICAgICAgICBpZiAoY291bnRfMjUubGVuZ3RoICE9PSA2KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJJbnZhbGlkIE9UUCBsZW5ndGghIEV4cGVjdGVkIDYgY2hhcmFjdGVycyIpOwogICAgICAgICAgICBkZWxheV84ID0gZmFsc2U7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHRlbXBfMTg2ID0gKCkgPT4gc3VibWl0TG9naW5PdHAoYXN5bmNSZXN1bHRfMjQwKTsKICAgICAgICAgIGxldCB0ZW1wXzE4NzsKICAgICAgICAgIGlmIChlZGl0ZWREYXRhLm90cCkgewogICAgICAgICAgICBjb25zdCB0ZW1wXzE4OCA9IHsKICAgICAgICAgICAgICAuLi5lZGl0ZWREYXRhLm90cAogICAgICAgICAgICB9OwogICAgICAgICAgICB0ZW1wXzE4NyA9IHRlbXBfMTg4OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgdGVtcF8xODkgPSB7CiAgICAgICAgICAgICAgbW9iaWxlX25vOiB0ZW1wXzE4NCwKICAgICAgICAgICAgICBwYXNzd29yZDogdGVtcF8xODUsCiAgICAgICAgICAgICAgb3RwOiBjb3VudF8yNQogICAgICAgICAgICB9OwogICAgICAgICAgICB0ZW1wXzE4NyA9IHRlbXBfMTg5OwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgZGVsYXlfMzkgPSBhd2FpdCBhc3luY1Jlc3VsdF8xMjkoKTsKICAgICAgICAgIGNvbnN0IHRlbXBfMTkwID0gdmFyXzIwMSh0ZW1wXzE4NywgZGVsYXlfMzkpOwogICAgICAgICAgY29uc29sZS5sb2coIlN1Ym1pdCBPVFAgcGF5bG9hZCBwcmVwYXJlZDoiLCB0ZW1wXzE5MCk7CiAgICAgICAgICBjb25zdCBkZWxheV80MCA9IGFzeW5jUmVzdWx0XzI0MCB8fCBkYXRldGltZV8xMzAoImxvZ2luT3RwIik7CiAgICAgICAgICBjb25zdCBoZWFkZXJzXzcgPSBhd2FpdCBmZXRjaChkZWxheV80MCwgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIC4uLmNyZWF0ZU5leHRBY3Rpb25IZWFkZXJzKG5leHRBY3Rpb25Db25maWcuc3VibWl0T3RwKQogICAgICAgICAgICB9LAogICAgICAgICAgICBjcmVkZW50aWFsczogImluY2x1ZGUiLAogICAgICAgICAgICByZWZlcnJlcjogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tLyIsCiAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiAic2FtZS1vcmlnaW4iLAogICAgICAgICAgICByZWRpcmVjdDogIm1hbnVhbCIsCiAgICAgICAgICAgIGJvZHk6IHRlbXBfMTkwCiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChoZWFkZXJzXzcuc3RhdHVzID09PSAzMDcgfHwgaGVhZGVyc183LnN0YXR1cyA9PT0gMzA4KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJTdWJtaXQgT1RQIHJlZGlyZWN0IHJlc3BvbnNlICgiICsgaGVhZGVyc183LnN0YXR1cyArICIpIC0gd2lsbCBwYXJzZSByZXNwb25zZSBib2R5IHRvIGNoZWNrIGZvciBcIkxvZ2luIFN1Y2Nlc3NmdWxcIiBtZXNzYWdlIik7CiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnNfOCA9IGhlYWRlcnNfNy5oZWFkZXJzLmdldCgiTG9jYXRpb24iKTsKICAgICAgICAgICAgaWYgKGhlYWRlcnNfOCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZWRpcmVjdCBsb2NhdGlvbjogIiArIGhlYWRlcnNfOCArICIgKG5vdCBmb2xsb3dpbmcgdG8gcHJldmVudCBkdXBsaWNhdGUgcmVxdWVzdCkiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKCFoZWFkZXJzXzcgfHwgaGVhZGVyc183LnN0YXR1cyA9PT0gMCB8fCBoZWFkZXJzXzcuc3RhdHVzID09PSBudWxsKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXF1ZXN0IGZhaWxlZCAtIG5ldHdvcmsgZXJyb3Igb3IgaW52YWxpZCByZXNwb25zZSIpOwogICAgICAgICAgICBkZWxheV84ID0gZmFsc2U7CiAgICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgIHVwZGF0ZUJ1dHRvblN0YXR1cyh7CiAgICAgICAgICAgICAgZXJyb3I6ICJOZXR3b3JrIGVycm9yIG9yIGludmFsaWQgcmVzcG9uc2UiCiAgICAgICAgICAgIH0sICJTdWJtaXQgT1RQIiwgIiIsICJTdWJtaXQgT1RQIFN1Y2Nlc3MiLCAiU3VibWl0IE9UUCBGYWlsZWQiKTsKICAgICAgICAgICAgcmVzZXRCdXR0b25TdGF0ZShlbGVtZW50XzE1Mik7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgibG9naW4tc3VibWl0LW90cCIsIG51bGwsIHRlbXBfMTg2LCB7CiAgICAgICAgICAgICAgaXNOZXR3b3JrRXJyb3I6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChoZWFkZXJzXzcuc3RhdHVzICE9PSAyMDAgJiYgaGVhZGVyc183LnN0YXR1cyAhPT0gMzA3ICYmIGhlYWRlcnNfNy5zdGF0dXMgIT09IDMwOCkgewogICAgICAgICAgICBoYW5kbGVBdXRvU2VxdWVuY2VFcnJvcihoZWFkZXJzXzcuc3RhdHVzKTsKICAgICAgICAgICAgaWYgKGhlYWRlcnNfNy5zdGF0dXMgPT09IDUwMCB8fCBoZWFkZXJzXzcuc3RhdHVzID09PSA1MDIgfHwgaGVhZGVyc183LnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc3QgcmVzdWx0XzggPSBhd2FpdCBoZWFkZXJzXzcudGV4dCgpOwogICAgICAgICAgY29uc29sZS5sb2coIlN1Ym1pdCBPVFAgcmF3IHJlc3BvbnNlOiIsIHJlc3VsdF84KTsKICAgICAgICAgIGxldCByZXN1bHRfOSA9IG51bGw7CiAgICAgICAgICBsZXQgdGVtcF8xOTEgPSB7fTsKICAgICAgICAgIGlmIChyZXN1bHRfOC5pbmNsdWRlcygiZDoiKSAmJiByZXN1bHRfOC5pbmNsdWRlcygiZGF0YTppbWFnZSIpKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJEZXRlY3RlZCBzcGVjaWFsIHJlc3BvbnNlIGZvcm1hdCB3aXRoIGltYWdlIGRhdGEiKTsKICAgICAgICAgICAgY29uc3QgdGVtcF8xOTIgPSByZXN1bHRfOC5tYXRjaCgvXHtbXHNcU10qP1x9Lyk7CiAgICAgICAgICAgIGlmICh0ZW1wXzE5MikgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCB0ZW1wXzE5MyA9IEpTT04ucGFyc2UodGVtcF8xOTJbMF0pOwogICAgICAgICAgICAgICAgcmVzdWx0XzkgPSB0ZW1wXzE5MzsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFeHRyYWN0ZWQgSlNPTiBmcm9tIHJlc3BvbnNlIHdpdGggaW1hZ2U6IiwgcmVzdWx0XzkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGpzb25EYXRhXzI0MSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBwYXJzZSBKU09OIGZyb20gaW1hZ2UgcmVzcG9uc2U6IiwganNvbkRhdGFfMjQxKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgdGVtcF8xOTQgPSByZXN1bHRfOC5tYXRjaCgvXmQ6KFteLF0rKS8pOwogICAgICAgICAgICBpZiAodGVtcF8xOTQpIHsKICAgICAgICAgICAgICB0ZW1wXzE5MS5wcmVmaXggPSB0ZW1wXzE5NFsxXTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXh0cmFjdGVkIHByZWZpeDoiLCB0ZW1wXzE5MS5wcmVmaXgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIXJlc3VsdF85KSB7CiAgICAgICAgICAgIGNvbnN0IGNvdW50XzI2ID0gcmVzdWx0Xzguc3BsaXQoL1xyP1xuLykubWFwKHBhcmFtXzIwID0-IHBhcmFtXzIwLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pOwogICAgICAgICAgICBpZiAoY291bnRfMjYubGVuZ3RoID49IDEpIHsKICAgICAgICAgICAgICBjb25zdCB0ZW1wXzE5NSA9IGNvdW50XzI2WzBdLnRyaW0oKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiU3VibWl0IE9UUCBsaW5lIDE6IiwgdGVtcF8xOTUpOwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgdGVtcF8xOTYgPSB0ZW1wXzE5NTsKICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfMTk3ID0gdGVtcF8xOTUubWF0Y2goL15cZCtccyo6XHMqKC4rKS8pOwogICAgICAgICAgICAgICAgaWYgKHRlbXBfMTk3ICYmIHRlbXBfMTk3WzFdKSB7CiAgICAgICAgICAgICAgICAgIHRlbXBfMTk2ID0gdGVtcF8xOTdbMV0udHJpbSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcF8xOTggPSB0ZW1wXzE5NS5pbmRleE9mKCI6Iik7CiAgICAgICAgICAgICAgICAgIGlmICh0ZW1wXzE5OCA-IC0xICYmIHRlbXBfMTk1W3RlbXBfMTk4ICsgMV0gPT09ICJ7IikgewogICAgICAgICAgICAgICAgICAgIHRlbXBfMTk2ID0gdGVtcF8xOTUuc2xpY2UodGVtcF8xOTggKyAxKS50cmltKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfMTk5ID0gSlNPTi5wYXJzZSh0ZW1wXzE5Nik7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRlbXBfMTk5ID09PSAib2JqZWN0IiAmJiB0ZW1wXzE5OSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICBpZiAodGVtcF8xOTkubWVzc2FnZSB8fCB0ZW1wXzE5OS5zdGF0dXMgfHwgdGVtcF8xOTkuc3RhdHVzX2NvZGUpIHsKICAgICAgICAgICAgICAgICAgICByZXN1bHRfOSA9IHRlbXBfMTk5OwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJTdWJtaXQgT1RQIHBhcnNlZCBsaW5lIDE6IiwgcmVzdWx0XzkpOwogICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wXzE5OS5tZXNzYWdlID09PSAiTG9naW4gU3VjY2Vzc2Z1bCIpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgXCJMb2dpbiBTdWNjZXNzZnVsXCIgbWVzc2FnZSBmb3VuZCBpbiBsaW5lIDEiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChqc29uRGF0YV8yNDIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGYWlsZWQgdG8gcGFyc2UgbGluZSAxOiIsIGpzb25EYXRhXzI0Mik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghcmVzdWx0XzkgJiYgY291bnRfMjYubGVuZ3RoID49IDEzKSB7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8yMDAgPSBjb3VudF8yNlsxMl0udHJpbSgpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJTdWJtaXQgT1RQIGxpbmUgMTM6IiwgdGVtcF8yMDApOwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgdGVtcF8yMDEgPSB0ZW1wXzIwMDsKICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfMjAyID0gdGVtcF8yMDAubWF0Y2goL15cZCtccyo6XHMqKC4rKS8pOwogICAgICAgICAgICAgICAgaWYgKHRlbXBfMjAyICYmIHRlbXBfMjAyWzFdKSB7CiAgICAgICAgICAgICAgICAgIHRlbXBfMjAxID0gdGVtcF8yMDJbMV0udHJpbSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcF8yMDMgPSB0ZW1wXzIwMC5pbmRleE9mKCI6Iik7CiAgICAgICAgICAgICAgICAgIGlmICh0ZW1wXzIwMyA-IC0xICYmIHRlbXBfMjAwW3RlbXBfMjAzICsgMV0gPT09ICJ7IikgewogICAgICAgICAgICAgICAgICAgIHRlbXBfMjAxID0gdGVtcF8yMDAuc2xpY2UodGVtcF8yMDMgKyAxKS50cmltKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlc3VsdF85ID0gSlNPTi5wYXJzZSh0ZW1wXzIwMSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiU3VibWl0IE9UUCBwYXJzZWQgbGluZSAxMzoiLCByZXN1bHRfOSk7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0XzkgJiYgcmVzdWx0XzkubWVzc2FnZSA9PT0gIkxvZ2luIFN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgXCJMb2dpbiBTdWNjZXNzZnVsXCIgbWVzc2FnZSBmb3VuZCBpbiBsaW5lIDEzIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBjYXRjaCAoanNvbkRhdGFfMjQzKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIHBhcnNlIGxpbmUgMTM6IiwganNvbkRhdGFfMjQzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFyZXN1bHRfOSAmJiBjb3VudF8yNi5sZW5ndGggPj0gMTIpIHsKICAgICAgICAgICAgICBjb25zdCB0ZW1wXzIwNCA9IGNvdW50XzI2WzExXS50cmltKCk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIlN1Ym1pdCBPVFAgbGluZSAxMjoiLCB0ZW1wXzIwNCk7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCB0ZW1wXzIwNSA9IHRlbXBfMjA0OwogICAgICAgICAgICAgICAgY29uc3QgdGVtcF8yMDYgPSB0ZW1wXzIwNC5tYXRjaCgvXlxkK1xzKjpccyooLispLyk7CiAgICAgICAgICAgICAgICBpZiAodGVtcF8yMDYgJiYgdGVtcF8yMDZbMV0pIHsKICAgICAgICAgICAgICAgICAgdGVtcF8yMDUgPSB0ZW1wXzIwNlsxXS50cmltKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wXzIwNyA9IHRlbXBfMjA0LmluZGV4T2YoIjoiKTsKICAgICAgICAgICAgICAgICAgaWYgKHRlbXBfMjA3ID4gLTEgJiYgdGVtcF8yMDRbdGVtcF8yMDcgKyAxXSA9PT0gInsiKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcF8yMDUgPSB0ZW1wXzIwNC5zbGljZSh0ZW1wXzIwNyArIDEpLnRyaW0oKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgdGVtcF8yMDggPSBKU09OLnBhcnNlKHRlbXBfMjA1KTsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGVtcF8yMDggPT09ICJvYmplY3QiICYmIHRlbXBfMjA4ICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIGlmICh0ZW1wXzIwOC5tZXNzYWdlIHx8IHRlbXBfMjA4LnN0YXR1cyB8fCB0ZW1wXzIwOC5zdGF0dXNfY29kZSkgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdF85ID0gdGVtcF8yMDg7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlN1Ym1pdCBPVFAgcGFyc2VkIGxpbmUgMTI6IiwgcmVzdWx0XzkpOwogICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wXzIwOC5tZXNzYWdlID09PSAiTG9naW4gU3VjY2Vzc2Z1bCIpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgXCJMb2dpbiBTdWNjZXNzZnVsXCIgbWVzc2FnZSBmb3VuZCBpbiBsaW5lIDEyIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBjYXRjaCAoanNvbkRhdGFfMjQ0KSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIHBhcnNlIGxpbmUgMTI6IiwganNvbkRhdGFfMjQ0KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFyZXN1bHRfOSkgewogICAgICAgICAgICAgIGZvciAobGV0IGNvdW50XzI3ID0gMDsgY291bnRfMjcgPCBjb3VudF8yNi5sZW5ndGg7IGNvdW50XzI3KyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfMjA5ID0gY291bnRfMjZbY291bnRfMjddOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgbGV0IHRlbXBfMjEwID0gdGVtcF8yMDk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfMjExID0gdGVtcF8yMDkuaW5kZXhPZigiOiIpOwogICAgICAgICAgICAgICAgICBpZiAodGVtcF8yMTEgPiAtMSAmJiB0ZW1wXzIwOVt0ZW1wXzIxMSArIDFdID09PSAieyIpIHsKICAgICAgICAgICAgICAgICAgICB0ZW1wXzIxMCA9IHRlbXBfMjA5LnNsaWNlKHRlbXBfMjExICsgMSkudHJpbSgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBfMjEyID0gSlNPTi5wYXJzZSh0ZW1wXzIxMCk7CiAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGVtcF8yMTIgPT09ICJvYmplY3QiICYmIHRlbXBfMjEyICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBfMjEyLm1lc3NhZ2UgfHwgdGVtcF8yMTIuc3RhdHVzIHx8IHRlbXBfMjEyLnN0YXR1c19jb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXN1bHRfOSA9IHRlbXBfMjEyOwogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlN1Ym1pdCBPVFAgcGFyc2VkIGxpbmUgIiArIGNvdW50XzI3ICsgIjoiLCByZXN1bHRfOSk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXN1bHRfOSkgewogICAgICAgICAgICAgICAgICAgICAgcmVzdWx0XzkgPSB0ZW1wXzIxMjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHZhcl8yNDUpIHsKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghcmVzdWx0XzkpIHsKICAgICAgICAgICAgICByZXN1bHRfOSA9IHZhcl8xMzgocmVzdWx0XzgsIHsKICAgICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICAgIGxhYmVsOiAiU3VibWl0IE9UUCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coIlN1Ym1pdCBPVFAgZmluYWwgcGFyc2VkIHBheWxvYWQ6IiwgcmVzdWx0XzkpOwogICAgICAgICAgY29uc3QgdGVtcF8yMTMgPSBwYXJhbV8yMSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGRhdGFfMjQgPSB7CiAgICAgICAgICAgICAgZW1haWw6IG51bGwsCiAgICAgICAgICAgICAgbW9iaWxlX25vOiBudWxsCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlmICghcGFyYW1fMjEpIHsKICAgICAgICAgICAgICByZXR1cm4gZGF0YV8yNDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocGFyYW1fMjEuZW1haWwpIHsKICAgICAgICAgICAgICBkYXRhXzI0LmVtYWlsID0gcGFyYW1fMjEuZW1haWw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHBhcmFtXzIxLm1vYmlsZV9ubykgewogICAgICAgICAgICAgIGRhdGFfMjQubW9iaWxlX25vID0gcGFyYW1fMjEubW9iaWxlX25vOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwYXJhbV8yMS5kYXRhKSB7CiAgICAgICAgICAgICAgaWYgKHBhcmFtXzIxLmRhdGEuZW1haWwpIHsKICAgICAgICAgICAgICAgIGRhdGFfMjQuZW1haWwgPSBwYXJhbV8yMS5kYXRhLmVtYWlsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAocGFyYW1fMjEuZGF0YS5tb2JpbGVfbm8pIHsKICAgICAgICAgICAgICAgIGRhdGFfMjQubW9iaWxlX25vID0gcGFyYW1fMjEuZGF0YS5tb2JpbGVfbm87CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghZGF0YV8yNC5lbWFpbCB8fCAhZGF0YV8yNC5tb2JpbGVfbm8pIHsKICAgICAgICAgICAgICBjb25zdCB0ZW1wXzIxNCA9IHJlc3VsdF84Lm1hdGNoKC8iZW1haWwiXHMqOlxzKiIoW14iXSspIi9pKSB8fCByZXN1bHRfOC5tYXRjaCgvZW1haWxbOlxzPV0rKFteXHMsfV0rKS9pKTsKICAgICAgICAgICAgICBjb25zdCB0ZW1wXzIxNSA9IHJlc3VsdF84Lm1hdGNoKC8ibW9iaWxlX25vIlxzKjpccyoiKFteIl0rKSIvaSkgfHwgcmVzdWx0XzgubWF0Y2goL21vYmlsZV9ub1s6XHM9XSsoW15ccyx9XSspL2kpIHx8IHJlc3VsdF84Lm1hdGNoKC9tb2JpbGVbOlxzPV0rKFteXHMsfV0rKS9pKTsKICAgICAgICAgICAgICBpZiAodGVtcF8yMTQgJiYgIWRhdGFfMjQuZW1haWwpIHsKICAgICAgICAgICAgICAgIGRhdGFfMjQuZW1haWwgPSB0ZW1wXzIxNFsxXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHRlbXBfMjE1ICYmICFkYXRhXzI0Lm1vYmlsZV9ubykgewogICAgICAgICAgICAgICAgZGF0YV8yNC5tb2JpbGVfbm8gPSB0ZW1wXzIxNVsxXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGRhdGFfMjQ7CiAgICAgICAgICB9OwogICAgICAgICAgY29uc3QgdGVtcF8yMTYgPSBkYXRhXzI1ID0-IHsKICAgICAgICAgICAgaWYgKCFkYXRhXzI1KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IGRhdGFfMjYgPSBkYXRhXzI1Lm1lc3NhZ2UgfHwgZGF0YV8yNS5kYXRhICYmIGRhdGFfMjUuZGF0YS5tZXNzYWdlOwogICAgICAgICAgICBpZiAoZGF0YV8yNiAmJiB0eXBlb2YgZGF0YV8yNiA9PT0gInN0cmluZyIpIHsKICAgICAgICAgICAgICBjb25zdCB0ZW1wXzIxNyA9IGRhdGFfMjYudHJpbSgpOwogICAgICAgICAgICAgIGlmICh0ZW1wXzIxNyA9PT0gIkxvZ2luIFN1Y2Nlc3NmdWwiKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi4pyFIFwiTG9naW4gU3VjY2Vzc2Z1bFwiIG1lc3NhZ2UgZGV0ZWN0ZWQgaW4gcGFyc2VkIGRhdGEiKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9OwogICAgICAgICAgY29uc3QgdGVtcF8yMTggPSBwYXJhbV8yMiA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMjE5ID0gLyJtZXNzYWdlIlxzKjpccyoiTG9naW4gU3VjY2Vzc2Z1bCIvaTsKICAgICAgICAgICAgY29uc3QgdGVtcF8yMjAgPSBwYXJhbV8yMi5tYXRjaCh0ZW1wXzIxOSk7CiAgICAgICAgICAgIGlmICh0ZW1wXzIyMCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgXCJMb2dpbiBTdWNjZXNzZnVsXCIgbWVzc2FnZSBmb3VuZCBpbiByYXcgcmVzcG9uc2UiKTsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9OwogICAgICAgICAgaWYgKCFyZXN1bHRfOSkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHBhcnNlIHN1Ym1pdCBPVFAgcmVzcG9uc2UgcGF5bG9hZCIpOwogICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXMobnVsbCwgIlN1Ym1pdCBPVFAiLCByZXN1bHRfOCwgIlN1Ym1pdCBPVFAgU3VjY2VzcyIsICJTdWJtaXQgT1RQIEZhaWxlZCIpOwogICAgICAgICAgICByZXNldEJ1dHRvblN0YXRlKGVsZW1lbnRfMTUyKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJsb2dpbi1zdWJtaXQtb3RwIiwgbnVsbCwgdGVtcF8xODYpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgc3RlcF84ID0gdGVtcF8yMTYocmVzdWx0XzkpOwogICAgICAgICAgaWYgKCFzdGVwXzgpIHsKICAgICAgICAgICAgc3RlcF84ID0gdGVtcF8yMTgocmVzdWx0XzgpOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgZGF0YV8yNyA9IHJlc3VsdF85Py5kYXRhICYmIHJlc3VsdF85LmRhdGEudG9rZW5fdHlwZSA9PT0gIkJlYXJlciI7CiAgICAgICAgICBpZiAoc3RlcF84IHx8IGRhdGFfMjcgfHwgdmFyXzIxMChyZXN1bHRfOSkpIHsKICAgICAgICAgICAgY29uc3QgdGVtcF8yMjEgPSB0ZW1wXzIxMyhyZXN1bHRfOSk7CiAgICAgICAgICAgIHZhcl83MChyZXN1bHRfOSwgaGVhZGVyc183KTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImFjdGl2ZVN0ZXAiLCAiMSIpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYXV0aFN0ZXAiLCAiMTAwIik7CiAgICAgICAgICAgIGlmIChyZXN1bHRfOS5kYXRhICYmIHJlc3VsdF85LmRhdGEucHJvZmlsZV9pbWFnZSkgewogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJhdXRoX3Bob3RvIiwgcmVzdWx0XzkuZGF0YS5wcm9maWxlX2ltYWdlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zb2xlLmxvZygi4pyFIExvZ2luIE9UUCBjb2RlIHZlcmlmeSBzdWNjZXNzZnVsbHkgLSBNZXNzYWdlOiBMb2dpbiBTdWNjZXNzZnVsIik7CiAgICAgICAgICAgIGlmIChzdGVwXzggJiYgYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5MT0dJTl9TVUJNSVRfT1RQKSB7CiAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuc3VibWl0T3RwU3RhdHVzMjAwID0gdHJ1ZTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQXV0byBTZXF1ZW5jZTogXCJMb2dpbiBTdWNjZXNzZnVsXCIgbWVzc2FnZSBkZXRlY3RlZCAtIHByb2NlZWRpbmcgdG8gbmV4dCBzdGVwIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgYnV0dG9uXzEzID0gdXBkYXRlQnV0dG9uU3RhdHVzKHJlc3VsdF85LCAiU3VibWl0IE9UUCIsIHJlc3VsdF84LCAiU3VibWl0IE9UUCBTdWNjZXNzIiwgIlN1Ym1pdCBPVFAgRmFpbGVkIik7CiAgICAgICAgICAgIGxldCB0ZW1wXzIyMiA9IGJ1dHRvbl8xMy5tZXNzYWdlOwogICAgICAgICAgICBjb25zdCBjb3VudF8yOCA9IFt0ZW1wXzIyMl07CiAgICAgICAgICAgIGlmICh0ZW1wXzIyMS5lbWFpbCkgewogICAgICAgICAgICAgIGNvdW50XzI4LnB1c2goIkVtYWlsOiAiICsgdGVtcF8yMjEuZW1haWwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0ZW1wXzIyMS5tb2JpbGVfbm8pIHsKICAgICAgICAgICAgICBjb3VudF8yOC5wdXNoKCJNb2JpbGU6ICIgKyB0ZW1wXzIyMS5tb2JpbGVfbm8pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjb3VudF8yOC5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8yMjMgPSBjb3VudF8yOC5qb2luKCIgfCAiKTsKICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiU3VjY2VzczogIiArIHRlbXBfMjIzLCAiIzAwRkYwMCIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFzeW5jUmVzdWx0XzkzKGVsZW1lbnRfMTUyKTsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNldEJ1dHRvblN0YXRlKGVsZW1lbnRfMTUyKSwgMzAwMCk7CiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTU2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImxvZ2luLW90cC10aW1lci1kaXNwbGF5Iik7CiAgICAgICAgICAgIGlmIChlbGVtZW50XzE1NikgewogICAgICAgICAgICAgIGVsZW1lbnRfMTU2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyXzYyKCJvdHAiKTsKICAgICAgICAgICAgZGVsYXlfOCA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImF1dGhTdGVwIiwgIjMiKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIlN1Ym1pdCBPVFAgZmFpbGVkIik7CiAgICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgIHVwZGF0ZUJ1dHRvblN0YXR1cyhyZXN1bHRfOSwgIlN1Ym1pdCBPVFAiLCByZXN1bHRfOCwgIlN1Ym1pdCBPVFAgU3VjY2VzcyIsICJTdWJtaXQgT1RQIEZhaWxlZCIpOwogICAgICAgICAgICByZXNldEJ1dHRvblN0YXRlKGVsZW1lbnRfMTUyKTsKICAgICAgICAgICAgZGVsYXlfOCA9IGZhbHNlOwogICAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoImxvZ2luLXN1Ym1pdC1vdHAiLCBudWxsLCB0ZW1wXzE4Nik7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAobWVzc2FnZV8yNDYpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBsb2dpbiBvdHAgdmVyaWZ5OiIsIG1lc3NhZ2VfMjQ2KTsKICAgICAgICAgIGRlbGF5XzggPSBmYWxzZTsKICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICBjb25zdCBidXR0b25fMTQgPSB7CiAgICAgICAgICAgIGVycm9yOiBtZXNzYWdlXzI0Ni5tZXNzYWdlCiAgICAgICAgICB9OwogICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKGJ1dHRvbl8xNCwgIlN1Ym1pdCBPVFAiLCAiIiwgIlN1Ym1pdCBPVFAgU3VjY2VzcyIsICJTdWJtaXQgT1RQIEZhaWxlZCIpOwogICAgICAgICAgcmVzZXRCdXR0b25TdGF0ZShidXR0b25FbGVtZW50KTsKICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgibG9naW4tc3VibWl0LW90cCIsIG51bGwsIHJldHJ5T3BlcmF0aW9uLCB7CiAgICAgICAgICAgIGlzTmV0d29ya0Vycm9yOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZXZlbnRIYW5kbGVyXzE3OCgiYXBwbGljYXRpb24taW5mby1idG4iLCAiY2xpY2siLCBhc3luYyBmdW5jdGlvbiAocGFyYW1fMjMpIHsKICAgICAgICBjb25zdCB0ZW1wXzIyNCA9ICJiZ2QiOwogICAgICAgIHZhcl8yMzEodGVtcF8yMjQpOwogICAgICAgIGNvbnN0IHRlbXBfMjI1ID0gdGhpcy5pZDsKICAgICAgICB2YXJfNTYoKTsKICAgICAgICBjb25zdCB0ZW1wXzIyNiA9IGVkaXRlZEVuZHBvaW50c1t0ZW1wXzIyNV07CiAgICAgICAgaWYgKHRlbXBfMjI2KSB7CiAgICAgICAgICBzdWJtaXRBcHBsaWNhdGlvbkluZm8odGVtcF8yMjYpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdWJtaXRBcHBsaWNhdGlvbkluZm8oKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBhc3luYyBmdW5jdGlvbiBzdWJtaXRBcHBsaWNhdGlvbkluZm8oYXN5bmNSZXN1bHRfMjQ3ID0gbnVsbCkgewogICAgICAgIHZhcl8xMjgoKTsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiVHJ5IFRvIFN1Ym1pdCBBcHBsaWNhdGlvbiBJbmZvIiwgIiNGRkQ3MDAiKTsKICAgICAgICBjb25zdCBlbGVtZW50XzE1NyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHBsaWNhdGlvbi1pbmZvLWJ0biIpOwogICAgICAgIGNvbnN0IHRlbXBfMjI3ID0gKCkgPT4gc3VibWl0QXBwbGljYXRpb25JbmZvKGFzeW5jUmVzdWx0XzI0Nyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHRlbXBfMjI4ID0gewogICAgICAgICAgICAuLi5wYXlsb2FkRGF0YS5hcHAKICAgICAgICAgIH07CiAgICAgICAgICBsZXQgY29uZmlnXzMgPSB0ZW1wXzIyODsKICAgICAgICAgIGlmIChjYXB0Y2hhUHJvdmlkZXJDb25maWcuYmdkLmVuYWJsZWQgJiYgY2FwdGNoYVByb3ZpZGVyQ29uZmlnLmJnZC50b2tlbikgewogICAgICAgICAgICB2YXJfMTkyKGNvbmZpZ18zLCBjYXB0Y2hhUHJvdmlkZXJDb25maWcuYmdkLnRva2VuLCBjYXB0Y2hhVG9rZW5OYW1lcy5hcHApOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgZGVsYXlfNDEgPSBhd2FpdCBhc3luY1Jlc3VsdF8xMjkoKTsKICAgICAgICAgIGNvbnN0IHRleHRfMzYgPSBbY29uZmlnXzMsIGZhbHNlLCBkZWxheV80MV07CiAgICAgICAgICBjb25zdCB0ZXh0XzM3ID0gSlNPTi5zdHJpbmdpZnkodGV4dF8zNik7CiAgICAgICAgICBjb25zb2xlLmxvZygiQXBwbGljYXRpb24gSW5mbyBwYXlsb2FkIHByZXBhcmVkOiIsIHRleHRfMzcpOwogICAgICAgICAgY29uc3QgZGVsYXlfNDIgPSBhc3luY1Jlc3VsdF8yNDcgfHwgZGF0ZXRpbWVfMTMwKCJhcHBsaWNhdGlvbkluZm9TdWJtaXQiKTsKICAgICAgICAgIGNvbnN0IHJlc3VsdF8xMCA9IGF3YWl0IGZldGNoKGRlbGF5XzQyLCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgLi4uY3JlYXRlTmV4dEFjdGlvbkhlYWRlcnMobmV4dEFjdGlvbkNvbmZpZy5hcHBsaWNhdGlvbkluZm8pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAiaW5jbHVkZSIsCiAgICAgICAgICAgIHJlZmVycmVyOiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgICAgICAgICByZWZlcnJlclBvbGljeTogInNhbWUtb3JpZ2luIiwKICAgICAgICAgICAgYm9keTogdGV4dF8zNwogICAgICAgICAgfSk7CiAgICAgICAgICBjb25zdCByZXN1bHRfMTEgPSBhd2FpdCByZXN1bHRfMTAudGV4dCgpOwogICAgICAgICAgY29uc29sZS5sb2coIkFwcGxpY2F0aW9uIGluZm8gSFRUUCBzdGF0dXM6IiwgcmVzdWx0XzEwLnN0YXR1cywgIigyMDAgPSBjb25uZWN0ZWQsIG5vdCBzdWNjZXNzKSIpOwogICAgICAgICAgY29uc29sZS5sb2coIkFwcGxpY2F0aW9uIGluZm8gcmF3IHJlc3BvbnNlOiIsIHJlc3VsdF8xMS5zdWJzdHJpbmcoMCwgNTAwKSk7CiAgICAgICAgICBpZiAoIXJlc3VsdF8xMC5vayAmJiByZXN1bHRfMTAuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkhUVFAgc3RhdHVzICIgKyByZXN1bHRfMTAuc3RhdHVzICsgIiByZXR1cm5lZCAtIHdpbGwgY2hlY2sgcmVzcG9uc2UgbWVzc2FnZSBmb3IgYWN0dWFsIHN1Y2Nlc3MvZmFpbHVyZSIpOwogICAgICAgICAgICBoYW5kbGVBdXRvU2VxdWVuY2VFcnJvcihyZXN1bHRfMTAuc3RhdHVzKTsKICAgICAgICAgICAgaWYgKHJlc3VsdF8xMC5zdGF0dXMgPT09IDUwMCB8fCByZXN1bHRfMTAuc3RhdHVzID09PSA1MDIgfHwgcmVzdWx0XzEwLnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc3QgY291bnRfMjkgPSByZXN1bHRfMTEuc3BsaXQoL1xyP1xuLyk7CiAgICAgICAgICBsZXQgdGVtcF8yMjkgPSBudWxsOwogICAgICAgICAgaWYgKGNvdW50XzI5Lmxlbmd0aCA-PSAyKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMjMwID0gY291bnRfMjlbMV0udHJpbSgpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiQXBwbGljYXRpb24gaW5mbyBsaW5lIDE6IiwgdGVtcF8yMzApOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGxldCB0ZW1wXzIzMSA9IHRlbXBfMjMwOwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfMjMyID0gdGVtcF8yMzAuaW5kZXhPZigiOiIpOwogICAgICAgICAgICAgIGlmICh0ZW1wXzIzMiA-IC0xKSB7CiAgICAgICAgICAgICAgICB0ZW1wXzIzMSA9IHRlbXBfMjMwLnNsaWNlKHRlbXBfMjMyICsgMSkudHJpbSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0ZW1wXzIyOSA9IEpTT04ucGFyc2UodGVtcF8yMzEpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJBcHBsaWNhdGlvbiBpbmZvIHBhcnNlZCBsaW5lIDE6IiwgdGVtcF8yMjkpOwogICAgICAgICAgICB9IGNhdGNoIChqc29uRGF0YV8yNDgpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIHBhcnNlIGxpbmUgMToiLCBqc29uRGF0YV8yNDgpOwogICAgICAgICAgICAgIHRlbXBfMjI5ID0gdmFyXzEzOChyZXN1bHRfMTEsIHsKICAgICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICAgIGxhYmVsOiAiQXBwbGljYXRpb24gSW5mbyIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGVtcF8yMjkgPSB2YXJfMTM4KHJlc3VsdF8xMSwgewogICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICBsYWJlbDogIkFwcGxpY2F0aW9uIEluZm8iCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coIkFwcGxpY2F0aW9uIGluZm8gZmluYWwgcGFyc2VkIHBheWxvYWQ6IiwgdGVtcF8yMjkpOwogICAgICAgICAgaWYgKCF0ZW1wXzIyOSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHRlbXBfMjI5ID0gdmFyXzEzOChyZXN1bHRfMTEsIHsKICAgICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICAgIGxhYmVsOiAiQXBwbGljYXRpb24gSW5mbyIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBjYXRjaCAoanNvbkRhdGFfMjQ5KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBwYXJzZSByZXNwb25zZToiLCBqc29uRGF0YV8yNDkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBmb3JtRGF0YV80ID0gb3V0Y29tZV8xMzkodGVtcF8yMjksIHJlc3VsdF8xMSwgIkFwcGxpY2F0aW9uIGluZm9ybWF0aW9uIHN1Ym1pdHRlZCBzdWNjZXNzZnVsbHkiKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCLwn5SNIEFwcGxpY2F0aW9uIEluZm8gc3VjY2VzcyBkZXRlY3Rpb246IiwgZm9ybURhdGFfNCA_ICLinIUgU1VDQ0VTUyIgOiAi4p2MIEZBSUxVUkUiKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXNwb25zZSBtZXNzYWdlOiIsIHRlbXBfMjI5Py5tZXNzYWdlIHx8IHRlbXBfMjI5Py5kYXRhPy5tZXNzYWdlIHx8ICJOb3QgZm91bmQiKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJIVFRQIFN0YXR1czoiLCByZXN1bHRfMTAuc3RhdHVzLCAiKDIwMCA9IGNvbm5lY3RlZCwgbm90IHN1Y2Nlc3MpIik7CiAgICAgICAgICBpZiAoZm9ybURhdGFfNCAmJiB0ZW1wXzIyOT8uZGF0YSkgewogICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oImFwcGxpY2FudCIpICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oImFwcGxpY2FudCIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHRleHRfMzggPSB7CiAgICAgICAgICAgICAgaGlnaF9jb206IGhpZ2hjb20sCiAgICAgICAgICAgICAgaXZhY19pZDogaXZhY19pZCwKICAgICAgICAgICAgICB2aXNhX3R5cGU6IHZpc2FfdHlwZSwKICAgICAgICAgICAgICB2aXNpdF9wdXJwb3NlOiB2aXNpdF9wdXJwb3NlLAogICAgICAgICAgICAgIHdlYmZpbGVfaWQ6IHdlYmZpbGVfaWQsCiAgICAgICAgICAgICAgZmFtaWx5X2NvdW50OiBmYW1pbHlfY291bnQsCiAgICAgICAgICAgICAgd2ViZmlsZV9pZF9yZXBlYXQ6IHdlYmZpbGVfaWQKICAgICAgICAgICAgfTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImFwcGxpY2FudCIsIEpTT04uc3RyaW5naWZ5KHRleHRfMzgpKTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImFjdGl2ZVN0ZXAiLCAiMiIpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYXV0aFN0ZXAiLCAiMTAwIik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgQXBwbGljYXRpb24gSW5mbyBzdG9yZSBTdWNjZXNzZnVsbHkgLSBzcGVjaWZpYyBzdWNjZXNzIG1lc3NhZ2UgZGV0ZWN0ZWQiKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKHRlbXBfMjI5LCAiQXBwbGljYXRpb24gSW5mbyIsIHJlc3VsdF8xMSwgIkFwcGxpY2F0aW9uIEluZm8gc3RvcmUgU3VjY2Vzc2Z1bGx5IiwgIkFwcGxpY2F0aW9uIEluZm8gRmFpbGVkIik7CiAgICAgICAgICAgIHZhcl84OShlbGVtZW50XzE1Nyk7CiAgICAgICAgICAgIHRpbWVyQ2FsbGJhY2tfNzcoMSk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzZXRCdXR0b25TdGF0ZShlbGVtZW50XzE1NyksIDMwMDApOwogICAgICAgICAgICB2YXJfNjIoImJnZCIpOwogICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5hcHBTdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKGNhcHRjaGFQcm92aWRlckNvbmZpZy5iZ2QuZW5hYmxlZCkgewogICAgICAgICAgICAgIGNhcHRjaGFQcm92aWRlckNvbmZpZy5iZ2QuZW5hYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgIGNhcHRjaGFQcm92aWRlckNvbmZpZy5iZ2QudG9rZW4gPSAiIjsKICAgICAgICAgICAgICB2YXJfNTUoImJnZCIpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJCR0QgVGFiIENGIEJ1dHRvbiB0dXJuZWQgb2ZmIGF1dG9tYXRpY2FsbHkgYWZ0ZXIgQXBwIEJ1dHRvbiBzdWNjZXNzIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGF1dG9TZXF1ZW5jZVN0YXRlLmVuYWJsZWQgJiYgYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICAgIGRldGVjdE1hbnVhbEJ1dHRvblN1Y2Nlc3MoImFwcGxpY2F0aW9uLWluZm8tYnRuIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaGFuZGxlQmdkUGVyc29uYWxEZWxheSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygi4p2MIEFwcGxpY2F0aW9uIEluZm86IEZBSUxVUkUgLSBzcGVjaWZpYyBzdWNjZXNzIG1lc3NhZ2UgXCJBcHBsaWNhdGlvbiBpbmZvcm1hdGlvbiBzdWJtaXR0ZWQgc3VjY2Vzc2Z1bGx5XCIgTk9UIGRldGVjdGVkIik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJIVFRQIFN0YXR1czoiLCByZXN1bHRfMTAuc3RhdHVzLCAiKDIwMCA9IGNvbm5lY3RlZCB0byBzZXJ2ZXIsIG5vdCBzdWNjZXNzKSIpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiUmVzcG9uc2UgbWVzc2FnZSBmb3VuZDoiLCB0ZW1wXzIyOT8ubWVzc2FnZSB8fCB0ZW1wXzIyOT8uZGF0YT8ubWVzc2FnZSB8fCAiTm8gbWVzc2FnZSBmb3VuZCIpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiUmF3IHJlc3BvbnNlIHByZXZpZXc6IiwgcmVzdWx0XzExLnN1YnN0cmluZygwLCA1MDApKTsKICAgICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgiYmdkLWFwcCIsIHJlc3VsdF8xMC5zdGF0dXMsIHRlbXBfMjI3LCB0ZW1wXzIyOSwgcmVzdWx0XzExLCBlbGVtZW50XzE1NywgIkFwcGxpY2F0aW9uIEluZm8iKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoICh2YXJfMjUwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgQXBwbGljYXRpb24gSW5mbyBzdG9yZToiLCB2YXJfMjUwKTsKICAgICAgICAgIGhhbmRsZU9wZXJhdGlvbkZhaWx1cmUoImJnZC1hcHAiLCBudWxsLCB0ZW1wXzIyNywgbnVsbCwgIiIsIGVsZW1lbnRfMTU3LCAiQXBwbGljYXRpb24gSW5mbyIpOwogICAgICAgIH0KICAgICAgfQogICAgICBldmVudEhhbmRsZXJfMTc4KCJwZXJzb25hbC1pbmZvLWJ0biIsICJjbGljayIsIGFzeW5jIGZ1bmN0aW9uIChwYXJhbV8yNCkgewogICAgICAgIGNvbnN0IHRlbXBfMjMzID0gInBlcnNvbmFsIjsKICAgICAgICB2YXJfMjMxKHRlbXBfMjMzKTsKICAgICAgICBjb25zdCB0ZW1wXzIzNCA9IHRoaXMuaWQ7CiAgICAgICAgdmFyXzU2KCk7CiAgICAgICAgY29uc3QgdGVtcF8yMzUgPSBlZGl0ZWRFbmRwb2ludHNbdGVtcF8yMzRdOwogICAgICAgIGlmICh0ZW1wXzIzNSkgewogICAgICAgICAgYXN5bmNSZXN1bHRfNTgodGVtcF8yMzUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhc3luY1Jlc3VsdF81OCgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGFzeW5jIGZ1bmN0aW9uIGFzeW5jUmVzdWx0XzU4KGFzeW5jUmVzdWx0XzI1MSA9IG51bGwpIHsKICAgICAgICB2YXJfMTI4KCk7CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlRyeSBUbyBTdWJtaXQgUGVyc29uYWwgSW5mbyIsICIjRkZENzAwIik7CiAgICAgICAgY29uc3QgZWxlbWVudF8xNTggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGVyc29uYWwtaW5mby1idG4iKTsKICAgICAgICBjb25zdCB0ZW1wXzIzNiA9ICgpID0-IGFzeW5jUmVzdWx0XzU4KGFzeW5jUmVzdWx0XzI1MSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGNvdW50XzMwID0gcGFyc2VJbnQoZmFtaWx5X2NvdW50KSB8fCAwOwogICAgICAgICAgY29uc3QgdGVtcF8yMzcgPSB7fTsKICAgICAgICAgIGZvciAobGV0IGRhdGFfMjggPSAwOyBkYXRhXzI4IDwgY291bnRfMzA7IGRhdGFfMjgrKykgewogICAgICAgICAgICBpZiAoZGF0YV8yOCA8IGZhbWlseURhdGEubGVuZ3RoICYmIGZhbWlseURhdGFbZGF0YV8yOF0pIHsKICAgICAgICAgICAgICB0ZW1wXzIzN1tkYXRhXzI4XSA9IHsKICAgICAgICAgICAgICAgIG5hbWU6IGZhbWlseURhdGFbZGF0YV8yOF0ubmFtZSB8fCAiIiwKICAgICAgICAgICAgICAgIHdlYmZpbGVfbm86IGZhbWlseURhdGFbZGF0YV8yOF0ud2ViZmlsZV9ubyB8fCAiIiwKICAgICAgICAgICAgICAgIGFnYWluX3dlYmZpbGVfbm86IGZhbWlseURhdGFbZGF0YV8yOF0ud2ViZmlsZV9ubyB8fCAiIgogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGVtcF8yMzdbZGF0YV8yOF0gPSB7CiAgICAgICAgICAgICAgICBuYW1lOiAiIiwKICAgICAgICAgICAgICAgIHdlYmZpbGVfbm86ICIiLAogICAgICAgICAgICAgICAgYWdhaW5fd2ViZmlsZV9ubzogIiIKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgY29uZmlnXzQgPSB7CiAgICAgICAgICAgIGZ1bGxfbmFtZTogcGF5bG9hZERhdGEucGVyc29uYWwuZnVsbF9uYW1lIHx8IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhdXRoX25hbWUiKSB8fCAiIiwKICAgICAgICAgICAgZW1haWxfbmFtZTogcGF5bG9hZERhdGEucGVyc29uYWwuZW1haWxfbmFtZSB8fCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiYXV0aF9lbWFpbCIpIHx8ICIiLAogICAgICAgICAgICBwaG9uZTogcGF5bG9hZERhdGEucGVyc29uYWwucGhvbmUgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImF1dGhfcGhvbmUiKSB8fCAiIiwKICAgICAgICAgICAgd2ViZmlsZV9pZDogcGF5bG9hZERhdGEucGVyc29uYWwud2ViZmlsZV9pZCB8fCB3ZWJmaWxlX2lkLAogICAgICAgICAgICBmYW1pbHk6IHRlbXBfMjM3CiAgICAgICAgICB9OwogICAgICAgICAgaWYgKGNhcHRjaGFQcm92aWRlckNvbmZpZy5iZ2QuZW5hYmxlZCAmJiBjYXB0Y2hhUHJvdmlkZXJDb25maWcuYmdkLnRva2VuKSB7CiAgICAgICAgICAgIHZhcl8xOTIoY29uZmlnXzQsIGNhcHRjaGFQcm92aWRlckNvbmZpZy5iZ2QudG9rZW4sIGNhcHRjaGFUb2tlbk5hbWVzLnBlcnNvbmFsKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGRlbGF5XzQzID0gYXdhaXQgYXN5bmNSZXN1bHRfMTI5KCk7CiAgICAgICAgICBjb25zdCB0ZXh0XzM5ID0gW2NvbmZpZ180LCBmYWxzZSwgZGVsYXlfNDNdOwogICAgICAgICAgY29uc3QgdGV4dF80MCA9IEpTT04uc3RyaW5naWZ5KHRleHRfMzkpOwogICAgICAgICAgY29uc29sZS5sb2coIlBlcnNvbmFsIEluZm8gcGF5bG9hZCBwcmVwYXJlZDoiLCB0ZXh0XzQwKTsKICAgICAgICAgIGNvbnN0IGRlbGF5XzQ0ID0gYXN5bmNSZXN1bHRfMjUxIHx8IGRhdGV0aW1lXzEzMCgicGVyc29uYWxJbmZvU3VibWl0Iik7CiAgICAgICAgICBjb25zdCByZXN1bHRfMTIgPSBhd2FpdCBmZXRjaChkZWxheV80NCwgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIC4uLmNyZWF0ZU5leHRBY3Rpb25IZWFkZXJzKG5leHRBY3Rpb25Db25maWcucGVyc29uYWxJbmZvKQogICAgICAgICAgICB9LAogICAgICAgICAgICBjcmVkZW50aWFsczogImluY2x1ZGUiLAogICAgICAgICAgICByZWZlcnJlcjogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIiwKICAgICAgICAgICAgcmVmZXJyZXJQb2xpY3k6ICJzYW1lLW9yaWdpbiIsCiAgICAgICAgICAgIGJvZHk6IHRleHRfNDAKICAgICAgICAgIH0pOwogICAgICAgICAgY29uc3QgcmVzdWx0XzEzID0gYXdhaXQgcmVzdWx0XzEyLnRleHQoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJQZXJzb25hbCBpbmZvIEhUVFAgc3RhdHVzOiIsIHJlc3VsdF8xMi5zdGF0dXMsICIoMjAwID0gY29ubmVjdGVkLCBub3Qgc3VjY2VzcykiKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJQZXJzb25hbCBpbmZvIHJhdyByZXNwb25zZToiLCByZXN1bHRfMTMuc3Vic3RyaW5nKDAsIDUwMCkpOwogICAgICAgICAgaWYgKCFyZXN1bHRfMTIub2sgJiYgcmVzdWx0XzEyLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJIVFRQIHN0YXR1cyAiICsgcmVzdWx0XzEyLnN0YXR1cyArICIgcmV0dXJuZWQgLSB3aWxsIGNoZWNrIHJlc3BvbnNlIG1lc3NhZ2UgZm9yIGFjdHVhbCBzdWNjZXNzL2ZhaWx1cmUiKTsKICAgICAgICAgICAgaWYgKHJlc3VsdF8xMi5zdGF0dXMgPT09IDQwMykge30gZWxzZSB7CiAgICAgICAgICAgICAgaGFuZGxlQXV0b1NlcXVlbmNlRXJyb3IocmVzdWx0XzEyLnN0YXR1cyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJlc3VsdF8xMi5zdGF0dXMgPT09IDUwMCB8fCByZXN1bHRfMTIuc3RhdHVzID09PSA1MDIgfHwgcmVzdWx0XzEyLnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coIlBlcnNvbmFsIGluZm8gcmF3IHJlc3BvbnNlOiIsIHJlc3VsdF8xMyk7CiAgICAgICAgICBjb25zdCBjb3VudF8zMSA9IHJlc3VsdF8xMy5zcGxpdCgvXHI_XG4vKTsKICAgICAgICAgIGxldCB0ZW1wXzIzOCA9IG51bGw7CiAgICAgICAgICBpZiAoY291bnRfMzEubGVuZ3RoID49IDIpIHsKICAgICAgICAgICAgY29uc3QgdGVtcF8yMzkgPSBjb3VudF8zMVsxXS50cmltKCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJQZXJzb25hbCBpbmZvIGxpbmUgMToiLCB0ZW1wXzIzOSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgbGV0IHRlbXBfMjQwID0gdGVtcF8yMzk7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8yNDEgPSB0ZW1wXzIzOS5pbmRleE9mKCI6Iik7CiAgICAgICAgICAgICAgaWYgKHRlbXBfMjQxID4gLTEpIHsKICAgICAgICAgICAgICAgIHRlbXBfMjQwID0gdGVtcF8yMzkuc2xpY2UodGVtcF8yNDEgKyAxKS50cmltKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRlbXBfMjM4ID0gSlNPTi5wYXJzZSh0ZW1wXzI0MCk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIlBlcnNvbmFsIGluZm8gcGFyc2VkIGxpbmUgMToiLCB0ZW1wXzIzOCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGpzb25EYXRhXzI1MikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGYWlsZWQgdG8gcGFyc2UgbGluZSAxOiIsIGpzb25EYXRhXzI1Mik7CiAgICAgICAgICAgICAgdGVtcF8yMzggPSB2YXJfMTM4KHJlc3VsdF8xMywgewogICAgICAgICAgICAgICAgcHJlZmVyU3RhdHVzT2JqZWN0OiB0cnVlLAogICAgICAgICAgICAgICAgbGFiZWw6ICJQZXJzb25hbCBJbmZvIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0ZW1wXzIzOCA9IHZhcl8xMzgocmVzdWx0XzEzLCB7CiAgICAgICAgICAgICAgcHJlZmVyU3RhdHVzT2JqZWN0OiB0cnVlLAogICAgICAgICAgICAgIGxhYmVsOiAiUGVyc29uYWwgSW5mbyIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygiUGVyc29uYWwgaW5mbyBmaW5hbCBwYXJzZWQgcGF5bG9hZDoiLCB0ZW1wXzIzOCk7CiAgICAgICAgICBpZiAoIXRlbXBfMjM4KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gcGFyc2UgcGVyc29uYWwgaW5mbyByZXNwb25zZSBwYXlsb2FkIik7CiAgICAgICAgICAgIGhhbmRsZU9wZXJhdGlvbkZhaWx1cmUoImJnZC1wZXJzb25hbCIsIHJlc3VsdF8xMi5zdGF0dXMsIHRlbXBfMjM2LCBudWxsLCByZXN1bHRfMTMsIGVsZW1lbnRfMTU4LCAiUGVyc29uYWwgSW5mbyIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBmb3JtRGF0YV81ID0gb3V0Y29tZV8xMzkodGVtcF8yMzgsIHJlc3VsdF8xMywgIlBlcnNvbmFsIGluZm9ybWF0aW9uIHNhdmVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgaWYgKGZvcm1EYXRhXzUgJiYgdGVtcF8yMzg_LmRhdGEpIHsKICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwZXJzb25hbF9pbmZvIikgIT09IG51bGwpIHsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgicGVyc29uYWxfaW5mbyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHRleHRfNDEgPSB7CiAgICAgICAgICAgICAgZW1haWxfbmFtZTogY29uZmlnXzQuZW1haWxfbmFtZSwKICAgICAgICAgICAgICBmdWxsX25hbWU6IGNvbmZpZ180LmZ1bGxfbmFtZSwKICAgICAgICAgICAgICBwaG9uZTogY29uZmlnXzQucGhvbmUsCiAgICAgICAgICAgICAgd2ViZmlsZV9pZDogY29uZmlnXzQud2ViZmlsZV9pZCwKICAgICAgICAgICAgICBmYW1pbHk6IGNvbmZpZ180LmZhbWlseQogICAgICAgICAgICB9OwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgicGVyc29uYWxfaW5mbyIsIEpTT04uc3RyaW5naWZ5KHRleHRfNDEpKTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImFjdGl2ZVN0ZXAiLCAiMyIpOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiYXV0aFN0ZXAiLCAiMTAwIik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgUGVyc29uYWwgSW5mbyBzdG9yZSBTdWNjZXNzZnVsbHkgLSBzcGVjaWZpYyBzdWNjZXNzIG1lc3NhZ2UgZGV0ZWN0ZWQiKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKHRlbXBfMjM4LCAiUGVyc29uYWwgSW5mbyIsIHJlc3VsdF8xMywgIlBlcnNvbmFsIEluZm8gc3RvcmUgU3VjY2Vzc2Z1bGx5IiwgIlBlcnNvbmFsIEluZm8gRmFpbGVkIik7CiAgICAgICAgICAgIHZhcl84OShlbGVtZW50XzE1OCk7CiAgICAgICAgICAgIHRpbWVyQ2FsbGJhY2tfNzcoMik7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzZXRCdXR0b25TdGF0ZShlbGVtZW50XzE1OCksIDMwMDApOwogICAgICAgICAgICB2YXJfNjIoInBlcnNvbmFsIik7CiAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLnBlcnNvbmFsU3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIGRldGVjdE1hbnVhbEJ1dHRvblN1Y2Nlc3MoInBlcnNvbmFsLWluZm8tYnRuIik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygi4p2MIFBlcnNvbmFsIEluZm86IEZBSUxVUkUgLSBzcGVjaWZpYyBzdWNjZXNzIG1lc3NhZ2UgXCJQZXJzb25hbCBpbmZvcm1hdGlvbiBzYXZlZCBzdWNjZXNzZnVsbHlcIiBOT1QgZGV0ZWN0ZWQiKTsKICAgICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgiYmdkLXBlcnNvbmFsIiwgcmVzdWx0XzEyLnN0YXR1cywgdGVtcF8yMzYsIHRlbXBfMjM4LCByZXN1bHRfMTMsIGVsZW1lbnRfMTU4LCAiUGVyc29uYWwgSW5mbyIpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKHZhcl8yNTMpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBQZXJzb25hbCBJbmZvIHN0b3JlOiIsIHZhcl8yNTMpOwogICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgiYmdkLXBlcnNvbmFsIiwgbnVsbCwgdGVtcF8yMzYsIG51bGwsICIiLCBlbGVtZW50XzE1OCwgIlBlcnNvbmFsIEluZm8iKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZXZlbnRIYW5kbGVyXzE3OCgib3ZlcnZpZXctYnRuIiwgImNsaWNrIiwgYXN5bmMgZnVuY3Rpb24gKHBhcmFtXzI1KSB7CiAgICAgICAgY29uc3QgdGVtcF8yNDIgPSAib3ZlcnZpZXciOwogICAgICAgIHZhcl8yMzEodGVtcF8yNDIpOwogICAgICAgIGNvbnN0IHRlbXBfMjQzID0gdGhpcy5pZDsKICAgICAgICB2YXJfNTYoKTsKICAgICAgICBjb25zdCB0ZW1wXzI0NCA9IGVkaXRlZEVuZHBvaW50c1t0ZW1wXzI0M107CiAgICAgICAgaWYgKHRlbXBfMjQ0KSB7CiAgICAgICAgICBhc3luY1Jlc3VsdF8yNTQodGVtcF8yNDQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhc3luY1Jlc3VsdF8yNTQoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBhc3luYyBmdW5jdGlvbiBhc3luY1Jlc3VsdF8yNTQoYXN5bmNSZXN1bHRfMjU1ID0gbnVsbCkgewogICAgICAgIHZhcl8xMjgoKTsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiVHJ5IFRvIFN1Ym1pdCBPdmVydmlldyIsICIjRkZENzAwIik7CiAgICAgICAgY29uc3QgZWxlbWVudF8xNTkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib3ZlcnZpZXctYnRuIik7CiAgICAgICAgY29uc3QgdGVtcF8yNDUgPSAoKSA9PiBhc3luY1Jlc3VsdF8yNTQoYXN5bmNSZXN1bHRfMjU1KTsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgZGVsYXlfNDUgPSBhd2FpdCBhc3luY1Jlc3VsdF8xMjkoKTsKICAgICAgICAgIGNvbnN0IHRleHRfNDIgPSBbImVuIiwgZGVsYXlfNDVdOwogICAgICAgICAgY29uc3QgdGV4dF80MyA9IEpTT04uc3RyaW5naWZ5KHRleHRfNDIpOwogICAgICAgICAgY29uc29sZS5sb2coIk92ZXJ2aWV3IHBheWxvYWQgcHJlcGFyZWQ6IiwgdGV4dF80Myk7CiAgICAgICAgICBjb25zdCBkZWxheV80NiA9IGFzeW5jUmVzdWx0XzI1NSB8fCBkYXRldGltZV8xMzAoIm92ZXJ2aWV3U3VibWl0Iik7CiAgICAgICAgICBjb25zdCBlcnJvcl8xOSA9IGF3YWl0IGZldGNoKGRlbGF5XzQ2LCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgLi4uY3JlYXRlTmV4dEFjdGlvbkhlYWRlcnMobmV4dEFjdGlvbkNvbmZpZy5vdmVydmlld0luZm8pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAiaW5jbHVkZSIsCiAgICAgICAgICAgIHJlZmVycmVyOiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgICAgICAgICByZWZlcnJlclBvbGljeTogInNhbWUtb3JpZ2luIiwKICAgICAgICAgICAgYm9keTogdGV4dF80MwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIWVycm9yXzE5Lm9rKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyAiICsgZXJyb3JfMTkuc3RhdHVzKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1NlcXVlbmNlRXJyb3IoZXJyb3JfMTkuc3RhdHVzKTsKICAgICAgICAgICAgaWYgKGVycm9yXzE5LnN0YXR1cyA9PT0gNTAwIHx8IGVycm9yXzE5LnN0YXR1cyA9PT0gNTAyIHx8IGVycm9yXzE5LnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cGRhdGVCdXR0b25Mb2FkaW5nKGVsZW1lbnRfMTU5KTsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNldEJ1dHRvblN0YXRlKGVsZW1lbnRfMTU5KSwgMzAwMCk7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgiYmdkLW92ZXJ2aWV3IiwgZXJyb3JfMTkuc3RhdHVzLCB0ZW1wXzI0NSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHJlc3VsdF8xNCA9IGF3YWl0IGVycm9yXzE5LnRleHQoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJPdmVydmlldyByYXcgcmVzcG9uc2U6IiwgcmVzdWx0XzE0KTsKICAgICAgICAgIGNvbnN0IGNvdW50XzMyID0gcmVzdWx0XzE0LnNwbGl0KC9ccj9cbi8pOwogICAgICAgICAgbGV0IHRlbXBfMjQ2ID0gbnVsbDsKICAgICAgICAgIGlmIChjb3VudF8zMi5sZW5ndGggPj0gMikgewogICAgICAgICAgICBjb25zdCB0ZW1wXzI0NyA9IGNvdW50XzMyWzFdLnRyaW0oKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIk92ZXJ2aWV3IGxpbmUgMToiLCB0ZW1wXzI0Nyk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgbGV0IHRlbXBfMjQ4ID0gdGVtcF8yNDc7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8yNDkgPSB0ZW1wXzI0Ny5pbmRleE9mKCI6Iik7CiAgICAgICAgICAgICAgaWYgKHRlbXBfMjQ5ID4gLTEpIHsKICAgICAgICAgICAgICAgIHRlbXBfMjQ4ID0gdGVtcF8yNDcuc2xpY2UodGVtcF8yNDkgKyAxKS50cmltKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRlbXBfMjQ2ID0gSlNPTi5wYXJzZSh0ZW1wXzI0OCk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIk92ZXJ2aWV3IHBhcnNlZCBsaW5lIDE6IiwgdGVtcF8yNDYpOwogICAgICAgICAgICB9IGNhdGNoIChqc29uRGF0YV8yNTYpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIHBhcnNlIGxpbmUgMToiLCBqc29uRGF0YV8yNTYpOwogICAgICAgICAgICAgIHRlbXBfMjQ2ID0gdmFyXzEzOChyZXN1bHRfMTQsIHsKICAgICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICAgIGxhYmVsOiAiT3ZlcnZpZXciCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRlbXBfMjQ2ID0gdmFyXzEzOChyZXN1bHRfMTQsIHsKICAgICAgICAgICAgICBwcmVmZXJTdGF0dXNPYmplY3Q6IHRydWUsCiAgICAgICAgICAgICAgbGFiZWw6ICJPdmVydmlldyIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygiT3ZlcnZpZXcgZmluYWwgcGFyc2VkIHBheWxvYWQ6IiwgdGVtcF8yNDYpOwogICAgICAgICAgaWYgKCF0ZW1wXzI0NikgewogICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHBhcnNlIG92ZXJ2aWV3IHJlc3BvbnNlIHBheWxvYWQiKTsKICAgICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgiYmdkLW92ZXJ2aWV3IiwgZXJyb3JfMTkuc3RhdHVzLCB0ZW1wXzI0NSwgbnVsbCwgcmVzdWx0XzE0LCBlbGVtZW50XzE1OSwgIk92ZXJ2aWV3Iik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHRlbXBfMjUwID0gb3V0Y29tZV8xMzkodGVtcF8yNDYsIHJlc3VsdF8xNCwgIkJvb2tpbmcgc2Vzc2lvbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgaWYgKHRlbXBfMjUwKSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJhY3RpdmVTdGVwIiwgIjQiKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIk92ZXJ2aWV3IHNlc3Npb24gY3JlYXRlZCBTdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKHRlbXBfMjQ2LCAiT3ZlcnZpZXciLCByZXN1bHRfMTQsICJPdmVydmlldyBzZXNzaW9uIGNyZWF0ZWQgU3VjY2Vzc2Z1bGx5IiwgIk92ZXJ2aWV3IEZhaWxlZCIpOwogICAgICAgICAgICB2YXJfODkoZWxlbWVudF8xNTkpOwogICAgICAgICAgICB0aW1lckNhbGxiYWNrXzc3KDMpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHJlc2V0QnV0dG9uU3RhdGUoZWxlbWVudF8xNTkpLCAzMDAwKTsKICAgICAgICAgICAgdmFyXzYyKCJvdmVydmlldyIpOwogICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5CR0RfT1ZFUlZJRVcpIHsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5vdmVydmlld1N1Y2Nlc3MgPSB0cnVlOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJBdXRvIFNlcXVlbmNlOiBPdmVydmlldyBzdWNjZXNzIHJlc3BvbnNlIGRldGVjdGVkIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGV0ZWN0TWFudWFsQnV0dG9uU3VjY2Vzcygib3ZlcnZpZXctYnRuIik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygi4p2MIE92ZXJ2aWV3OiBGQUlMVVJFIC0gc3BlY2lmaWMgc3VjY2VzcyBtZXNzYWdlIFwiQm9va2luZyBzZXNzaW9uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCIgTk9UIGRldGVjdGVkIik7CiAgICAgICAgICAgIGhhbmRsZU9wZXJhdGlvbkZhaWx1cmUoImJnZC1vdmVydmlldyIsIGVycm9yXzE5LnN0YXR1cywgdGVtcF8yNDUsIHRlbXBfMjQ2LCByZXN1bHRfMTQsIGVsZW1lbnRfMTU5LCAiT3ZlcnZpZXciKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoICh2YXJfMjU3KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgT3ZlcnZpZXcgc2Vzc2lvbiBjcmVhdGU6IiwgdmFyXzI1Nyk7CiAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgdXBkYXRlQnV0dG9uTG9hZGluZyhlbGVtZW50XzE1OSk7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHJlc2V0QnV0dG9uU3RhdGUoZWxlbWVudF8xNTkpLCAzMDAwKTsKICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgiYmdkLW92ZXJ2aWV3IiwgbnVsbCwgdGVtcF8yNDUsIHsKICAgICAgICAgICAgaXNOZXR3b3JrRXJyb3I6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICBldmVudEhhbmRsZXJfMTc4KCJwYXktb3RwLWJ0biIsICJjbGljayIsIGFzeW5jIGZ1bmN0aW9uIChwYXJhbV8yNikgewogICAgICAgIGNvbnN0IHRlbXBfMjUxID0gInNlbmQiOwogICAgICAgIHZhcl8yMzEodGVtcF8yNTEpOwogICAgICAgIGNvbnN0IHRlbXBfMjUyID0gdGhpcy5pZDsKICAgICAgICB2YXJfNTYoKTsKICAgICAgICBjb25zdCB0ZW1wXzI1MyA9IGVkaXRlZEVuZHBvaW50c1t0ZW1wXzI1Ml07CiAgICAgICAgaWYgKHRlbXBfMjUzKSB7CiAgICAgICAgICBhc3luY1Jlc3VsdF8yNTgodGVtcF8yNTMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhc3luY1Jlc3VsdF8yNTgoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBhc3luYyBmdW5jdGlvbiBhc3luY1Jlc3VsdF8yNTgoYXN5bmNSZXN1bHRfMjU5ID0gbnVsbCkgewogICAgICAgIHZhcl8xMjgoKTsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiVHJ5IEdldCBPVFAgRnJvbSBTZXJ2ZXIiLCAiI0ZGRDcwMCIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTYwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheS1vdHAtYnRuIik7CiAgICAgICAgY29uc3QgdGVtcF8yNTQgPSAoKSA9PiBhc3luY1Jlc3VsdF8yNTgoYXN5bmNSZXN1bHRfMjU5KTsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgZGVsYXlfNDcgPSBhd2FpdCBhc3luY1Jlc3VsdF8xMjkoKTsKICAgICAgICAgIGNvbnN0IHRleHRfNDQgPSBbMCwgZGVsYXlfNDddOwogICAgICAgICAgY29uc3QgdGV4dF80NSA9IEpTT04uc3RyaW5naWZ5KHRleHRfNDQpOwogICAgICAgICAgY29uc29sZS5sb2coIlNlbmQgT1RQIHBheWxvYWQgcHJlcGFyZWQ6IiwgdGV4dF80NSk7CiAgICAgICAgICBjb25zdCBkZWxheV80OCA9IGFzeW5jUmVzdWx0XzI1OSB8fCBkYXRldGltZV8xMzAoInBheU90cFNlbnQiKTsKICAgICAgICAgIGNvbnN0IGVycm9yXzIwID0gYXdhaXQgZmV0Y2goZGVsYXlfNDgsIHsKICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAuLi5jcmVhdGVOZXh0QWN0aW9uSGVhZGVycyhuZXh0QWN0aW9uQ29uZmlnLnNlbmRPdHBJbmZvKQogICAgICAgICAgICB9LAogICAgICAgICAgICBjcmVkZW50aWFsczogImluY2x1ZGUiLAogICAgICAgICAgICByZWZlcnJlcjogImh0dHBzOi8vcGF5bWVudC5pdmFjYmQuY29tL2FwcGxpY2F0aW9uIiwKICAgICAgICAgICAgcmVmZXJyZXJQb2xpY3k6ICJzYW1lLW9yaWdpbiIsCiAgICAgICAgICAgIGJvZHk6IHRleHRfNDUKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKCFlcnJvcl8yMC5vaykgewogICAgICAgICAgICBjb25zb2xlLmxvZygiUmVxdWVzdCBmYWlsZWQgd2l0aCBzdGF0dXMgIiArIGVycm9yXzIwLnN0YXR1cyk7CiAgICAgICAgICAgIGhhbmRsZUF1dG9TZXF1ZW5jZUVycm9yKGVycm9yXzIwLnN0YXR1cyk7CiAgICAgICAgICAgIGlmIChlcnJvcl8yMC5zdGF0dXMgPT09IDUwMCB8fCBlcnJvcl8yMC5zdGF0dXMgPT09IDUwMiB8fCBlcnJvcl8yMC5zdGF0dXMgPT09IDUwNCkgewogICAgICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdXBkYXRlQnV0dG9uTG9hZGluZyhlbGVtZW50XzE2MCk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzZXRCdXR0b25TdGF0ZShlbGVtZW50XzE2MCksIDMwMDApOwogICAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoInBheS1zZW5kIiwgZXJyb3JfMjAuc3RhdHVzLCB0ZW1wXzI1NCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHJlc3VsdF8xNSA9IGF3YWl0IGVycm9yXzIwLnRleHQoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJTZW5kIE9UUCByYXcgcmVzcG9uc2U6IiwgcmVzdWx0XzE1KTsKICAgICAgICAgIGNvbnN0IGNvdW50XzMzID0gcmVzdWx0XzE1LnNwbGl0KC9ccj9cbi8pLm1hcChwYXJhbV8yNyA9PiBwYXJhbV8yNy50cmltKCkpLmZpbHRlcihCb29sZWFuKTsKICAgICAgICAgIGxldCB0ZW1wXzI1NSA9IG51bGw7CiAgICAgICAgICBmb3IgKGxldCBjb3VudF8zNCA9IDA7IGNvdW50XzM0IDwgY291bnRfMzMubGVuZ3RoOyBjb3VudF8zNCsrKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMjU2ID0gY291bnRfMzNbY291bnRfMzRdOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGxldCB0ZW1wXzI1NyA9IHRlbXBfMjU2OwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfMjU4ID0gdGVtcF8yNTYuaW5kZXhPZigiOiIpOwogICAgICAgICAgICAgIGlmICh0ZW1wXzI1OCA-IC0xICYmIHRlbXBfMjU2W3RlbXBfMjU4ICsgMV0gPT09ICJ7IikgewogICAgICAgICAgICAgICAgdGVtcF8yNTcgPSB0ZW1wXzI1Ni5zbGljZSh0ZW1wXzI1OCArIDEpLnRyaW0oKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8yNTkgPSBKU09OLnBhcnNlKHRlbXBfMjU3KTsKICAgICAgICAgICAgICBpZiAodHlwZW9mIHRlbXBfMjU5ID09PSAib2JqZWN0IiAmJiB0ZW1wXzI1OSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWYgKHRlbXBfMjU5Lm1lc3NhZ2UgfHwgdGVtcF8yNTkuc3RhdHVzIHx8IHRlbXBfMjU5LnN0YXR1c19jb2RlKSB7CiAgICAgICAgICAgICAgICAgIHRlbXBfMjU1ID0gdGVtcF8yNTk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJTZW5kIE9UUCBwYXJzZWQgbGluZSAiICsgY291bnRfMzQgKyAiOiIsIHRlbXBfMjU1KTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIXRlbXBfMjU1KSB7CiAgICAgICAgICAgICAgICAgIHRlbXBfMjU1ID0gdGVtcF8yNTk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoICh2YXJfMjYwKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICghdGVtcF8yNTUpIHsKICAgICAgICAgICAgdGVtcF8yNTUgPSB2YXJfMTM4KHJlc3VsdF8xNSwgewogICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICBsYWJlbDogIlNlbmQgT1RQIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKCJTZW5kIE9UUCBmaW5hbCBwYXJzZWQgcGF5bG9hZDoiLCB0ZW1wXzI1NSk7CiAgICAgICAgICBpZiAoIXRlbXBfMjU1KSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gcGFyc2Ugc2VuZCBPVFAgcmVzcG9uc2UgcGF5bG9hZCIpOwogICAgICAgICAgICBoYW5kbGVPcGVyYXRpb25GYWlsdXJlKCJwYXktc2VuZCIsIGVycm9yXzIwLnN0YXR1cywgdGVtcF8yNTQsIG51bGwsIHJlc3VsdF8xNSwgZWxlbWVudF8xNjAsICJQYXltZW50IE9UUCIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB0ZW1wXzI2MCA9IG91dGNvbWVfMTM5KHRlbXBfMjU1LCByZXN1bHRfMTUsICJTbXMgc2VuZCBzdWNjZXNzZnVsbHkiKTsKICAgICAgICAgIGlmICh0ZW1wXzI2MCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiUGF5bWVudCBvdHAgc2VuZCBTdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKHRlbXBfMjU1LCAiUGF5bWVudCBPVFAiLCByZXN1bHRfMTUsICJQYXltZW50IG90cCBzZW5kIFN1Y2Nlc3NmdWxseSIsICJQYXltZW50IE9UUCBGYWlsZWQiKTsKICAgICAgICAgICAgdmFyXzg5KGVsZW1lbnRfMTYwKTsKICAgICAgICAgICAgdmFyXzgwKCk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzZXRCdXR0b25TdGF0ZShlbGVtZW50XzE2MCksIDMwMDApOwogICAgICAgICAgICBkYXRldGltZV8xMDgoImJnZC1vdHAtdGltZXItZGlzcGxheSIsIDMpOwogICAgICAgICAgICBjb25zdCBlbGVtZW50XzE2MSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXNlbmQtcGF5LW90cC1idG4iKTsKICAgICAgICAgICAgaWYgKGVsZW1lbnRfMTYxKSB7CiAgICAgICAgICAgICAgZWxlbWVudF8xNjEuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgZWxlbWVudF8xNjEuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJSZXNlbmQgYnV0dG9uIGVuYWJsZWQiLCAiIzRDQUY1MCIpOwogICAgICAgICAgICAgIH0sIDMwMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkZXRlY3RNYW51YWxCdXR0b25TdWNjZXNzKCJwYXktb3RwLWJ0biIpOwogICAgICAgICAgICB2YXJfNjIoInNlbmQiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinYwgU2VuZCBPVFA6IEZBSUxVUkUgLSBzcGVjaWZpYyBzdWNjZXNzIG1lc3NhZ2UgXCJTbXMgc2VuZCBzdWNjZXNzZnVsbHlcIiBOT1QgZGV0ZWN0ZWQiKTsKICAgICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgicGF5LXNlbmQiLCBlcnJvcl8yMC5zdGF0dXMsIHRlbXBfMjU0LCB0ZW1wXzI1NSwgcmVzdWx0XzE1LCBlbGVtZW50XzE2MCwgIlBheW1lbnQgT1RQIik7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAodmFyXzI2MSkgewogICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIHBheW1lbnQgb3RwIHNlbmQ6IiwgdmFyXzI2MSk7CiAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgdXBkYXRlQnV0dG9uTG9hZGluZyhlbGVtZW50XzE2MCk7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHJlc2V0QnV0dG9uU3RhdGUoZWxlbWVudF8xNjApLCAzMDAwKTsKICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LXNlbmQiLCBudWxsLCB0ZW1wXzI1NCwgewogICAgICAgICAgICBpc05ldHdvcmtFcnJvcjogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGV2ZW50SGFuZGxlcl8xNzgoInJlc2VuZC1wYXktb3RwLWJ0biIsICJjbGljayIsIGFzeW5jIGZ1bmN0aW9uIChwYXJhbV8yOCkgewogICAgICAgIGNvbnN0IHRlbXBfMjYxID0gInJlc2VuZCI7CiAgICAgICAgdmFyXzIzMSh0ZW1wXzI2MSk7CiAgICAgICAgdmFyXzU2KCk7CiAgICAgICAgY29uc3QgdGVtcF8yNjIgPSB0aGlzLmlkOwogICAgICAgIGNvbnN0IHRlbXBfMjYzID0gZWRpdGVkRW5kcG9pbnRzW3RlbXBfMjYyXTsKICAgICAgICBpZiAodGVtcF8yNjMpIHsKICAgICAgICAgIGFzeW5jUmVzdWx0XzI2Mih0ZW1wXzI2Myk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFzeW5jUmVzdWx0XzI2MigpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGFzeW5jIGZ1bmN0aW9uIGFzeW5jUmVzdWx0XzI2Mihhc3luY1Jlc3VsdF8yNjMgPSBudWxsKSB7CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlRyeSBUbyBHZXQgMm5kIE9UUCBGcm9tIFNlcnZlciIsICIjRkZENzAwIik7CiAgICAgICAgY29uc3QgZWxlbWVudF8xNjIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVzZW5kLXBheS1vdHAtYnRuIik7CiAgICAgICAgY29uc3QgdGVtcF8yNjQgPSAoKSA9PiBhc3luY1Jlc3VsdF8yNjIoYXN5bmNSZXN1bHRfMjYzKTsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgdGVtcF8yNjUgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7CiAgICAgICAgICBwZW5kaW5nT3BlcmF0aW9ucy5wdXNoKHRlbXBfMjY1KTsKICAgICAgICAgIGNvbnN0IGNvbmZpZ181ID0gewogICAgICAgICAgICByZXNlbmQ6ICIxIgogICAgICAgICAgfTsKICAgICAgICAgIGlmIChjYXB0Y2hhUHJvdmlkZXJDb25maWcuYmdkLmVuYWJsZWQgJiYgY2FwdGNoYVByb3ZpZGVyQ29uZmlnLmJnZC50b2tlbikgewogICAgICAgICAgICB2YXJfMTkyKGNvbmZpZ181LCBjYXB0Y2hhUHJvdmlkZXJDb25maWcuYmdkLnRva2VuLCBjYXB0Y2hhVG9rZW5OYW1lcy5zZW5kKTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IGRlbGF5XzQ5ID0gYXN5bmNSZXN1bHRfMjYzIHx8IGRhdGV0aW1lXzEzMCgicGF5T3RwU2VudCIpOwogICAgICAgICAgY29uc3QgZXJyb3JfMjEgPSBhd2FpdCBmZXRjaChkZWxheV80OSwgewogICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiICsgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImFjY2Vzc190b2tlbiIpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlZmVycmVyOiAiL2FwcGxpY2F0aW9uIiwKICAgICAgICAgICAgY3JlZGVudGlhbHM6ICJpbmNsdWRlIiwKICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoY29uZmlnXzUpLAogICAgICAgICAgICBzaWduYWw6IHRlbXBfMjY1LnNpZ25hbAogICAgICAgICAgfSk7CiAgICAgICAgICBwZW5kaW5nT3BlcmF0aW9ucyA9IHBlbmRpbmdPcGVyYXRpb25zLmZpbHRlcihwYXJhbV8yOSA9PiBwYXJhbV8yOSAhPT0gdGVtcF8yNjUpOwogICAgICAgICAgaWYgKCFlcnJvcl8yMS5vaykgewogICAgICAgICAgICBjb25zb2xlLmxvZygiUmVxdWVzdCBmYWlsZWQgd2l0aCBzdGF0dXMgIiArIGVycm9yXzIxLnN0YXR1cyk7CiAgICAgICAgICAgIGhhbmRsZUF1dG9TZXF1ZW5jZUVycm9yKGVycm9yXzIxLnN0YXR1cyk7CiAgICAgICAgICAgIGlmIChlcnJvcl8yMS5zdGF0dXMgPT09IDUwMCB8fCBlcnJvcl8yMS5zdGF0dXMgPT09IDUwMiB8fCBlcnJvcl8yMS5zdGF0dXMgPT09IDUwNCkgewogICAgICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdXBkYXRlQnV0dG9uTG9hZGluZyhlbGVtZW50XzE2Mik7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gcmVzZXRCdXR0b25TdGF0ZShlbGVtZW50XzE2MiksIDMwMDApOwogICAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoInBheS1yZXNlbmQiLCBlcnJvcl8yMS5zdGF0dXMsIHRlbXBfMjY0KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgYnV0dG9uXzE1ID0gYXdhaXQgZXJyb3JfMjEuanNvbigpOwogICAgICAgICAgY29uc3QgYnV0dG9uXzE2ID0gSlNPTi5zdHJpbmdpZnkoYnV0dG9uXzE1KTsKICAgICAgICAgIGNvbnN0IGRhdGFfMjkgPSBvdXRjb21lXzEzOShidXR0b25fMTUsIGJ1dHRvbl8xNiwgIlNtcyBzZW5kIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgaWYgKGRhdGFfMjkgJiYgYnV0dG9uXzE1Py5kYXRhKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXNlbmQgUGF5bWVudCBvdHAgc2VuZCBTdWNjZXNzZnVsbHkiKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKGJ1dHRvbl8xNSwgIlJlc2VuZCBQYXltZW50IE9UUCIsIGJ1dHRvbl8xNiwgIlJlc2VuZCBQYXltZW50IG90cCBzZW5kIFN1Y2Nlc3NmdWxseSIsICJSZXNlbmQgUGF5bWVudCBPVFAgRmFpbGVkIik7CiAgICAgICAgICAgIHZhcl84OShlbGVtZW50XzE2Mik7CiAgICAgICAgICAgIHZhcl84MCgpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHJlc2V0QnV0dG9uU3RhdGUoZWxlbWVudF8xNjIpLCAzMDAwKTsKICAgICAgICAgICAgZGF0ZXRpbWVfMTA4KCJiZ2Qtb3RwLXRpbWVyLWRpc3BsYXkiLCAzKTsKICAgICAgICAgICAgdmFyXzYyKCJyZXNlbmQiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXNlbmQgT1RQOiBGYWlsdXJlIGRldGVjdGVkIC0gcmV0cnlpbmciKTsKICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKGJ1dHRvbl8xNSwgIlJlc2VuZCBQYXltZW50IE9UUCIsIGJ1dHRvbl8xNiwgIlJlc2VuZCBQYXltZW50IG90cCBzZW5kIFN1Y2Nlc3NmdWxseSIsICJSZXNlbmQgUGF5bWVudCBPVFAgRmFpbGVkIik7CiAgICAgICAgICAgIHVwZGF0ZUJ1dHRvbkxvYWRpbmcoZWxlbWVudF8xNjIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHJlc2V0QnV0dG9uU3RhdGUoZWxlbWVudF8xNjIpLCAzMDAwKTsKICAgICAgICAgICAgaWYgKGF1dG9SZXRyeVN0YXRlLmVuYWJsZWQpIHsKICAgICAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoInBheS1yZXNlbmQiLCBudWxsLCB0ZW1wXzI2NCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoICh2YXJfMjY0KSB7CiAgICAgICAgICBpZiAodmFyXzI2NC5uYW1lID09PSAiQWJvcnRFcnJvciIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJlcXVlc3QgYWJvcnRlZCIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIHBheW1lbnQgb3RwIHJlc2VuZCIpOwogICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICB1cGRhdGVCdXR0b25Mb2FkaW5nKGVsZW1lbnRfMTYyKTsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNldEJ1dHRvblN0YXRlKGVsZW1lbnRfMTYyKSwgMzAwMCk7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LXJlc2VuZCIsIG51bGwsIHRlbXBfMjY0LCB7CiAgICAgICAgICAgICAgaXNOZXR3b3JrRXJyb3I6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGV2ZW50SGFuZGxlcl8xNzgoInBheS12ZXJpZnktYnRuIiwgImNsaWNrIiwgYXN5bmMgZnVuY3Rpb24gKHBhcmFtXzMwKSB7CiAgICAgICAgY29uc3QgdGVtcF8yNjYgPSAidmVyaWZ5IjsKICAgICAgICB2YXJfMjMxKHRlbXBfMjY2KTsKICAgICAgICBjb25zdCB0ZW1wXzI2NyA9IHRoaXMuaWQ7CiAgICAgICAgdmFyXzU2KCk7CiAgICAgICAgY29uc3QgdGVtcF8yNjggPSBlZGl0ZWRFbmRwb2ludHNbdGVtcF8yNjddOwogICAgICAgIGlmICh0ZW1wXzI2OCkgewogICAgICAgICAgYXN5bmNSZXN1bHRfMjY1KHRlbXBfMjY4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXN5bmNSZXN1bHRfMjY1KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgZXZlbnRIYW5kbGVyXzE3OCgiY2YtYnRuLXBheW5vdy1yb3ciLCAiY2xpY2siLCBldmVudEhhbmRsZXJfMTMyKTsKICAgICAgZXZlbnRIYW5kbGVyXzE3OCgicGF5LWNhcHRjaGEtdmVyaWZ5LWJ0biIsICJjbGljayIsIGFzeW5jUmVzdWx0XzE0Myk7CiAgICAgIGV2ZW50SGFuZGxlcl8xNzgoInBheS1jYXB0Y2hhLWNzLWJ0biIsICJjbGljayIsIGFzeW5jUmVzdWx0XzE0NSk7CiAgICAgIGFzeW5jIGZ1bmN0aW9uIGFzeW5jUmVzdWx0XzI2NShhc3luY1Jlc3VsdF8yNjYgPSBudWxsKSB7CiAgICAgICAgdmFyXzEyOCgpOwogICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJUcnkgVG8gU3VibWl0IFBheW1lbnQgT1RQIiwgIiNGRkQ3MDAiKTsKICAgICAgICBjb25zdCBlbGVtZW50XzE2MyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktdmVyaWZ5LWJ0biIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTY0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheW1lbnQtb3RwIik7CiAgICAgICAgaWYgKCFlbGVtZW50XzE2NCkgewogICAgICAgICAgY29uc29sZS5sb2coIlBheW1lbnQgT1RQIGlucHV0IG5vdCBmb3VuZCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCB0ZW1wXzI2OSA9IGVsZW1lbnRfMTY0LnZhbHVlLnRyaW0oKTsKICAgICAgICBpZiAoIXRlbXBfMjY5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiT3RwIGNvZGUgaXMgcmVxdWlyZWQiKTsKICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJPVFAgY29kZSBpcyByZXF1aXJlZCIsICIjZmY0NDQ0Iik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IHRlbXBfMjcwID0gKCkgPT4gYXN5bmNSZXN1bHRfMjY1KGFzeW5jUmVzdWx0XzI2Nik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IGRlbGF5XzUwID0gYXdhaXQgYXN5bmNSZXN1bHRfMTI5KCk7CiAgICAgICAgICBjb25zdCB0ZXh0XzQ2ID0gW3RlbXBfMjY5LCBkZWxheV81MF07CiAgICAgICAgICBjb25zdCB0ZXh0XzQ3ID0gSlNPTi5zdHJpbmdpZnkodGV4dF80Nik7CiAgICAgICAgICBjb25zb2xlLmxvZygiVmVyaWZ5IE9UUCBwYXlsb2FkIHByZXBhcmVkOiIsIHRleHRfNDcpOwogICAgICAgICAgY29uc3QgZGVsYXlfNTEgPSBhc3luY1Jlc3VsdF8yNjYgfHwgZGF0ZXRpbWVfMTMwKCJwYXlPdHBWZXJpZnkiKTsKICAgICAgICAgIGNvbnN0IGVycm9yXzIyID0gYXdhaXQgZmV0Y2goZGVsYXlfNTEsIHsKICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAuLi5jcmVhdGVOZXh0QWN0aW9uSGVhZGVycyhuZXh0QWN0aW9uQ29uZmlnLnZlcmlmeU90cEluZm8pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAiaW5jbHVkZSIsCiAgICAgICAgICAgIHJlZmVycmVyOiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgICAgICAgICByZWZlcnJlclBvbGljeTogInNhbWUtb3JpZ2luIiwKICAgICAgICAgICAgYm9keTogdGV4dF80NwogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIWVycm9yXzIyLm9rKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyAiICsgZXJyb3JfMjIuc3RhdHVzKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1NlcXVlbmNlRXJyb3IoZXJyb3JfMjIuc3RhdHVzKTsKICAgICAgICAgICAgaWYgKGVycm9yXzIyLnN0YXR1cyA9PT0gNTAwIHx8IGVycm9yXzIyLnN0YXR1cyA9PT0gNTAyIHx8IGVycm9yXzIyLnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cGRhdGVCdXR0b25Mb2FkaW5nKGVsZW1lbnRfMTYzKTsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNldEJ1dHRvblN0YXRlKGVsZW1lbnRfMTYzKSwgMzAwMCk7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LXZlcmlmeSIsIGVycm9yXzIyLnN0YXR1cywgdGVtcF8yNzApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCByZXN1bHRfMTYgPSBhd2FpdCBlcnJvcl8yMi50ZXh0KCk7CiAgICAgICAgICBjb25zb2xlLmxvZygiVmVyaWZ5IE9UUCByYXcgcmVzcG9uc2U6IiwgcmVzdWx0XzE2KTsKICAgICAgICAgIGNvbnN0IGNvdW50XzM1ID0gcmVzdWx0XzE2LnNwbGl0KC9ccj9cbi8pOwogICAgICAgICAgbGV0IHRlbXBfMjcxID0gbnVsbDsKICAgICAgICAgIGlmIChjb3VudF8zNS5sZW5ndGggPj0gMikgewogICAgICAgICAgICBjb25zdCB0ZW1wXzI3MiA9IGNvdW50XzM1WzFdLnRyaW0oKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIlZlcmlmeSBPVFAgbGluZSAxOiIsIHRlbXBfMjcyKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBsZXQgdGVtcF8yNzMgPSB0ZW1wXzI3MjsKICAgICAgICAgICAgICBjb25zdCB0ZW1wXzI3NCA9IHRlbXBfMjcyLmluZGV4T2YoIjoiKTsKICAgICAgICAgICAgICBpZiAodGVtcF8yNzQgPiAtMSkgewogICAgICAgICAgICAgICAgdGVtcF8yNzMgPSB0ZW1wXzI3Mi5zbGljZSh0ZW1wXzI3NCArIDEpLnRyaW0oKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdGVtcF8yNzEgPSBKU09OLnBhcnNlKHRlbXBfMjczKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiVmVyaWZ5IE9UUCBwYXJzZWQgbGluZSAxOiIsIHRlbXBfMjcxKTsKICAgICAgICAgICAgfSBjYXRjaCAoanNvbkRhdGFfMjY3KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBwYXJzZSBsaW5lIDE6IiwganNvbkRhdGFfMjY3KTsKICAgICAgICAgICAgICB0ZW1wXzI3MSA9IHZhcl8xMzgocmVzdWx0XzE2LCB7CiAgICAgICAgICAgICAgICBwcmVmZXJTdGF0dXNPYmplY3Q6IHRydWUsCiAgICAgICAgICAgICAgICBsYWJlbDogIlZlcmlmeSBPVFAiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRlbXBfMjcxID0gdmFyXzEzOChyZXN1bHRfMTYsIHsKICAgICAgICAgICAgICBwcmVmZXJTdGF0dXNPYmplY3Q6IHRydWUsCiAgICAgICAgICAgICAgbGFiZWw6ICJWZXJpZnkgT1RQIgogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKCJWZXJpZnkgT1RQIGZpbmFsIHBhcnNlZCBwYXlsb2FkOiIsIHRlbXBfMjcxKTsKICAgICAgICAgIGlmICghdGVtcF8yNzEpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlVuYWJsZSB0byBwYXJzZSB2ZXJpZnkgT1RQIHJlc3BvbnNlIHBheWxvYWQiKTsKICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKG51bGwsICJWZXJpZnkgT1RQIiwgcmVzdWx0XzE2LCAiVmVyaWZ5IE9UUCBTdWNjZXNzIiwgIlZlcmlmeSBPVFAgRmFpbGVkIik7CiAgICAgICAgICAgIHVwZGF0ZUJ1dHRvbkxvYWRpbmcoZWxlbWVudF8xNjMpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHJlc2V0QnV0dG9uU3RhdGUoZWxlbWVudF8xNjMpLCAzMDAwKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJwYXktdmVyaWZ5IiwgbnVsbCwgdGVtcF8yNzApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBkYXRhXzMwID0gdGVtcF8yNzE_LmRhdGEgJiYgQXJyYXkuaXNBcnJheSh0ZW1wXzI3MS5kYXRhPy5zbG90X2RhdGVzKSAmJiB0ZW1wXzI3MS5kYXRhLnNsb3RfZGF0ZXMubGVuZ3RoID4gMDsKICAgICAgICAgIGNvbnN0IGRhdGFfMzEgPSBkYXRhXzMwICYmIHRlbXBfMjcxLmRhdGEuc2xvdF9kYXRlc1swXSA9PT0gIiI7CiAgICAgICAgICBjb25zdCB0ZW1wXzI3NSA9IG91dGNvbWVfMTM5KHRlbXBfMjcxLCByZXN1bHRfMTYsICJTbG90IERhdGUgRm91bmQgWVlZWS1NTS1ERCIpOwogICAgICAgICAgY29uc3QgdGVtcF8yNzYgPSBkYXRhXzMwIHx8IHRlbXBfMjc1OwogICAgICAgICAgaWYgKHRlbXBfMjc2KSB7CiAgICAgICAgICAgIGNvbnN0IGRhdGFfMzIgPSBkYXRhXzMwID8gdGVtcF8yNzEuZGF0YS5zbG90X2RhdGVzWzBdIDogbnVsbDsKICAgICAgICAgICAgaWYgKGRhdGFfMzIgJiYgZGF0YV8zMiAhPT0gIiIpIHsKICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgicGF5bWVudF9kYXRlIiwgZGF0YV8zMik7CiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xNjUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXBwb2ludG1lbnRfZGF0ZSIpOwogICAgICAgICAgICAgIGlmIChlbGVtZW50XzE2NSkgewogICAgICAgICAgICAgICAgZWxlbWVudF8xNjUudmFsdWUgPSBkYXRhXzMyOwogICAgICAgICAgICAgICAgdmFyXzE0MSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb25zb2xlLmxvZygi4pyFIFZlcmlmeSBPVFAgU3VjY2VzcyAtIERhdGUgRm91bmQ6ICIgKyBkYXRhXzMyKTsKICAgICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXModGVtcF8yNzEsICJWZXJpZnkgT1RQIiwgcmVzdWx0XzE2LCAiRGF0ZSBGb3VuZCAiICsgZGF0YV8zMiwgIlZlcmlmeSBPVFAgRmFpbGVkIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YV8zMSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgVmVyaWZ5IE9UUCBTdWNjZXNzIC0gT1RQIFZlcmlmaWVkIChzbG90X2RhdGVzIHdpdGggZW1wdHkgZGF0ZSAtIHRyZWF0ZWQgYXMgc3VjY2VzcykiKTsKICAgICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXModGVtcF8yNzEsICJWZXJpZnkgT1RQIiwgcmVzdWx0XzE2LCAiT1RQIFZlcmlmaWVkIFN1Y2Nlc3NmdWxseSIsICJWZXJpZnkgT1RQIEZhaWxlZCIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgVmVyaWZ5IE9UUCBTdWNjZXNzIC0gT1RQIFZlcmlmaWVkIChzbG90X2RhdGVzIGV4aXN0cykiKTsKICAgICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXModGVtcF8yNzEsICJWZXJpZnkgT1RQIiwgcmVzdWx0XzE2LCAiT1RQIFZlcmlmaWVkIFN1Y2Nlc3NmdWxseSIsICJWZXJpZnkgT1RQIEZhaWxlZCIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhcl84OShlbGVtZW50XzE2Myk7CiAgICAgICAgICAgIHZhcl84MigpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHJlc2V0QnV0dG9uU3RhdGUoZWxlbWVudF8xNjMpLCAzMDAwKTsKICAgICAgICAgICAgZGF0ZXRpbWVfMTA4KCJwYXktdGltZXItZGlzcGxheSIsIDEwKTsKICAgICAgICAgICAgdmFyXzYyKCJ2ZXJpZnkiKTsKICAgICAgICAgICAgaWYgKGF1dG9SZXRyeVN0YXRlLmVuYWJsZWQgJiYgYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgQXV0byBPTiBhbmQgQVMgT04gZW5hYmxlZCAtIEF1dG8gc3dpdGNoaW5nIHRvIFBheSBUYWIiKTsKICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogVmVyaWZ5IE9UUCBzdWNjZXNzLCBhdXRvIHN3aXRjaGluZyB0byBQYXkgVGFiIiwgIiMwMEZGMDAiKTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0-IHsKICAgICAgICAgICAgICAgIGNsaWNrQnV0dG9uKCJwYXkiKTsKICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkZXRlY3RNYW51YWxCdXR0b25TdWNjZXNzKCJwYXktdmVyaWZ5LWJ0biIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIuKdjCBWZXJpZnkgT1RQOiBGQUlMVVJFIC0gc2xvdF9kYXRlcyBhcnJheSBub3QgZm91bmQgb3IgZW1wdHksIGFuZCBtZXNzYWdlIHBhdHRlcm4gbm90IGRldGVjdGVkIik7CiAgICAgICAgICAgIGhhbmRsZU9wZXJhdGlvbkZhaWx1cmUoInBheS12ZXJpZnkiLCBlcnJvcl8yMi5zdGF0dXMsIHRlbXBfMjcwLCB0ZW1wXzI3MSwgcmVzdWx0XzE2LCBlbGVtZW50XzE2MywgIlZlcmlmeSBPVFAiKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChkYXRldGltZV8yNjgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBEYXRlIG5vdCBmb3VuZDoiLCBkYXRldGltZV8yNjgpOwogICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgicGF5LXZlcmlmeSIsIG51bGwsIHRlbXBfMjcwLCBudWxsLCAiIiwgZWxlbWVudF8xNjMsICJWZXJpZnkgT1RQIik7CiAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoInBheS12ZXJpZnkiLCBudWxsLCB0ZW1wXzI3MCwgewogICAgICAgICAgICBpc05ldHdvcmtFcnJvcjogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGV2ZW50SGFuZGxlcl8xNzgoImdldC10aW1lLXNsb3QtYnRuIiwgImNsaWNrIiwgYXN5bmMgZnVuY3Rpb24gKHBhcmFtXzMxKSB7CiAgICAgICAgY29uc3QgdGVtcF8yNzcgPSAicGF5bm93IjsKICAgICAgICB2YXJfMjMxKHRlbXBfMjc3KTsKICAgICAgICBjb25zdCB0ZW1wXzI3OCA9IHRoaXMuaWQ7CiAgICAgICAgdmFyXzU2KCk7CiAgICAgICAgY29uc3QgdGVtcF8yNzkgPSBlZGl0ZWRFbmRwb2ludHNbdGVtcF8yNzhdOwogICAgICAgIGlmICh0ZW1wXzI3OSkgewogICAgICAgICAgYXN5bmNSZXN1bHRfMjY5KHRlbXBfMjc5KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXN5bmNSZXN1bHRfMjY5KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgYXN5bmMgZnVuY3Rpb24gYXN5bmNSZXN1bHRfMjY5KGFzeW5jUmVzdWx0XzI3MCA9IG51bGwpIHsKICAgICAgICB2YXJfMTI4KCk7CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlRyeSBUbyBSZXRyaXZlIFRpbWUgU2xvdCIsICIjRkZENzAwIik7CiAgICAgICAgY29uc3QgZWxlbWVudF8xNjYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXBwb2ludG1lbnRfZGF0ZSIpOwogICAgICAgIGlmICghZWxlbWVudF8xNjYpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJBcHBvaW50bWVudCBkYXRlIGlucHV0IG5vdCBmb3VuZCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCB0ZW1wXzI4MCA9IGVsZW1lbnRfMTY2LnZhbHVlLnRyaW0oKTsKICAgICAgICBpZiAoIXRlbXBfMjgwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQXBwb2ludG1lbnQgZGF0ZSBpcyByZXF1aXJlZCIpOwogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkFwcG9pbnRtZW50IGRhdGUgaXMgcmVxdWlyZWQiLCAiI2ZmNDQ0NCIpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsb2dpbkNhcHRjaGFXaWRnZXQgPSB0ZW1wXzI4MDsKICAgICAgICBjb25zdCB0ZW1wXzI4MSA9ICgpID0-IGFzeW5jUmVzdWx0XzI2OShhc3luY1Jlc3VsdF8yNzApOwogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBkZWxheV81MiA9IGF3YWl0IGFzeW5jUmVzdWx0XzEyOSgpOwogICAgICAgICAgY29uc3QgdGV4dF80OCA9IFt0ZW1wXzI4MCwgZGVsYXlfNTJdOwogICAgICAgICAgY29uc3QgdGV4dF80OSA9IEpTT04uc3RyaW5naWZ5KHRleHRfNDgpOwogICAgICAgICAgY29uc29sZS5sb2coIkdldCBTbG90IHBheWxvYWQgcHJlcGFyZWQ6IiwgdGV4dF80OSk7CiAgICAgICAgICBjb25zdCBkZWxheV81MyA9IGFzeW5jUmVzdWx0XzI3MCB8fCBkYXRldGltZV8xMzAoInBheVNsb3RUaW1lIik7CiAgICAgICAgICBjb25zdCBlcnJvcl8yMyA9IGF3YWl0IGZldGNoKGRlbGF5XzUzLCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgLi4uY3JlYXRlTmV4dEFjdGlvbkhlYWRlcnMobmV4dEFjdGlvbkNvbmZpZy5nZXRTbG90SW5mbykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY3JlZGVudGlhbHM6ICJpbmNsdWRlIiwKICAgICAgICAgICAgcmVmZXJyZXI6ICJodHRwczovL3BheW1lbnQuaXZhY2JkLmNvbS9hcHBsaWNhdGlvbiIsCiAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiAic2FtZS1vcmlnaW4iLAogICAgICAgICAgICBib2R5OiB0ZXh0XzQ5CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmICghZXJyb3JfMjMub2spIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlJlcXVlc3QgZmFpbGVkIHdpdGggc3RhdHVzICIgKyBlcnJvcl8yMy5zdGF0dXMpOwogICAgICAgICAgICBoYW5kbGVBdXRvU2VxdWVuY2VFcnJvcihlcnJvcl8yMy5zdGF0dXMpOwogICAgICAgICAgICBpZiAoZXJyb3JfMjMuc3RhdHVzID09PSA1MDAgfHwgZXJyb3JfMjMuc3RhdHVzID09PSA1MDIgfHwgZXJyb3JfMjMuc3RhdHVzID09PSA1MDQpIHsKICAgICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LWdldC1zbG90IiwgZXJyb3JfMjMuc3RhdHVzLCB0ZW1wXzI4MSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHJlc3VsdF8xNyA9IGF3YWl0IGVycm9yXzIzLnRleHQoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJHZXQgU2xvdCByYXcgcmVzcG9uc2U6IiwgcmVzdWx0XzE3KTsKICAgICAgICAgIGNvbnN0IHJlc3VsdF8xOCA9IHJlc3VsdF8xNy5zcGxpdCgvXHI_XG4vKTsKICAgICAgICAgIGxldCB0ZW1wXzI4MiA9IG51bGw7CiAgICAgICAgICBsZXQgZGF0YV8zMyA9IG51bGw7CiAgICAgICAgICBjb25zb2xlLmxvZygiVG90YWwgcmVzcG9uc2UgbGluZXM6IiwgcmVzdWx0XzE4Lmxlbmd0aCk7CiAgICAgICAgICBsZXQgdGVtcF8yODMgPSAtMTsKICAgICAgICAgIGxldCB0ZW1wXzI4NCA9IC0xOwogICAgICAgICAgbGV0IHRlbXBfMjg1ID0gLTE7CiAgICAgICAgICBmb3IgKGxldCBjb3VudF8zNiA9IDA7IGNvdW50XzM2IDwgcmVzdWx0XzE4Lmxlbmd0aDsgY291bnRfMzYrKykgewogICAgICAgICAgICBjb25zdCB0ZW1wXzI4NiA9IHJlc3VsdF8xOFtjb3VudF8zNl0udHJpbSgpOwogICAgICAgICAgICBpZiAoIXRlbXBfMjg2KSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRlbXBfMjg2LnN0YXJ0c1dpdGgoIjA6IikpIHsKICAgICAgICAgICAgICB0ZW1wXzI4MyA9IGNvdW50XzM2OwogICAgICAgICAgICB9IGVsc2UgaWYgKHRlbXBfMjg2LnN0YXJ0c1dpdGgoIjE6IikpIHsKICAgICAgICAgICAgICB0ZW1wXzI4NCA9IGNvdW50XzM2OwogICAgICAgICAgICB9IGVsc2UgaWYgKHRlbXBfMjg2LnN0YXJ0c1dpdGgoIjI6IikpIHsKICAgICAgICAgICAgICB0ZW1wXzI4NSA9IGNvdW50XzM2OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygiTGluZSBpbmRpY2VzIC0gMDoiLCB0ZW1wXzI4MywgIjE6IiwgdGVtcF8yODQsICIyOiIsIHRlbXBfMjg1KTsKICAgICAgICAgIGlmICh0ZW1wXzI4NSA-PSAwKSB7CiAgICAgICAgICAgIGNvbnN0IHRleHRfNTAgPSByZXN1bHRfMThbdGVtcF8yODVdLnRyaW0oKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIkdldCBTbG90IGxpbmUgMiBmb3VuZCBhdCBpbmRleCIsIHRlbXBfMjg1KTsKICAgICAgICAgICAgY29uc3QgZGF0YV8zNCA9IHRleHRfNTAuc3Vic3RyaW5nKDIpLnRyaW0oKTsKICAgICAgICAgICAgY29uc3QgZGF0YV8zNSA9IGRhdGFfMzQuaW5kZXhPZigiLCIpOwogICAgICAgICAgICBpZiAoZGF0YV8zNSA-IC0xKSB7CiAgICAgICAgICAgICAgY29uc3QgdGV4dF81MSA9IGRhdGFfMzQuc3Vic3RyaW5nKDAsIGRhdGFfMzUpLnRyaW0oKTsKICAgICAgICAgICAgICBpZiAodGV4dF81MS5pbmNsdWRlcygiLSIpICYmIHRleHRfNTEubGVuZ3RoID09PSAzNikgewogICAgICAgICAgICAgICAgbWF0aENhcHRjaGFXaWRnZXQgPSB0ZXh0XzUxOwogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImNhcHRjaGFfaWQiLCB0ZXh0XzUxKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDYXB0Y2hhIElEIGV4dHJhY3RlZCBmcm9tIGxpbmUgMjoiLCB0ZXh0XzUxKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGRhdGFfMzUgPiAtMSAmJiBkYXRhXzM0LmluY2x1ZGVzKCJkYXRhOmltYWdlL3BuZztiYXNlNjQsIikpIHsKICAgICAgICAgICAgICBjb25zdCBkYXRhXzM2ID0gZGF0YV8zNC5pbmRleE9mKCJkYXRhOmltYWdlL3BuZztiYXNlNjQsIik7CiAgICAgICAgICAgICAgaWYgKGRhdGFfMzYgPiAtMSkgewogICAgICAgICAgICAgICAgbGV0IHRleHRfNTIgPSBkYXRhXzM0LnN1YnN0cmluZyhkYXRhXzM2KTsKICAgICAgICAgICAgICAgIGNvbnN0IHRleHRfNTMgPSB0ZXh0XzUyLmluZGV4T2YoIjE6eyIpOwogICAgICAgICAgICAgICAgaWYgKHRleHRfNTMgPiAtMSkgewogICAgICAgICAgICAgICAgICB0ZXh0XzUyID0gdGV4dF81Mi5zdWJzdHJpbmcoMCwgdGV4dF81Myk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0XzU0ID0gdGV4dF81Mi5pbmRleE9mKCJiYXNlNjQsIikgKyA3OwogICAgICAgICAgICAgICAgaWYgKHRleHRfNTQgPiA2KSB7CiAgICAgICAgICAgICAgICAgIGxldCB0ZXh0XzU1ID0gdGV4dF81Mi5zdWJzdHJpbmcodGV4dF81NCk7CiAgICAgICAgICAgICAgICAgIHRleHRfNTUgPSB0ZXh0XzU1LnJlcGxhY2UoL1xzL2csICIiKTsKICAgICAgICAgICAgICAgICAgbGV0IGRhdGFfMzcgPSAiIjsKICAgICAgICAgICAgICAgICAgZm9yIChsZXQgY291bnRfMzcgPSAwOyBjb3VudF8zNyA8IHRleHRfNTUubGVuZ3RoOyBjb3VudF8zNysrKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcF8yODcgPSB0ZXh0XzU1W2NvdW50XzM3XTsKICAgICAgICAgICAgICAgICAgICBpZiAoL1tBLVphLXowLTkrXC89XS8udGVzdCh0ZW1wXzI4NykpIHsKICAgICAgICAgICAgICAgICAgICAgIGRhdGFfMzcgKz0gdGVtcF8yODc7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoZGF0YV8zNy5sZW5ndGggPiAxMDApIHsKICAgICAgICAgICAgICAgICAgICBkYXRhXzMzID0gImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwiICsgZGF0YV8zNzsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQ2FwdGNoYSBpbWFnZSBleHRyYWN0ZWQgZnJvbSBsaW5lIDIsIGJhc2U2NCBsZW5ndGg6IiwgZGF0YV8zNy5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJJbWFnZSBkYXRhIHByZXZpZXc6IiwgZGF0YV8zMy5zdWJzdHJpbmcoMCwgODApICsgIi4uLiIpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkV4dHJhY3RlZCBiYXNlNjQgaXMgdG9vIHNob3J0LCBsZW5ndGg6IiwgZGF0YV8zNy5sZW5ndGgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGVtcF8yODQgPj0gMCkgewogICAgICAgICAgICBjb25zdCB0ZXh0XzU2ID0gcmVzdWx0XzE4W3RlbXBfMjg0XS50cmltKCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJHZXQgU2xvdCBsaW5lIDEgZm91bmQgYXQgaW5kZXgiLCB0ZW1wXzI4NCk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgbGV0IHRleHRfNTcgPSB0ZXh0XzU2LnN1YnN0cmluZygyKS50cmltKCk7CiAgICAgICAgICAgICAgaWYgKHRlbXBfMjg0IDwgcmVzdWx0XzE4Lmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICAgIGxldCBjb3VudF8zOCA9ICh0ZXh0XzU3Lm1hdGNoKC9cey9nKSB8fCBbXSkubGVuZ3RoIC0gKHRleHRfNTcubWF0Y2goL1x9L2cpIHx8IFtdKS5sZW5ndGg7CiAgICAgICAgICAgICAgICBsZXQgY291bnRfMzkgPSB0ZW1wXzI4NCArIDE7CiAgICAgICAgICAgICAgICB3aGlsZSAoY291bnRfMzggPiAwICYmIGNvdW50XzM5IDwgcmVzdWx0XzE4Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wXzI4OCA9IHJlc3VsdF8xOFtjb3VudF8zOV0udHJpbSgpOwogICAgICAgICAgICAgICAgICBpZiAodGVtcF8yODgpIHsKICAgICAgICAgICAgICAgICAgICB0ZXh0XzU3ICs9IHRlbXBfMjg4OwogICAgICAgICAgICAgICAgICAgIGNvdW50XzM4ID0gKHRleHRfNTcubWF0Y2goL1x7L2cpIHx8IFtdKS5sZW5ndGggLSAodGV4dF81Ny5tYXRjaCgvXH0vZykgfHwgW10pLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBjb3VudF8zOSsrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0ZW1wXzI4MiA9IEpTT04ucGFyc2UodGV4dF81Nyk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkdldCBTbG90IHBhcnNlZCBsaW5lIDE6IiwgdGVtcF8yODIpOwogICAgICAgICAgICB9IGNhdGNoIChqc29uRGF0YV8yNzEpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIHBhcnNlIGxpbmUgMToiLCBqc29uRGF0YV8yNzEpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJKU09OIHN0cmluZyBsZW5ndGg6IiwganNvblN0cmluZyA_IGpzb25TdHJpbmcubGVuZ3RoIDogMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmICghdGVtcF8yODIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkpTT04gbm90IGZvdW5kIGluIGxpbmUgMSwgc2VhcmNoaW5nIGluIHJhdyByZXNwb25zZSIpOwogICAgICAgICAgICBsZXQgdGVtcF8yODkgPSByZXN1bHRfMTcubWF0Y2goLzE6XHMqKFx7W15dKlx9KS9zKTsKICAgICAgICAgICAgaWYgKCF0ZW1wXzI4OSkgewogICAgICAgICAgICAgIHRlbXBfMjg5ID0gcmVzdWx0XzE3Lm1hdGNoKC8oXHtbXl0qInN0YXR1cyJbXl0qInN1Y2Nlc3MiW15dKlx9KS9zKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXRlbXBfMjg5KSB7CiAgICAgICAgICAgICAgdGVtcF8yODkgPSByZXN1bHRfMTcubWF0Y2goLyhce1teXSoic2xvdF90aW1lcyJbXl0qXH0pL3MpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0ZW1wXzI4OSAmJiB0ZW1wXzI4OVsxXSkgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgY291bnRfNDAgPSB0ZW1wXzI4OVsxXS50cmltKCk7CiAgICAgICAgICAgICAgICBjb25zdCBjb3VudF80MSA9IChjb3VudF80MC5tYXRjaCgvXHsvZykgfHwgW10pLmxlbmd0aDsKICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50XzQyID0gKGNvdW50XzQwLm1hdGNoKC9cfS9nKSB8fCBbXSkubGVuZ3RoOwogICAgICAgICAgICAgICAgaWYgKGNvdW50XzQxID4gY291bnRfNDIpIHsKICAgICAgICAgICAgICAgICAgY291bnRfNDAgKz0gIn0iLnJlcGVhdChjb3VudF80MSAtIGNvdW50XzQyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRlbXBfMjgyID0gSlNPTi5wYXJzZShjb3VudF80MCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiR2V0IFNsb3QgcGFyc2VkIGZyb20gcmVnZXggbWF0Y2g6IiwgdGVtcF8yODIpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKGpzb25EYXRhXzI3MikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBwYXJzZSBmcm9tIHJlZ2V4IG1hdGNoOiIsIGpzb25EYXRhXzI3Mik7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQXR0ZW1wdGVkIEpTT04gc3RyaW5nOiIsIHRlbXBfMjg5WzFdLnN1YnN0cmluZygwLCA1MDApKTsKICAgICAgICAgICAgICAgIHRlbXBfMjgyID0gdmFyXzEzOChyZXN1bHRfMTcsIHsKICAgICAgICAgICAgICAgICAgcHJlZmVyU3RhdHVzT2JqZWN0OiB0cnVlLAogICAgICAgICAgICAgICAgICBsYWJlbDogIkdldCBTbG90IgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJObyBKU09OIHBhdHRlcm4gZm91bmQgaW4gcmF3IHJlc3BvbnNlIik7CiAgICAgICAgICAgICAgdGVtcF8yODIgPSB2YXJfMTM4KHJlc3VsdF8xNywgewogICAgICAgICAgICAgICAgcHJlZmVyU3RhdHVzT2JqZWN0OiB0cnVlLAogICAgICAgICAgICAgICAgbGFiZWw6ICJHZXQgU2xvdCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coIkdldCBTbG90IGZpbmFsIHBhcnNlZCBwYXlsb2FkOiIsIHRlbXBfMjgyKTsKICAgICAgICAgIGlmICghdGVtcF8yODIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIlVuYWJsZSB0byBwYXJzZSBnZXQgc2xvdCByZXNwb25zZSBwYXlsb2FkIik7CiAgICAgICAgICAgIGhpZGVMb2FkaW5nSW5kaWNhdG9yKCk7CiAgICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LWdldC1zbG90IiwgbnVsbCwgdGVtcF8yODEpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCBkYXRhXzM4ID0gdGVtcF8yODI_LmRhdGE_LnNsb3RfdGltZXMgJiYgQXJyYXkuaXNBcnJheSh0ZW1wXzI4Mi5kYXRhLnNsb3RfdGltZXMpICYmIHRlbXBfMjgyLmRhdGEuc2xvdF90aW1lcy5sZW5ndGggPiAwOwogICAgICAgICAgY29uc3QgZGF0YV8zOSA9IHRlbXBfMjgyPy5kYXRhICYmIEFycmF5LmlzQXJyYXkodGVtcF8yODIuZGF0YT8uc2xvdF9kYXRlcykgJiYgdGVtcF8yODIuZGF0YS5zbG90X2RhdGVzLmxlbmd0aCA-IDA7CiAgICAgICAgICBjb25zdCB0ZW1wXzI5MCA9IGRhdGFfMzggfHwgZGF0YV8zOTsKICAgICAgICAgIGlmICh0ZW1wXzI5MCkgewogICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5nZXRTbG90Q2FwdGNoYUltYWdlID0gbnVsbDsKICAgICAgICAgICAgbGV0IHRlbXBfMjkxID0gbnVsbDsKICAgICAgICAgICAgbGV0IGRhdGFfNDAgPSBudWxsOwogICAgICAgICAgICBpZiAodGVtcF8yODI_LmRhdGE_LmNhcHRjaGE_LmNhcHRjaGFfaWQpIHsKICAgICAgICAgICAgICBkYXRhXzQwID0gdGVtcF8yODIuZGF0YS5jYXB0Y2hhLmNhcHRjaGFfaWQ7CiAgICAgICAgICAgICAgbWF0aENhcHRjaGFXaWRnZXQgPSBkYXRhXzQwOwogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJjYXB0Y2hhX2lkIiwgZGF0YV80MCk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIkNhcHRjaGEgSUQgZXh0cmFjdGVkOiIsIGRhdGFfNDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChkYXRhXzMzKSB7CiAgICAgICAgICAgICAgdGVtcF8yOTEgPSBkYXRhXzMzOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJVc2luZyBjYXB0Y2hhIGltYWdlIGZyb20gbGluZSAyIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc3QgZGF0YV80MSA9IHRlbXBfMjgyPy5kYXRhPy5jYXB0Y2hhOwogICAgICAgICAgICAgIGlmIChkYXRhXzQxICYmIGRhdGFfNDEuY2FwdGNoYV9pbWFnZSAmJiBkYXRhXzQxLmNhcHRjaGFfaW1hZ2UgIT09ICIkMiIpIHsKICAgICAgICAgICAgICAgIHRlbXBfMjkxID0gZGF0YV80MS5jYXB0Y2hhX2ltYWdlIHx8ICIiOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodGVtcF8yOTEpIHsKICAgICAgICAgICAgICBsZXQgZGF0YV80MiA9IHRlbXBfMjkxOwogICAgICAgICAgICAgIGlmICh0ZW1wXzI5MS5zdGFydHNXaXRoKCJodHRwOi8vIikgfHwgdGVtcF8yOTEuc3RhcnRzV2l0aCgiaHR0cHM6Ly8iKSkgewogICAgICAgICAgICAgICAgZGF0YV80MiA9IHRlbXBfMjkxOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAodGVtcF8yOTEuc3RhcnRzV2l0aCgiZGF0YTppbWFnZS9wbmc7YmFzZTY0LCIpKSB7CiAgICAgICAgICAgICAgICBjb25zdCBkYXRhXzQzID0gdGVtcF8yOTEucmVwbGFjZSgiZGF0YTppbWFnZS9wbmc7YmFzZTY0LCIsICIiKTsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFfNDQgPSBkYXRhXzQzLnJlcGxhY2UoL1teQS1aYS16MC05K1wvPV0vZywgIiIpOwogICAgICAgICAgICAgICAgZGF0YV80MiA9ICJkYXRhOmltYWdlL3BuZztiYXNlNjQsIiArIGRhdGFfNDQ7CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZW1wXzI5MS5zdGFydHNXaXRoKCJkYXRhOmltYWdlIikpIHsKICAgICAgICAgICAgICAgIGRhdGFfNDIgPSB0ZW1wXzI5MTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc3QgZGF0YV80NSA9IHRlbXBfMjkxLnJlcGxhY2UoL1teQS1aYS16MC05K1wvPV0vZywgIiIpOwogICAgICAgICAgICAgICAgZGF0YV80MiA9ICJkYXRhOmltYWdlL3BuZztiYXNlNjQsIiArIGRhdGFfNDU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghZGF0YV80Mi5tYXRjaCgvXmRhdGE6aW1hZ2VcL1teO10rO2Jhc2U2NCxbQS1aYS16MC05K1wvXSs9KiQvKSkgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiSW52YWxpZCBkYXRhIFVSSSBmb3JtYXQsIGF0dGVtcHRpbmcgdG8gZml4Li4uIik7CiAgICAgICAgICAgICAgICBjb25zdCBkYXRhXzQ2ID0gZGF0YV80Mi5tYXRjaCgvYmFzZTY0LChbQS1aYS16MC05K1wvXSs9KikvKTsKICAgICAgICAgICAgICAgIGlmIChkYXRhXzQ2ICYmIGRhdGFfNDZbMV0pIHsKICAgICAgICAgICAgICAgICAgZGF0YV80MiA9ICJkYXRhOmltYWdlL3BuZztiYXNlNjQsIiArIGRhdGFfNDZbMV07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJDb3VsZCBub3QgZXh0cmFjdCB2YWxpZCBiYXNlNjQgZnJvbSBpbWFnZSBkYXRhIik7CiAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJGYWlsZWQgdG8gcGFyc2UgY2FwdGNoYSBpbWFnZSBkYXRhIiwgIiNmZjQ0NDQiKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb25zb2xlLmxvZygiTm9ybWFsaXplZCBpbWFnZSBsZW5ndGg6IiwgZGF0YV80Mi5sZW5ndGgpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJOb3JtYWxpemVkIGltYWdlIHByZXZpZXc6IiwgZGF0YV80Mi5zdWJzdHJpbmcoMCwgMTAwKSArICIuLi4iKTsKICAgICAgICAgICAgICBjYXB0Y2hhU3RhdGUuaW1hZ2VEYXRhID0gZGF0YV80MjsKICAgICAgICAgICAgICBhdXRvU2VxdWVuY2VTdGF0ZS5nZXRTbG90Q2FwdGNoYUltYWdlID0gZGF0YV80MjsKICAgICAgICAgICAgICBjYXB0Y2hhUHJvdmlkZXJDb25maWcucGF5LnRva2VuID0gIiI7CiAgICAgICAgICAgICAgY2FwdGNoYVByb3ZpZGVyQ29uZmlnLnBheS5lbmFibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgdGV4dENhcHRjaGFXaWRnZXQgPSBudWxsOwogICAgICAgICAgICAgIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICB2YXJfNTUoInBheSIpOwogICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTY3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNmLWJ0bi1wYXlub3ctcm93Iik7CiAgICAgICAgICAgICAgaWYgKGVsZW1lbnRfMTY3KSB7CiAgICAgICAgICAgICAgICBlbGVtZW50XzE2Ny50ZXh0Q29udGVudCA9ICJMb2FkIjsKICAgICAgICAgICAgICAgIGVsZW1lbnRfMTY3LnN0eWxlLmJhY2tncm91bmQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI0ZGRUIzQiwgI0ZGQzEwNykiOwogICAgICAgICAgICAgICAgZWxlbWVudF8xNjcuc3R5bGUuY29sb3IgPSAiIzMzMzMzMyI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB2YXJfMTI2KGRhdGFfNDIpOwogICAgICAgICAgICAgICAgdmFyXzEyMygpOwogICAgICAgICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkNhcHRjaGEgbG9hZGVkIGF1dG9tYXRpY2FsbHkgZnJvbSBHZXQgU2xvdCByZXNwb25zZSIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfR0VUX1NMT1QpIHsKICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xNjggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXBwb2ludG1lbnRfdGltZSIpOwogICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wXzI5MiA9IGVsZW1lbnRfMTY4ICYmIGVsZW1lbnRfMTY4LnZhbHVlICYmIGVsZW1lbnRfMTY4LnZhbHVlICE9PSAiIjsKICAgICAgICAgICAgICAgICAgaWYgKCF0ZW1wXzI5MikgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTY5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheS1jYXB0Y2hhLW1vZGFsIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRfMTY5KSB7CiAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50XzE2OS5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gY2F0Y2ggKHZhcl8yNzMpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGRpc3BsYXlpbmcgY2FwdGNoYSBpbWFnZToiLCB2YXJfMjczKTsKICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJGYWlsZWQgdG8gZGlzcGxheSBjYXB0Y2hhIGltYWdlIiwgIiNmZjQ0NDQiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRlbXBfMjgyPy5kYXRhICYmIHRlbXBfMjgyLmRhdGE_LnNsb3RfdGltZXMgJiYgQXJyYXkuaXNBcnJheSh0ZW1wXzI4Mi5kYXRhLnNsb3RfdGltZXMpICYmIHRlbXBfMjgyLmRhdGEuc2xvdF90aW1lcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xNzAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXBwb2ludG1lbnRfdGltZSIpOwogICAgICAgICAgICAgIGlmIChlbGVtZW50XzE3MCkgewogICAgICAgICAgICAgICAgZWxlbWVudF8xNzAuaW5uZXJIVE1MID0gIjxvcHRpb24gdmFsdWU9XCJcIj5UaW1lPC9vcHRpb24-IjsKICAgICAgICAgICAgICAgIGxldCB0ZXh0XzU4ID0gMDsKICAgICAgICAgICAgICAgIGxldCB0ZW1wXzI5MyA9IG51bGw7CiAgICAgICAgICAgICAgICB0ZW1wXzI4Mi5kYXRhLnNsb3RfdGltZXMuZm9yRWFjaChkYXRhXzQ3ID0-IHsKICAgICAgICAgICAgICAgICAgaWYgKGRhdGFfNDcuZGF0ZSA9PT0gdGVtcF8yODApIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50XzE3MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRfMTcxLnZhbHVlID0gZGF0YV80Ny5ob3VyOwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRfMTcxLnRleHRDb250ZW50ID0gZGF0YV80Ny50aW1lX2Rpc3BsYXk7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudF8xNzEuZGF0YXNldC5hdmFpbGFibGUgPSBkYXRhXzQ3LmF2YWlsYWJsZVNsb3Q7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudF8xNzAuYXBwZW5kQ2hpbGQoZWxlbWVudF8xNzEpOwogICAgICAgICAgICAgICAgICAgIHRleHRfNTggKz0gZGF0YV80Ny5hdmFpbGFibGVTbG90OwogICAgICAgICAgICAgICAgICAgIGlmICghdGVtcF8yOTMgJiYgZGF0YV80Ny5hdmFpbGFibGVTbG90ID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgdGVtcF8yOTMgPSBlbGVtZW50XzE3MTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xNzIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2xvdC1jb3VudC1kaXNwbGF5Iik7CiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudF8xNzIpIHsKICAgICAgICAgICAgICAgICAgaWYgKHRleHRfNTggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudF8xNzIudGV4dENvbnRlbnQgPSAiU2xvdHM6ICIgKyB0ZXh0XzU4OwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRfMTcyLnN0eWxlLmNvbG9yID0gIiMwMEZGMDAiOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRfMTcyLnRleHRDb250ZW50ID0gIlNsb3RzOiAwIjsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50XzE3Mi5zdHlsZS5jb2xvciA9ICIjRkYwMDAwIjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHRlbXBfMjkzKSB7CiAgICAgICAgICAgICAgICAgIHRlbXBfMjkzLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgdGVtcF8yOTMuY2xhc3NMaXN0LmFkZCgiYmxpbmtpbmctb3B0aW9uIik7CiAgICAgICAgICAgICAgICAgIGJnZENhcHRjaGFXaWRnZXQgPSB0ZW1wXzI5My52YWx1ZTsKICAgICAgICAgICAgICAgICAgaWYgKHRlbXBfMjkzLnZhbHVlID09PSAiMDkiKSB7CiAgICAgICAgICAgICAgICAgICAgcGF5Q2FwdGNoYVdpZGdldCA9ICIwOTowMCAtIDA5OjU5IjsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZW1wXzI5My52YWx1ZSA9PT0gIjEwIikgewogICAgICAgICAgICAgICAgICAgIHBheUNhcHRjaGFXaWRnZXQgPSAiMTA6MDAgLSAxMDo1OSI7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGVtcF8yOTMudmFsdWUgPT09ICIxMSIpIHsKICAgICAgICAgICAgICAgICAgICBwYXlDYXB0Y2hhV2lkZ2V0ID0gIjExOjAwIC0gMTE6NTkiOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHBheUNhcHRjaGFXaWRnZXQgPSAiMDk6MDAgLSAwOTo1OSI7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgZWxlbWVudF8xNzAuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoImNoYW5nZSIpKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkF1dG9tYXRpY2FsbHkgc2VsZWN0ZWQgZmlyc3QgYXZhaWxhYmxlIHRpbWUgc2xvdDoiLCB0ZW1wXzI5My50ZXh0Q29udGVudCk7CiAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFyXzE0MSA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgICAgIHZhcl8xNDEoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyXzg0KFs4ODAsIDE3NjAsIDg4MCwgMTc2MCwgODgwLCAxNzYwXSwgMC42KTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJUaW1lIFNsb3QgRm91bmQgU3VjY2Vzc2Z1bGx5Iik7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQXZhaWxhYmxlIFNsb3QgIiArIHRleHRfNTgpOwogICAgICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKHRlbXBfMjgyLCAiR2V0IFNsb3QiLCByZXN1bHRfMTcsICJUaW1lIFNsb3QgRm91bmQgU3VjY2Vzc2Z1bGx5IC0gQXZhaWxhYmxlIFNsb3QgIiArIHRleHRfNTgsICJHZXQgU2xvdCBGYWlsZWQiKTsKICAgICAgICAgICAgICAgIHZhcl82MigicGF5bm93Iik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJObyBUaW1lIFNsb3QgRm91bmQiKTsKICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTczID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNsb3QtY291bnQtZGlzcGxheSIpOwogICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRfMTczKSB7CiAgICAgICAgICAgICAgICAgIGVsZW1lbnRfMTczLnRleHRDb250ZW50ID0gIlNsb3RzOiAwIjsKICAgICAgICAgICAgICAgICAgZWxlbWVudF8xNzMuc3R5bGUuY29sb3IgPSAiI0ZGMDAwMCI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoYXV0b1NlcXVlbmNlU3RhdGUuZW5hYmxlZCAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfR0VUX1NMT1QpIHsKICAgICAgICAgICAgICAgICAgaWYgKGNhcHRjaGFTdGF0ZS5pbWFnZURhdGEpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50XzE3NCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktY2FwdGNoYS1tb2RhbCIpOwogICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50XzE3NCkgewogICAgICAgICAgICAgICAgICAgICAgZWxlbWVudF8xNzQuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIk5vIFRpbWUgU2xvdCBGb3VuZCIpOwogICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTc1ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNsb3QtY291bnQtZGlzcGxheSIpOwogICAgICAgICAgICAgIGlmIChlbGVtZW50XzE3NSkgewogICAgICAgICAgICAgICAgZWxlbWVudF8xNzUudGV4dENvbnRlbnQgPSAiU2xvdHM6IDAiOwogICAgICAgICAgICAgICAgZWxlbWVudF8xNzUuc3R5bGUuY29sb3IgPSAiI0ZGMDAwMCI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghZGF0YV8zOCAmJiBkYXRhXzM5KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIuKchSBHZXQgU2xvdCBTdWNjZXNzIC0gU2xvdHMgZm91bmQgYnV0IG5vIHRpbWUgc2xvdHMgYXZhaWxhYmxlIik7CiAgICAgICAgICAgICAgdXBkYXRlQnV0dG9uU3RhdHVzKHRlbXBfMjgyLCAiR2V0IFNsb3QiLCByZXN1bHRfMTcsICJTbG90cyBGb3VuZCAoTm8gVGltZSBTbG90cyBBdmFpbGFibGUpIiwgIkdldCBTbG90IEZhaWxlZCIpOwogICAgICAgICAgICAgIHZhcl84OShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZ2V0LXRpbWUtc2xvdC1idG4iKSk7CiAgICAgICAgICAgICAgdmFyXzgyKCk7CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNldEJ1dHRvblN0YXRlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnZXQtdGltZS1zbG90LWJ0biIpKSwgMzAwMCk7CiAgICAgICAgICAgICAgdmFyXzYyKCJwYXlub3ciKTsKICAgICAgICAgICAgICBpZiAoYXV0b1JldHJ5U3RhdGUuZW5hYmxlZCAmJiBhdXRvU2VxdWVuY2VTdGF0ZS5lbmFibGVkICYmIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID09PSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9HRVRfU0xPVCkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuKchSBBdXRvIE9OIGFuZCBBUyBPTiBlbmFibGVkIC0gQXV0byBjbGlja2luZyBTZXQgVGltZSBidXR0b24iKTsKICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBTbG90cyBmb3VuZCB3aXRob3V0IHRpbWUgc2xvdHMsIGF1dG8gY2xpY2tpbmcgU2V0IFRpbWUiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgYXV0b1NlcXVlbmNlU3RhdGUuY3VycmVudFN0ZXAgPSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9TRVRfVElNRTsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICBpZiAoaXNCdXR0b25FbmFibGVkKCJzZXQtdGltZS1idG4iKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgU2V0IFRpbWUgYnV0dG9uIGNsaWNrZWQgYXV0b21hdGljYWxseSIpOwogICAgICAgICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJBdXRvIFNlcXVlbmNlOiBTZXQgVGltZSBjbGlja2VkLCBvcGVuaW5nIGNhcHRjaGEgcG9wdXAiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xNzYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtbW9kYWwiKTsKICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50XzE3NikgewogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50XzE3Ni5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogU2V0IFRpbWUgc3VjY2VzcywgY2FwdGNoYSBwb3B1cCBvcGVuZWQsIHdhaXRpbmcgZm9yIG1hbnVhbCBzb2x2ZSIsICIjRkZENzAwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfQ0FQVENIQTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5lbmFibGVkICYmIGF1dG9TZXF1ZW5jZVN0YXRlLmN1cnJlbnRTdGVwID09PSBBVVRPX1NFUVVFTkNFX1NURVBTLlBBWV9HRVRfU0xPVCkgewogICAgICAgICAgICAgICAgaWYgKGNhcHRjaGFTdGF0ZS5pbWFnZURhdGEpIHsKICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xNzcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LWNhcHRjaGEtbW9kYWwiKTsKICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRfMTc3KSB7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudF8xNzcuc3R5bGUuZGlzcGxheSA9ICJmbGV4IjsKICAgICAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogU2xvdHMgZm91bmQgd2l0aG91dCB0aW1lIHNsb3RzLCBjYXB0Y2hhIHBvcHVwIG9wZW5lZCIsICIjRkZENzAwIik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinYwgR2V0IFNsb3Q6IEZBSUxVUkUgLSBzbG90X3RpbWVzIGFycmF5IG5vdCBmb3VuZCBvciBlbXB0eSwgYW5kIHNsb3RfZGF0ZXMgbm90IGZvdW5kIik7CiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTc4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdldC10aW1lLXNsb3QtYnRuIik7CiAgICAgICAgICAgIGhhbmRsZU9wZXJhdGlvbkZhaWx1cmUoInBheS1nZXQtc2xvdCIsIGVycm9yXzIzLnN0YXR1cywgdGVtcF8yODEsIHRlbXBfMjgyLCByZXN1bHRfMTcsIGVsZW1lbnRfMTc4LCAiR2V0IFNsb3QiKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChkYXRldGltZV8yNzQpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBUaW1lIFNsb3Qgbm90IGZvdW5kOiIsIGRhdGV0aW1lXzI3NCk7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE3OSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnZXQtdGltZS1zbG90LWJ0biIpOwogICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgicGF5LWdldC1zbG90IiwgbnVsbCwgdGVtcF8yODEsIG51bGwsICIiLCBlbGVtZW50XzE3OSwgIkdldCBTbG90Iik7CiAgICAgICAgICBoYW5kbGVBdXRvUmV0cnkoInBheS1nZXQtc2xvdCIsIG51bGwsIHRlbXBfMjgxLCB7CiAgICAgICAgICAgIGlzTmV0d29ya0Vycm9yOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZXZlbnRIYW5kbGVyXzE3OCgic2V0LXRpbWUtYnRuIiwgImNsaWNrIiwgKCkgPT4gewogICAgICAgIGNvbnN0IHRlbXBfMjk0ID0gInNldHRpbWUiOwogICAgICAgIHZhcl8yMzEodGVtcF8yOTQpOwogICAgICAgIHZhcl81NigpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTgwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwcG9pbnRtZW50X3RpbWUiKTsKICAgICAgICBlbGVtZW50XzE4MC5pbm5lckhUTUwgPSAiPG9wdGlvbiB2YWx1ZT1cIlwiPlRpbWU8L29wdGlvbj4iOwogICAgICAgIGNvbnN0IHRlbXBfMjk1ID0gW3sKICAgICAgICAgIHZhbHVlOiAiMDkiLAogICAgICAgICAgdGV4dDogIjA5OjAwLTA5OjU5IiwKICAgICAgICAgIGZvcm1hdHRlZDogIjA5OjAwIC0gMDk6NTkiCiAgICAgICAgfSwgewogICAgICAgICAgdmFsdWU6ICIxMCIsCiAgICAgICAgICB0ZXh0OiAiMTA6MDAtMTA6NTkiLAogICAgICAgICAgZm9ybWF0dGVkOiAiMTA6MDAgLSAxMDo1OSIKICAgICAgICB9LCB7CiAgICAgICAgICB2YWx1ZTogIjExIiwKICAgICAgICAgIHRleHQ6ICIxMTowMC0xMTo1OSIsCiAgICAgICAgICBmb3JtYXR0ZWQ6ICIxMTowMCAtIDExOjU5IgogICAgICAgIH1dOwogICAgICAgIHRlbXBfMjk1LmZvckVhY2goZGF0YV80OCA9PiB7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE4MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOwogICAgICAgICAgZWxlbWVudF8xODEudmFsdWUgPSBkYXRhXzQ4LnZhbHVlOwogICAgICAgICAgZWxlbWVudF8xODEudGV4dENvbnRlbnQgPSBkYXRhXzQ4LnRleHQ7CiAgICAgICAgICBlbGVtZW50XzE4MS5kYXRhc2V0LmZvcm1hdHRlZCA9IGRhdGFfNDguZm9ybWF0dGVkOwogICAgICAgICAgZWxlbWVudF8xODAuYXBwZW5kQ2hpbGQoZWxlbWVudF8xODEpOwogICAgICAgIH0pOwogICAgICAgIGlmIChlbGVtZW50XzE4MC5vcHRpb25zLmxlbmd0aCA-IDEpIHsKICAgICAgICAgIGVsZW1lbnRfMTgwLnNlbGVjdGVkSW5kZXggPSAxOwogICAgICAgICAgYmdkQ2FwdGNoYVdpZGdldCA9IGVsZW1lbnRfMTgwLm9wdGlvbnNbMV0udmFsdWU7CiAgICAgICAgICBwYXlDYXB0Y2hhV2lkZ2V0ID0gZWxlbWVudF8xODAub3B0aW9uc1sxXS5kYXRhc2V0LmZvcm1hdHRlZDsKICAgICAgICAgIGVsZW1lbnRfMTgwLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCJjaGFuZ2UiKSk7CiAgICAgICAgICBjb25zb2xlLmxvZygiVGltZSBzZXQgdG86ICIgKyBlbGVtZW50XzE4MC5vcHRpb25zWzFdLnRleHRDb250ZW50KTsKICAgICAgICAgIHZhcl8xNDEoKTsKICAgICAgICAgIHZhcl82Migic2V0dGltZSIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGV2ZW50SGFuZGxlcl8xNzgoImFwcG9pbnRtZW50X2RhdGUiLCAiaW5wdXQiLCB2YXJfMTQxKTsKICAgICAgZXZlbnRIYW5kbGVyXzE3OCgiYXBwb2ludG1lbnRfdGltZSIsICJjaGFuZ2UiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc3QgZWxlbWVudF8xODIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXBwb2ludG1lbnRfdGltZSIpOwogICAgICAgIGlmIChlbGVtZW50XzE4MiAmJiBlbGVtZW50XzE4Mi52YWx1ZSkgewogICAgICAgICAgYmdkQ2FwdGNoYVdpZGdldCA9IGVsZW1lbnRfMTgyLnZhbHVlOwogICAgICAgICAgcGF5Q2FwdGNoYVdpZGdldCA9IGVsZW1lbnRfMTgyLm9wdGlvbnNbZWxlbWVudF8xODIuc2VsZWN0ZWRJbmRleF0uZGF0YXNldC5mb3JtYXR0ZWQ7CiAgICAgICAgICBjb25zb2xlLmxvZygiVGltZSBjaGFuZ2VkIHRvOiAiICsgcGF5Q2FwdGNoYVdpZGdldCk7CiAgICAgICAgfQogICAgICAgIHZhcl8xNDEoKTsKICAgICAgfSk7CiAgICAgIGV2ZW50SGFuZGxlcl8xNzgoInBheS1ub3ciLCAiY2xpY2siLCBhc3luYyBmdW5jdGlvbiAocGFyYW1fMzIpIHsKICAgICAgICBjb25zdCBidXR0b25fMTcgPSAicGF5bm93YnV0dG9uIjsKICAgICAgICB2YXJfMjMxKGJ1dHRvbl8xNyk7CiAgICAgICAgY29uc3QgdGVtcF8yOTYgPSB0aGlzLmlkOwogICAgICAgIHZhcl81NigpOwogICAgICAgIGNvbnN0IHRlbXBfMjk3ID0gZWRpdGVkRW5kcG9pbnRzW3RlbXBfMjk2XTsKICAgICAgICBpZiAodGVtcF8yOTcpIHsKICAgICAgICAgIGV2ZW50SGFuZGxlcl8xMjIodGVtcF8yOTcpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBldmVudEhhbmRsZXJfMTIyKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgYXN5bmMgZnVuY3Rpb24gZXZlbnRIYW5kbGVyXzEyMihhc3luY1Jlc3VsdF8yNzUgPSBudWxsKSB7CiAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIlRyeSBUbyBHZW5lcmF0ZSBQYXltZW50IExpbmsiLCAiI0ZGRDcwMCIpOwogICAgICAgIHZhcl81NigpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTgzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwcG9pbnRtZW50X2RhdGUiKTsKICAgICAgICBjb25zdCBlbGVtZW50XzE4NCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHBvaW50bWVudF90aW1lIik7CiAgICAgICAgY29uc3QgZWxlbWVudF8xODUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFrZS1wYXltZW50LWJ0biIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTg2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvcHktcGF5bWVudC1saW5rLWJ0biIpOwogICAgICAgIGN1cnJlbnRDYXB0Y2hhVHlwZSA9IG51bGw7CiAgICAgICAgaWYgKGVsZW1lbnRfMTg1KSB7CiAgICAgICAgICBlbGVtZW50XzE4NS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIH0KICAgICAgICBpZiAoZWxlbWVudF8xODYpIHsKICAgICAgICAgIGVsZW1lbnRfMTg2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICBlbGVtZW50XzE4Ni5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICBlbGVtZW50XzE4Ni50ZXh0Q29udGVudCA9ICJDb3B5IExpbmsiOwogICAgICAgICAgZWxlbWVudF8xODYuZGF0YXNldC5jb3BpZWQgPSAiZmFsc2UiOwogICAgICAgIH0KICAgICAgICBpZiAoIWVsZW1lbnRfMTgzIHx8ICFlbGVtZW50XzE4NCkgewogICAgICAgICAgY29uc29sZS5sb2coIkRhdGUgb3IgdGltZSBpbnB1dCBub3QgZm91bmQiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgdGVtcF8yOTggPSBlbGVtZW50XzE4My52YWx1ZTsKICAgICAgICBjb25zdCB0ZW1wXzI5OSA9IGVsZW1lbnRfMTg0LnZhbHVlOwogICAgICAgIGlmICghdGVtcF8yOTggfHwgIXRlbXBfMjk5KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiQXBwb2ludG1lbnQgZGF0ZSBvciB0aW1lIHNsb3QgaXMgcmVxdWlyZWQiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgdGVtcF8zMDAgPSBwYXlDYXB0Y2hhV2lkZ2V0IHx8ICIwOTowMCAtIDA5OjU5IjsKICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiVHJ5aW5nLi4uIFRvIEdlbmVyYXRlIFNTTCBMaW5rIiwgIiNGRkE1MDAiKTsKICAgICAgICBjb25zdCB0ZW1wXzMwMSA9ICgpID0-IGV2ZW50SGFuZGxlcl8xMjIoYXN5bmNSZXN1bHRfMjc1KTsKICAgICAgICB0cnkgewogICAgICAgICAgdmFyXzEyOCgpOwogICAgICAgICAgY29uc3QgZGVsYXlfNTQgPSBhd2FpdCBhc3luY1Jlc3VsdF8xMjkoKTsKICAgICAgICAgIGNvbnN0IHVybF84ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpOwogICAgICAgICAgdXJsXzguYXBwZW5kKCIxX2FwcG9pbnRtZW50X2RhdGUiLCB0ZW1wXzI5OCk7CiAgICAgICAgICB1cmxfOC5hcHBlbmQoIjFfYXBwb2ludG1lbnRfdGltZSIsIHRlbXBfMzAwKTsKICAgICAgICAgIGlmIChjYXB0Y2hhUHJvdmlkZXJDb25maWcucGF5LnRva2VuKSB7CiAgICAgICAgICAgIHVybF84LmFwcGVuZCgiMV9rNXQwZzhfdG9rZW5feTR2OWY2IiwgY2FwdGNoYVByb3ZpZGVyQ29uZmlnLnBheS50b2tlbik7CiAgICAgICAgICB9CiAgICAgICAgICB1cmxfOC5hcHBlbmQoIjFfc2VsZWN0ZWRfcGF5bWVudFtuYW1lXSIsICJWSVNBIik7CiAgICAgICAgICB1cmxfOC5hcHBlbmQoIjFfc2VsZWN0ZWRfcGF5bWVudFtzbHVnXSIsICJ2aXNhY2FyZCIpOwogICAgICAgICAgdXJsXzguYXBwZW5kKCIxX3NlbGVjdGVkX3BheW1lbnRbbGlua10iLCAiaHR0cHM6Ly9zZWN1cmVwYXkuc3NsY29tbWVyei5jb20vZ3dwcm9jZXNzL3Y0L2ltYWdlL2d3MS92aXNhLnBuZyIpOwogICAgICAgICAgY29uc3QgdGV4dF81OSA9IFsiJEsxIiwgZGVsYXlfNTRdOwogICAgICAgICAgdXJsXzguYXBwZW5kKCIwIiwgSlNPTi5zdHJpbmdpZnkodGV4dF81OSkpOwogICAgICAgICAgY29uc29sZS5sb2coIlBheSBOb3cgcGF5bG9hZCBwcmVwYXJlZCIpOwogICAgICAgICAgY29uc29sZS5sb2coIkFwcG9pbnRtZW50IERhdGU6IiwgdGVtcF8yOTgpOwogICAgICAgICAgY29uc29sZS5sb2coIkFwcG9pbnRtZW50IFRpbWU6IiwgdGVtcF8zMDApOwogICAgICAgICAgY29uc29sZS5sb2coIkNhcHRjaGEgVG9rZW46IiwgY2FwdGNoYVByb3ZpZGVyQ29uZmlnLnBheS50b2tlbik7CiAgICAgICAgICBjb25zb2xlLmxvZygiQXJyYXkgUGF5bG9hZDoiLCB0ZXh0XzU5KTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJVUkxTZWFyY2hQYXJhbXM6IiwgdXJsXzgudG9TdHJpbmcoKSk7CiAgICAgICAgICBjb25zdCBkZWxheV81NSA9IGFzeW5jUmVzdWx0XzI3NSB8fCBkYXRldGltZV8xMzAoInBheU5vdyIpOwogICAgICAgICAgY29uc3QgaGVhZGVyc185ID0gewogICAgICAgICAgICAuLi5jcmVhdGVOZXh0QWN0aW9uSGVhZGVycyhuZXh0QWN0aW9uQ29uZmlnLnBheU5vd0luZm8pLAogICAgICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIKICAgICAgICAgIH07CiAgICAgICAgICBjb25zdCBlcnJvcl8yNCA9IGF3YWl0IGZldGNoKGRlbGF5XzU1LCB7CiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXzksCiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAiaW5jbHVkZSIsCiAgICAgICAgICAgIHJlZmVycmVyOiAiaHR0cHM6Ly9wYXltZW50Lml2YWNiZC5jb20vYXBwbGljYXRpb24iLAogICAgICAgICAgICByZWZlcnJlclBvbGljeTogInNhbWUtb3JpZ2luIiwKICAgICAgICAgICAgYm9keTogdXJsXzgudG9TdHJpbmcoKQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIWVycm9yXzI0Lm9rKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyAiICsgZXJyb3JfMjQuc3RhdHVzKTsKICAgICAgICAgICAgaGFuZGxlQXV0b1NlcXVlbmNlRXJyb3IoZXJyb3JfMjQuc3RhdHVzKTsKICAgICAgICAgICAgaWYgKGVycm9yXzI0LnN0YXR1cyA9PT0gNTAwIHx8IGVycm9yXzI0LnN0YXR1cyA9PT0gNTAyIHx8IGVycm9yXzI0LnN0YXR1cyA9PT0gNTA0KSB7CiAgICAgICAgICAgICAgaGlkZUxvYWRpbmdJbmRpY2F0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZWxlbWVudF8xODUpIHsKICAgICAgICAgICAgICBlbGVtZW50XzE4NS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlbGVtZW50XzE4NikgewogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgZWxlbWVudF8xODYuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LnRleHRDb250ZW50ID0gIkNvcHkgTGluayI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJwYXktbm93IiwgZXJyb3JfMjQuc3RhdHVzLCB0ZW1wXzMwMSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnN0IHJlc3VsdF8xOSA9IGF3YWl0IGVycm9yXzI0LnRleHQoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJQYXkgTm93IHJhdyByZXNwb25zZToiLCByZXN1bHRfMTkpOwogICAgICAgICAgY29uc3QgY291bnRfNDMgPSByZXN1bHRfMTkuc3BsaXQoL1xyP1xuLyk7CiAgICAgICAgICBsZXQgdGVtcF8zMDIgPSBudWxsOwogICAgICAgICAgaWYgKGNvdW50XzQzLmxlbmd0aCA-PSAyKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBfMzAzID0gY291bnRfNDNbMV0udHJpbSgpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiUGF5IE5vdyBsaW5lIDE6IiwgdGVtcF8zMDMpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGxldCB0ZW1wXzMwNCA9IHRlbXBfMzAzOwogICAgICAgICAgICAgIGNvbnN0IHRlbXBfMzA1ID0gdGVtcF8zMDMuaW5kZXhPZigiOiIpOwogICAgICAgICAgICAgIGlmICh0ZW1wXzMwNSA-IC0xKSB7CiAgICAgICAgICAgICAgICB0ZW1wXzMwNCA9IHRlbXBfMzAzLnNsaWNlKHRlbXBfMzA1ICsgMSkudHJpbSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB0ZW1wXzMwMiA9IEpTT04ucGFyc2UodGVtcF8zMDQpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJQYXkgTm93IHBhcnNlZCBsaW5lIDE6IiwgdGVtcF8zMDIpOwogICAgICAgICAgICB9IGNhdGNoIChqc29uRGF0YV8yNzYpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIHBhcnNlIGxpbmUgMToiLCBqc29uRGF0YV8yNzYpOwogICAgICAgICAgICAgIHRlbXBfMzAyID0gdmFyXzEzOChyZXN1bHRfMTksIHsKICAgICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICAgIGxhYmVsOiAiUGF5IE5vdyIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGVtcF8zMDIgPSB2YXJfMTM4KHJlc3VsdF8xOSwgewogICAgICAgICAgICAgIHByZWZlclN0YXR1c09iamVjdDogdHJ1ZSwKICAgICAgICAgICAgICBsYWJlbDogIlBheSBOb3ciCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coIlBheSBOb3cgZmluYWwgcGFyc2VkIHBheWxvYWQ6IiwgdGVtcF8zMDIpOwogICAgICAgICAgaWYgKCF0ZW1wXzMwMikgewogICAgICAgICAgICBjb25zb2xlLmxvZygiVW5hYmxlIHRvIHBhcnNlIHBheSBub3cgcmVzcG9uc2UgcGF5bG9hZCIpOwogICAgICAgICAgICBoaWRlTG9hZGluZ0luZGljYXRvcigpOwogICAgICAgICAgICBpZiAoZWxlbWVudF8xODUpIHsKICAgICAgICAgICAgICBlbGVtZW50XzE4NS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlbGVtZW50XzE4NikgewogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgZWxlbWVudF8xODYuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LnRleHRDb250ZW50ID0gIkNvcHkgTGluayI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaGFuZGxlQXV0b1JldHJ5KCJwYXktbm93IiwgbnVsbCwgdGVtcF8zMDEpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBjb25zdCB0ZW1wXzMwNiA9IG91dGNvbWVfMTM5KHRlbXBfMzAyLCByZXN1bHRfMTksICJTbG90IGJvb2tpbmcgaW5pdGlhdGVkIHN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgaWYgKHRlbXBfMzA2KSB7CiAgICAgICAgICAgIGN1cnJlbnRDYXB0Y2hhVHlwZSA9IHRlbXBfMzAyPy5kYXRhPy51cmwgfHwgdGVtcF8zMDI_LmRhdGE_LnBheW1lbnRfdXJsIHx8IHRlbXBfMzAyPy51cmwgfHwgdGVtcF8zMDI_LnBheW1lbnRfdXJsIHx8IG51bGw7CiAgICAgICAgICAgIGlmICghY3VycmVudENhcHRjaGFUeXBlICYmIHJlc3VsdF8xOSkgewogICAgICAgICAgICAgIGNvbnN0IHVybF85ID0gcmVzdWx0XzE5Lm1hdGNoKC8idXJsIlxzKjpccyoiKFteIl0rKSIvaSkgfHwgcmVzdWx0XzE5Lm1hdGNoKC91cmxbOlxzPV0rKFteXHMsfV0rKS9pKSB8fCByZXN1bHRfMTkubWF0Y2goL3BheW1lbnRbX1xzLV0_dXJsWzpccz1dKyhbXlxzLH1dKykvaSk7CiAgICAgICAgICAgICAgaWYgKHVybF85ICYmIHVybF85WzFdKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50Q2FwdGNoYVR5cGUgPSB1cmxfOVsxXS50cmltKCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiUGF5bWVudCBVUkwgZXh0cmFjdGVkIGZyb20gcmF3IHJlc3BvbnNlOiIsIGN1cnJlbnRDYXB0Y2hhVHlwZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJQYXkgTm93IHN1Y2Nlc3MgLSBQYXltZW50IFVSTDoiLCBjdXJyZW50Q2FwdGNoYVR5cGUpOwogICAgICAgICAgICB1cGRhdGVCdXR0b25TdGF0dXModGVtcF8zMDIsICJQYXkgTm93IiwgcmVzdWx0XzE5LCAiU2xvdCBib29raW5nIGluaXRpYXRlZCBzdWNjZXNzZnVsbHkuIiwgIlBheSBOb3cgRmFpbGVkIik7CiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTg3ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBheS1ub3ciKTsKICAgICAgICAgICAgaWYgKGVsZW1lbnRfMTg3KSB7CiAgICAgICAgICAgICAgZWxlbWVudF8xODcuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZWxlbWVudF8xODUpIHsKICAgICAgICAgICAgICBlbGVtZW50XzE4NS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgICAgICBlbGVtZW50XzE4NS5zdHlsZS5ib3JkZXIgPSAiMnB4IHNvbGlkICMzOUZGMTQiOwogICAgICAgICAgICAgIGVsZW1lbnRfMTg1LnN0eWxlLmJveFNoYWRvdyA9ICJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwIDAgMTVweCAjMzlGRjE0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgMCAyNXB4ICMzOUZGMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCAwIDM1cHggIzM5RkYxNCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNldCAwIDAgMTBweCByZ2JhKDU3LCAyNTUsIDIwLCAwLjUpXG4gICAgICAgICAgICAgICAgICAgICAgICAiOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLinIUgTWFrZSBQYXltZW50IGJ1dHRvbiBkaXNwbGF5ZWQiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIuKdjCBNYWtlIFBheW1lbnQgYnV0dG9uIG5vdCBmb3VuZCIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlbGVtZW50XzE4NikgewogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgZWxlbWVudF8xODYudGV4dENvbnRlbnQgPSAiQ29weSBMaW5rIjsKICAgICAgICAgICAgICBlbGVtZW50XzE4Ni5kYXRhc2V0LmNvcGllZCA9ICJmYWxzZSI7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coIuKchSBDb3B5IExpbmsgYnV0dG9uIGRpc3BsYXllZCIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUud2Fybigi4p2MIENvcHkgTGluayBidXR0b24gbm90IGZvdW5kIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc29sZS5sb2coIlBheW1lbnQgUHJvY2VzcyBTdGFydGVkIFN1Y2Nlc3NmdWxseSIpOwogICAgICAgICAgICBpZiAoY3VycmVudENhcHRjaGFUeXBlKSB7CiAgICAgICAgICAgICAgdmFyXzg0KFs0NDAsIDg4MCwgMTc2MCwgMzUyMF0sIDAuNSk7CiAgICAgICAgICAgICAgd2luZG93Lm9wZW4oY3VycmVudENhcHRjaGFUeXBlLCAiX2JsYW5rIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29uc29sZS53YXJuKCLimqDvuI8gUGF5bWVudCBVUkwgbm90IGZvdW5kIGluIHJlc3BvbnNlIC0gYnV0dG9ucyBzaG93biBidXQgVVJMIG1pc3NpbmciKTsKICAgICAgICAgICAgICB2YXJfODQoWzQ0MCwgODgwLCAxNzYwLCAzNTIwXSwgMC41KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkYXRldGltZV8xMTEoInBheS10aW1lci1kaXNwbGF5Iik7CiAgICAgICAgICAgIHZhcl82MigicGF5bm93YnV0dG9uIik7CiAgICAgICAgICAgIGlmIChhdXRvU2VxdWVuY2VTdGF0ZS5jdXJyZW50U3RlcCA9PT0gQVVUT19TRVFVRU5DRV9TVEVQUy5QQVlfTk9XIHx8IGNoZWNrQnV0dG9uVGV4dENvbnRhaW5zKCJwYXktbm93IiwgIlBhaWQiKSkgewogICAgICAgICAgICAgIGlmIChhdXRvUmV0cnlTdGF0ZS5lbmFibGVkKSB7CiAgICAgICAgICAgICAgICBzZXRBdXRvUmV0cnlFbmFibGVkKGZhbHNlLCAiUGF5IE5vdyBzdWNjZXNzIC0gQXV0byB0dXJuZWQgb2ZmIik7CiAgICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQXV0byBTZXF1ZW5jZTogUGF5IE5vdyBzdWNjZXNzIC0gQXV0byBidXR0b24gdHVybmVkIG9mZiIsICIjMDBGRjAwIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJlc2V0QXV0b1NlcXVlbmNlU3RhdGUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIuKdjCBQYXkgTm93OiBGQUlMVVJFIC0gc3BlY2lmaWMgc3VjY2VzcyBtZXNzYWdlIFwiU2xvdCBib29raW5nIGluaXRpYXRlZCBzdWNjZXNzZnVsbHlcIiBOT1QgZGV0ZWN0ZWQiKTsKICAgICAgICAgICAgY29uc3QgZWxlbWVudF8xODggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGF5LW5vdyIpOwogICAgICAgICAgICBpZiAoZWxlbWVudF8xODUpIHsKICAgICAgICAgICAgICBlbGVtZW50XzE4NS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlbGVtZW50XzE4NikgewogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgZWxlbWVudF8xODYuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgIGVsZW1lbnRfMTg2LnRleHRDb250ZW50ID0gIkNvcHkgTGluayI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaGFuZGxlT3BlcmF0aW9uRmFpbHVyZSgicGF5LW5vdyIsIGVycm9yXzI0LnN0YXR1cywgdGVtcF8zMDEsIHRlbXBfMzAyLCByZXN1bHRfMTksIGVsZW1lbnRfMTg4LCAiUGF5IE5vdyIpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKHZhcl8yNzcpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBQYXltZW50IFByb2Nlc3M6IiwgdmFyXzI3Nyk7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE4OSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktbm93Iik7CiAgICAgICAgICBpZiAoZWxlbWVudF8xODUpIHsKICAgICAgICAgICAgZWxlbWVudF8xODUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChlbGVtZW50XzE4NikgewogICAgICAgICAgICBlbGVtZW50XzE4Ni5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgICBlbGVtZW50XzE4Ni5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgIGVsZW1lbnRfMTg2LnRleHRDb250ZW50ID0gIkNvcHkgTGluayI7CiAgICAgICAgICB9CiAgICAgICAgICBoYW5kbGVPcGVyYXRpb25GYWlsdXJlKCJwYXktbm93IiwgbnVsbCwgdGVtcF8zMDEsIG51bGwsICIiLCBlbGVtZW50XzE4OSwgIlBheSBOb3ciKTsKICAgICAgICAgIGhhbmRsZUF1dG9SZXRyeSgicGF5LW5vdyIsIG51bGwsIHRlbXBfMzAxLCB7CiAgICAgICAgICAgIGlzTmV0d29ya0Vycm9yOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZXZlbnRIYW5kbGVyXzE3OCgibWFrZS1wYXltZW50LWJ0biIsICJjbGljayIsICgpID0-IHsKICAgICAgICBpZiAoY3VycmVudENhcHRjaGFUeXBlKSB7CiAgICAgICAgICBjb25zdCBlbGVtZW50XzE5MCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTsKICAgICAgICAgIGVsZW1lbnRfMTkwLmhyZWYgPSBjdXJyZW50Q2FwdGNoYVR5cGU7CiAgICAgICAgICBlbGVtZW50XzE5MC50YXJnZXQgPSAiX2JsYW5rIjsKICAgICAgICAgIGVsZW1lbnRfMTkwLnJlbCA9ICJub29wZW5lciBub3JlZmVycmVyIjsKICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudF8xOTApOwogICAgICAgICAgZWxlbWVudF8xOTAuY2xpY2soKTsKICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudF8xOTApOwogICAgICAgICAgY29uc29sZS5sb2coIk9wZW5pbmcgcGF5bWVudCBVUkwgaW4gbmV3IHRhYi4uLiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiTm8gcGF5bWVudCBVUkwgYXZhaWxhYmxlIik7CiAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiTm8gcGF5bWVudCBVUkwgYXZhaWxhYmxlIiwgIiNmZjQ0NDQiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBldmVudEhhbmRsZXJfMTc4KCJjb3B5LXBheW1lbnQtbGluay1idG4iLCAiY2xpY2siLCBhc3luYyAoKSA9PiB7CiAgICAgICAgaWYgKCFjdXJyZW50Q2FwdGNoYVR5cGUpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJObyBwYXltZW50IFVSTCBhdmFpbGFibGUgdG8gY29weSIpOwogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIk5vIHBheW1lbnQgVVJMIGF2YWlsYWJsZSB0byBjb3B5IiwgIiNmZjk4MDAiKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgZWxlbWVudF8xOTEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29weS1wYXltZW50LWxpbmstYnRuIik7CiAgICAgICAgY29uc3QgdGV4dF82MCA9IGVsZW1lbnRfMTkxID8gZWxlbWVudF8xOTEudGV4dENvbnRlbnQgOiAiQ29weSBMaW5rIjsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKG5hdmlnYXRvci5jbGlwYm9hcmQgJiYgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQpIHsKICAgICAgICAgICAgYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoY3VycmVudENhcHRjaGFUeXBlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRfMTkyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKTsKICAgICAgICAgICAgZWxlbWVudF8xOTIudmFsdWUgPSBjdXJyZW50Q2FwdGNoYVR5cGU7CiAgICAgICAgICAgIGVsZW1lbnRfMTkyLnN0eWxlLnBvc2l0aW9uID0gImZpeGVkIjsKICAgICAgICAgICAgZWxlbWVudF8xOTIuc3R5bGUub3BhY2l0eSA9ICIwIjsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50XzE5Mik7CiAgICAgICAgICAgIGVsZW1lbnRfMTkyLmZvY3VzKCk7CiAgICAgICAgICAgIGVsZW1lbnRfMTkyLnNlbGVjdCgpOwogICAgICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgiY29weSIpOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnRfMTkyKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChlbGVtZW50XzE5MSkgewogICAgICAgICAgICBlbGVtZW50XzE5MS50ZXh0Q29udGVudCA9ICJDb3BpZWQhIjsKICAgICAgICAgICAgZWxlbWVudF8xOTEuZGF0YXNldC5jb3BpZWQgPSAidHJ1ZSI7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIGlmIChlbGVtZW50XzE5MS5kYXRhc2V0LmNvcGllZCA9PT0gInRydWUiKSB7CiAgICAgICAgICAgICAgICBlbGVtZW50XzE5MS50ZXh0Q29udGVudCA9IHRleHRfNjA7CiAgICAgICAgICAgICAgICBlbGVtZW50XzE5MS5kYXRhc2V0LmNvcGllZCA9ICJmYWxzZSI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJQYXltZW50IGxpbmsgY29waWVkIHRvIGNsaXBib2FyZCIsICIjMDBGRjAwIik7CiAgICAgICAgICBjb25zb2xlLmxvZygiUGF5bWVudCBsaW5rIGNvcGllZCB0byBjbGlwYm9hcmQiKTsKICAgICAgICB9IGNhdGNoIChvdXRjb21lXzI3OCkgewogICAgICAgICAgY29uc29sZS5lcnJvcigiRmFpbGVkIHRvIGNvcHkgcGF5bWVudCBsaW5rIiwgb3V0Y29tZV8yNzgpOwogICAgICAgICAgaWYgKGVsZW1lbnRfMTkxKSB7CiAgICAgICAgICAgIGVsZW1lbnRfMTkxLnRleHRDb250ZW50ID0gdGV4dF82MDsKICAgICAgICAgICAgZWxlbWVudF8xOTEuZGF0YXNldC5jb3BpZWQgPSAiZmFsc2UiOwogICAgICAgICAgfQogICAgICAgICAgc2hvd1N0YXR1c01lc3NhZ2UoIkZhaWxlZCB0byBjb3B5IGxpbmsuIFBsZWFzZSBjb3B5IG1hbnVhbGx5LiIsICIjZmY5ODAwIik7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgZnVuY3Rpb24gdmFyXzE0MSgpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzE5MyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXktbm93Iik7CiAgICAgICAgY29uc3QgZWxlbWVudF8xOTQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXBwb2ludG1lbnRfZGF0ZSIpOwogICAgICAgIGNvbnN0IGVsZW1lbnRfMTk1ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwcG9pbnRtZW50X3RpbWUiKTsKICAgICAgICBjb25zdCBlbGVtZW50XzE5NiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYWtlLXBheW1lbnQtYnRuIik7CiAgICAgICAgY29uc3QgZWxlbWVudF8xOTcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29weS1wYXltZW50LWxpbmstYnRuIik7CiAgICAgICAgY29uc3QgdGVtcF8zMDcgPSBlbGVtZW50XzE5NCAmJiBlbGVtZW50XzE5NC52YWx1ZS50cmltKCkgIT09ICIiOwogICAgICAgIGNvbnN0IHRlbXBfMzA4ID0gZWxlbWVudF8xOTUgJiYgZWxlbWVudF8xOTUudmFsdWUgIT09ICIiOwogICAgICAgIGNvbnN0IHRlbXBfMzA5ID0gISFjdXJyZW50Q2FwdGNoYVR5cGU7CiAgICAgICAgaWYgKHRlbXBfMzA5KSB7CiAgICAgICAgICBpZiAoZWxlbWVudF8xOTMpIHsKICAgICAgICAgICAgZWxlbWVudF8xOTMuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGVsZW1lbnRfMTkzKSB7CiAgICAgICAgICBlbGVtZW50XzE5My5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgIGlmICh0ZW1wXzMwNyAmJiB0ZW1wXzMwOCkgewogICAgICAgICAgICBlbGVtZW50XzE5My5zdHlsZS5iYWNrZ3JvdW5kID0gImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNGRjE0OTMsICNGRjY5QjQpIjsKICAgICAgICAgICAgZWxlbWVudF8xOTMudGV4dENvbnRlbnQgPSAiUGF5IE5vdyAoVklTQSkiOwogICAgICAgICAgICBlbGVtZW50XzE5My5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZWxlbWVudF8xOTMuc3R5bGUuYmFja2dyb3VuZCA9ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjODA4MDgwLCAjQTlBOUE5KSI7CiAgICAgICAgICAgIGVsZW1lbnRfMTkzLnRleHRDb250ZW50ID0gIlBheSBOb3cgKFZJU0EpIjsKICAgICAgICAgICAgZWxlbWVudF8xOTMuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoZWxlbWVudF8xOTYpIHsKICAgICAgICAgIGVsZW1lbnRfMTk2LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgfQogICAgICAgIGlmIChlbGVtZW50XzE5NykgewogICAgICAgICAgZWxlbWVudF8xOTcuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgIGVsZW1lbnRfMTk3LmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgIGVsZW1lbnRfMTk3LnRleHRDb250ZW50ID0gIkNvcHkgTGluayI7CiAgICAgICAgICBlbGVtZW50XzE5Ny5kYXRhc2V0LmNvcGllZCA9ICJmYWxzZSI7CiAgICAgICAgfQogICAgICAgIGN1cnJlbnRDYXB0Y2hhVHlwZSA9IG51bGw7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzI3OSh2YXJfMjgwLCBodG1sQ29udGVudF8yODEpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzE5OCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHZhcl8yODApOwogICAgICAgIGlmIChlbGVtZW50XzE5OCkgewogICAgICAgICAgZWxlbWVudF8xOTguc3R5bGUuYmFja2dyb3VuZCA9ICJsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjRkY0MDgxLCAjRjUwMDU3KSI7CiAgICAgICAgICBlbGVtZW50XzE5OC5zdHlsZS5jb2xvciA9ICIjMDAwMDAwIjsKICAgICAgICAgIGVsZW1lbnRfMTk4LnN0eWxlLmJveFNoYWRvdyA9ICIwIDAgMTBweCAjRkY0MDgxIjsKICAgICAgICAgIGVsZW1lbnRfMTk4LnRleHRDb250ZW50ID0gaHRtbENvbnRlbnRfMjgxOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMjM1KHZhcl8yODIsIGh0bWxDb250ZW50XzI4MywgY29sb3JWYWx1ZV8yODQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzIxOTZGMywgIzAzQTlGNCkiKSB7CiAgICAgICAgY29uc3QgZWxlbWVudF8xOTkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2YXJfMjgyKTsKICAgICAgICBpZiAoZWxlbWVudF8xOTkpIHsKICAgICAgICAgIGVsZW1lbnRfMTk5LnN0eWxlLmJhY2tncm91bmQgPSBjb2xvclZhbHVlXzI4NDsKICAgICAgICAgIGVsZW1lbnRfMTk5LnN0eWxlLmNvbG9yID0gIiNmZmZmZmYiOwogICAgICAgICAgZWxlbWVudF8xOTkuc3R5bGUuYm94U2hhZG93ID0gIiI7CiAgICAgICAgICBlbGVtZW50XzE5OS50ZXh0Q29udGVudCA9IGh0bWxDb250ZW50XzI4MzsKICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzE3NygpIHsKICAgICAgICBjb25zb2xlLmxvZygiQWJvcnRpbmcgYWxsIHBlbmRpbmcgcmVxdWVzdHMuLi4iKTsKICAgICAgICBwZW5kaW5nT3BlcmF0aW9ucy5mb3JFYWNoKGl0ZW1fMTEgPT4gewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaXRlbV8xMS5hYm9ydCgpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiQWJvcnRlZCBwZW5kaW5nIHJlcXVlc3QiKTsKICAgICAgICAgIH0gY2F0Y2ggKHZhcl8yODUpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgYWJvcnRpbmcgcmVxdWVzdDoiLCB2YXJfMjg1KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBwZW5kaW5nT3BlcmF0aW9ucyA9IFtdOwogICAgICAgIGNvbnNvbGUubG9nKCJBbGwgcGVuZGluZyByZXF1ZXN0cyBhYm9ydGVkIik7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzI4NigpIHsKICAgICAgICB2YXJfMTc3KCk7CiAgICAgICAgY2xlYXJBbGxBdXRvUmV0cnlUaW1lcnMoKTsKICAgICAgICBpZiAocmVmcmVzaFRpbWVycy5jb250aW51ZVRpbWVvdXQpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChyZWZyZXNoVGltZXJzLmNvbnRpbnVlVGltZW91dCk7CiAgICAgICAgICByZWZyZXNoVGltZXJzLmNvbnRpbnVlVGltZW91dCA9IG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChyZWZyZXNoVGltZXJzLnJlZnJlc2hJbnRlcnZhbCkgewogICAgICAgICAgY2xlYXJJbnRlcnZhbChyZWZyZXNoVGltZXJzLnJlZnJlc2hJbnRlcnZhbCk7CiAgICAgICAgICByZWZyZXNoVGltZXJzLnJlZnJlc2hJbnRlcnZhbCA9IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZ1bmN0aW9uIHNob3dTdGF0dXNNZXNzYWdlKGh0bWxDb250ZW50XzI4NywgY29sb3JWYWx1ZV8yODggPSAiI2ZmZmZmZiIpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzIwMCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdGF0dXMtcGFuZWwiKTsKICAgICAgICBpZiAoZWxlbWVudF8yMDApIHsKICAgICAgICAgIGVsZW1lbnRfMjAwLnRleHRDb250ZW50ID0gaHRtbENvbnRlbnRfMjg3OwogICAgICAgICAgZWxlbWVudF8yMDAuc3R5bGUuY29sb3IgPSBjb2xvclZhbHVlXzI4ODsKICAgICAgICAgIGVsZW1lbnRfMjAwLnN0eWxlLmZvbnRTaXplID0gIjEycHgiOwogICAgICAgICAgZWxlbWVudF8yMDAuc3R5bGUuZm9udFdlaWdodCA9ICJib2xkIjsKICAgICAgICAgIGVsZW1lbnRfMjAwLnN0eWxlLnRleHRTaGFkb3cgPSAiMCAwIDVweCByZ2JhKDAsMCwwLDAuNSkiOwogICAgICAgIH0KICAgICAgfQogICAgICBmdW5jdGlvbiB2YXJfMTQwKCkgewogICAgICAgIFsibG9naW4iLCAiYmdkIiwgInBheSJdLmZvckVhY2goaXRlbV8xMiA9PiB7CiAgICAgICAgICB2YXJfNTUoaXRlbV8xMik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gdmFyXzE2NygpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzIwMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjZnAtYnRuLXBheW5vdy1yb3ciKTsKICAgICAgICBpZiAoZWxlbWVudF8yMDEpIHsKICAgICAgICAgIGlmIChjYXB0Y2hhUHJvdmlkZXJDb25maWcucGF5LmVuYWJsZWQgJiYgY2FwdGNoYVByb3ZpZGVyQ29uZmlnLnBheS50b2tlbikgewogICAgICAgICAgICBlbGVtZW50XzIwMS5zdHlsZS5iYWNrZ3JvdW5kID0gImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNGRjk4MDAsICNGRjU3MjIpIjsKICAgICAgICAgICAgZWxlbWVudF8yMDEuc3R5bGUuYm9yZGVyID0gIjJweCBzb2xpZCAjMzlGRjE0IjsKICAgICAgICAgICAgZWxlbWVudF8yMDEuc3R5bGUuYm94U2hhZG93ID0gIlxuICAgICAgICAgICAgICAgICAgICAgICAgMCAwIDEwcHggIzM5RkYxNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIDAgMCAyMHB4ICMzOUZGMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICAwIDAgMzBweCAjMzlGRjE0LFxuICAgICAgICAgICAgICAgICAgICAgICAgMCAwIDQwcHggIzM5RkYxNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc2V0IDAgMCAxMHB4IHJnYmEoNTcsIDI1NSwgMjAsIDAuNSlcbiAgICAgICAgICAgICAgICAgICAgIjsKICAgICAgICAgIH0gZWxzZSBpZiAoY2FwdGNoYVByb3ZpZGVyQ29uZmlnLnBheS5lbmFibGVkKSB7CiAgICAgICAgICAgIGVsZW1lbnRfMjAxLnN0eWxlLmJhY2tncm91bmQgPSAibGluZWFyLWdyYWRpZW50KDEzNWRlZywgI0ZGOTgwMCwgI0ZGNTcyMikiOwogICAgICAgICAgICBlbGVtZW50XzIwMS5zdHlsZS5ib3JkZXIgPSAiMnB4IHNvbGlkICNGRjk4MDAiOwogICAgICAgICAgICBlbGVtZW50XzIwMS5zdHlsZS5ib3hTaGFkb3cgPSAiMCAwIDE1cHggI0ZGOTgwMCwgMCAwIDI1cHggI0ZGOTgwMCI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlbGVtZW50XzIwMS5zdHlsZS5iYWNrZ3JvdW5kID0gImxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMyMTk2RjMsICMwM0E5RjQpIjsKICAgICAgICAgICAgZWxlbWVudF8yMDEuc3R5bGUuYm9yZGVyID0gIm5vbmUiOwogICAgICAgICAgICBlbGVtZW50XzIwMS5zdHlsZS5ib3hTaGFkb3cgPSAiIjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZXZlbnRIYW5kbGVyXzExNygpIHsKICAgICAgICBjb25zdCB0ZW1wXzMxMCA9IHsKICAgICAgICAgIGhpZ2hjb206IGhpZ2hjb20sCiAgICAgICAgICBpdmFjX2lkOiBpdmFjX2lkLAogICAgICAgICAgdmlzYV90eXBlOiB2aXNhX3R5cGUsCiAgICAgICAgICB2aXNpdF9wdXJwb3NlOiB2aXNpdF9wdXJwb3NlLAogICAgICAgICAgd2ViZmlsZV9pZDogd2ViZmlsZV9pZCwKICAgICAgICAgIGZhbWlseV9jb3VudDogZmFtaWx5X2NvdW50LAogICAgICAgICAgZmFtaWx5RGF0YTogZmFtaWx5RGF0YQogICAgICAgIH07CiAgICAgICAgY29uc3QgdGV4dF82MSA9IHRlbXBfMzEwOwogICAgICAgIGNvbnN0IGRhdGFfNDkgPSBKU09OLnN0cmluZ2lmeSh0ZXh0XzYxLCBudWxsLCAyKTsKICAgICAgICBjb25zdCBkYXRhXzUwID0gImRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04LCIgKyBlbmNvZGVVUklDb21wb25lbnQoZGF0YV80OSk7CiAgICAgICAgY29uc3QgY29uZmlnXzYgPSAiaXZhY19jb25maWcuanNvbiI7CiAgICAgICAgY29uc3QgZWxlbWVudF8yMDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgZWxlbWVudF8yMDIuc2V0QXR0cmlidXRlKCJocmVmIiwgZGF0YV81MCk7CiAgICAgICAgZWxlbWVudF8yMDIuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsIGNvbmZpZ182KTsKICAgICAgICBlbGVtZW50XzIwMi5jbGljaygpOwogICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJDb25maWd1cmF0aW9uIGV4cG9ydGVkIHN1Y2Nlc3NmdWxseSIsICIjMDBGRjAwIik7CiAgICAgIH0KICAgICAgZnVuY3Rpb24gZXZlbnRIYW5kbGVyXzExNigpIHsKICAgICAgICBjb25zdCBlbGVtZW50XzIwMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgICAgZWxlbWVudF8yMDMudHlwZSA9ICJmaWxlIjsKICAgICAgICBlbGVtZW50XzIwMy5hY2NlcHQgPSAiLmpzb24iOwogICAgICAgIGVsZW1lbnRfMjAzLm9uY2hhbmdlID0gZWxlbWVudF8yMDQgPT4gewogICAgICAgICAgY29uc3QgdGV4dF82MiA9IGVsZW1lbnRfMjA0LnRhcmdldC5maWxlc1swXTsKICAgICAgICAgIGNvbnN0IHRleHRfNjMgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgICAgdGV4dF82My5yZWFkQXNUZXh0KHRleHRfNjIsICJVVEYtOCIpOwogICAgICAgICAgdGV4dF82My5vbmxvYWQgPSByZXNwb25zZV8xID0-IHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBjb25zdCByZXN1bHRfMjAgPSByZXNwb25zZV8xLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgICAgY29uc3QgdGVtcF8zMTEgPSBKU09OLnBhcnNlKHJlc3VsdF8yMCk7CiAgICAgICAgICAgICAgaGlnaGNvbSA9IHRlbXBfMzExLmhpZ2hjb20gfHwgaGlnaGNvbTsKICAgICAgICAgICAgICBpdmFjX2lkID0gdGVtcF8zMTEuaXZhY19pZCB8fCBpdmFjX2lkOwogICAgICAgICAgICAgIHZpc2FfdHlwZSA9IHRlbXBfMzExLnZpc2FfdHlwZSB8fCB2aXNhX3R5cGU7CiAgICAgICAgICAgICAgdmlzaXRfcHVycG9zZSA9IHRlbXBfMzExLnZpc2l0X3B1cnBvc2UgfHwgdmlzaXRfcHVycG9zZTsKICAgICAgICAgICAgICB3ZWJmaWxlX2lkID0gdGVtcF8zMTEud2ViZmlsZV9pZCB8fCB3ZWJmaWxlX2lkOwogICAgICAgICAgICAgIGZhbWlseV9jb3VudCA9IHRlbXBfMzExLmZhbWlseV9jb3VudCB8fCBmYW1pbHlfY291bnQ7CiAgICAgICAgICAgICAgZmFtaWx5RGF0YSA9IHRlbXBfMzExLmZhbWlseURhdGEgfHwgZmFtaWx5RGF0YTsKICAgICAgICAgICAgICBwYXlsb2FkRGF0YS5hcHAuaGlnaGNvbSA9IGhpZ2hjb207CiAgICAgICAgICAgICAgcGF5bG9hZERhdGEuYXBwLml2YWNfaWQgPSBpdmFjX2lkOwogICAgICAgICAgICAgIHBheWxvYWREYXRhLmFwcC52aXNhX3R5cGUgPSB2aXNhX3R5cGU7CiAgICAgICAgICAgICAgcGF5bG9hZERhdGEuYXBwLnZpc2l0X3B1cnBvc2UgPSB2aXNpdF9wdXJwb3NlOwogICAgICAgICAgICAgIHBheWxvYWREYXRhLmFwcC53ZWJmaWxlX2lkID0gd2ViZmlsZV9pZDsKICAgICAgICAgICAgICBwYXlsb2FkRGF0YS5hcHAuZmFtaWx5X2NvdW50ID0gZmFtaWx5X2NvdW50OwogICAgICAgICAgICAgIHBheWxvYWREYXRhLmFwcC53ZWJmaWxlX2lkX3JlcGVhdCA9IHdlYmZpbGVfaWQ7CiAgICAgICAgICAgICAgY29uc3QgZGF0YV81MSA9IFtdOwogICAgICAgICAgICAgIGZvciAobGV0IGRhdGFfNTIgPSAwOyBkYXRhXzUyIDwgZmFtaWx5X2NvdW50OyBkYXRhXzUyKyspIHsKICAgICAgICAgICAgICAgIGlmIChkYXRhXzUyIDwgZmFtaWx5RGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgY29uc3QgdGVtcF8zMTIgPSB7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogZmFtaWx5RGF0YVtkYXRhXzUyXS5uYW1lLAogICAgICAgICAgICAgICAgICAgIHdlYmZpbGVfbm86IGZhbWlseURhdGFbZGF0YV81Ml0ud2ViZmlsZV9ubywKICAgICAgICAgICAgICAgICAgICBhZ2Fpbl93ZWJmaWxlX25vOiBmYW1pbHlEYXRhW2RhdGFfNTJdLndlYmZpbGVfbm8KICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgZGF0YV81MS5wdXNoKHRlbXBfMzEyKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGRhdGFfNTEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogIiIsCiAgICAgICAgICAgICAgICAgICAgd2ViZmlsZV9ubzogIiIsCiAgICAgICAgICAgICAgICAgICAgYWdhaW5fd2ViZmlsZV9ubzogIiIKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHBheWxvYWREYXRhLnBlcnNvbmFsLmZhbWlseSA9IGRhdGFfNTE7CiAgICAgICAgICAgICAgY29uc3QgY29uZmlnXzcgPSB7CiAgICAgICAgICAgICAgICBoaWdoY29tOiBoaWdoY29tLAogICAgICAgICAgICAgICAgaXZhY19pZDogaXZhY19pZCwKICAgICAgICAgICAgICAgIHZpc2FfdHlwZTogdmlzYV90eXBlLAogICAgICAgICAgICAgICAgdmlzaXRfcHVycG9zZTogdmlzaXRfcHVycG9zZSwKICAgICAgICAgICAgICAgIHdlYmZpbGVfaWQ6IHdlYmZpbGVfaWQsCiAgICAgICAgICAgICAgICBmYW1pbHlfY291bnQ6IGZhbWlseV9jb3VudCwKICAgICAgICAgICAgICAgIGZhbWlseURhdGE6IGZhbWlseURhdGEKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJpdmFjX3VzZXJfY29uZmlnIiwgSlNPTi5zdHJpbmdpZnkoY29uZmlnXzcpKTsKICAgICAgICAgICAgICBzaG93U3RhdHVzTWVzc2FnZSgiQ29uZmlndXJhdGlvbiBpbXBvcnRlZCBzdWNjZXNzZnVsbHkiLCAiIzAwRkYwMCIpOwogICAgICAgICAgICB9IGNhdGNoIChtZXNzYWdlXzI4OSkgewogICAgICAgICAgICAgIHNob3dTdGF0dXNNZXNzYWdlKCJFcnJvciBpbXBvcnRpbmcgY29uZmlndXJhdGlvbjogIiArIG1lc3NhZ2VfMjg5Lm1lc3NhZ2UsICIjZmY0NDQ0Iik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfTsKICAgICAgICBlbGVtZW50XzIwMy5jbGljaygpOwogICAgICB9CiAgICAgIHZhcl83MygpOwogICAgICB0aW1lcl8xMSA9IHNldEludGVydmFsKHRpbWVyQ2FsbGJhY2tfMTYxLCAyMDAwKTsKICAgICAgY29uc29sZS5sb2coIldpZGdldCBpbml0aWFsaXplZC4gQ0FQVENIQSB2ZXJpZmljYXRpb24gd2lsbCBzdGFydCB3aGVuIG5lZWRlZC4iKTsKICAgIH07CiAgICBpbml0aWFsaXplV2lkZ2V0KCk7CiAgfTsKICAvLyBEaXJlY3QgZXhlY3V0aW9uIHdpdGhvdXQgYXV0aG9yaXphdGlvbgogIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAibG9hZGluZyIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBmdW5jdGlvbiAoKSB7CiAgICAgIG1haW5TY3JpcHQoKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBtYWluU2NyaXB0KCk7CiAgfQp9KSgpOwo',
    
    // Authorized device fingerprints (add fingerprints here)
    // ‚ö†Ô∏è IMPORTANT: Remove '*' and add specific fingerprints for production!
    AUTHORIZED_DEVICES: [
      '5C17D8738F61DE7B7CB9A2710CFEE465'
      // Get fingerprint using DEVICE_INFO_COLLECTOR.js
      // Example: 'A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6'
      '*' // ‚ö†Ô∏è REMOVE THIS LINE FOR PRODUCTION - currently allows all devices
    ],
    
    // Multi-instance permission (fingerprints that can run multiple)
    MULTI_INSTANCE_ALLOWED: [
      // Add fingerprints here that can run multiple instances
    ],
    
    // Instance tracking key
    INSTANCE_KEY: 'FALCON_PRO_INSTANCE_' + Date.now().toString(36),
    
    // Version
    VERSION: '2.0.0'
  };

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // üîí SECURITY FUNCTIONS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

  // Generate device fingerprint
  async function generateFingerprint() {
    const components = [];
    
    components.push(screen.width + 'x' + screen.height);
    components.push(screen.colorDepth);
    components.push(window.devicePixelRatio || 1);
    components.push(Intl.DateTimeFormat().resolvedOptions().timeZone);
    components.push(new Date().getTimezoneOffset());
    components.push(navigator.language);
    components.push(navigator.platform);
    components.push(navigator.hardwareConcurrency || 0);
    
    try {
      const canvas = document.createElement('canvas');
      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
      if (gl) {
        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
        if (debugInfo) {
          components.push(gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL));
        }
      }
    } catch (e) {}
    
    const fingerString = components.join('|||');
    const encoder = new TextEncoder();
    const data = encoder.encode(fingerString);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    
    return hashHex.substring(0, 32).toUpperCase();
  }

  // Check if device is authorized
  function isDeviceAuthorized(fingerprint) {
    if (CONFIG.AUTHORIZED_DEVICES.includes('*')) return true;
    return CONFIG.AUTHORIZED_DEVICES.includes(fingerprint);
  }

  // Check if multi-instance is allowed
  function isMultiInstanceAllowed(fingerprint) {
    return CONFIG.MULTI_INSTANCE_ALLOWED.includes(fingerprint) || 
           CONFIG.MULTI_INSTANCE_ALLOWED.includes('*');
  }

  // Check if another instance is running
  function isInstanceRunning() {
    const instanceKeys = Object.keys(localStorage).filter(k => k.startsWith('FALCON_INSTANCE_'));
    const now = Date.now();
    
    for (const key of instanceKeys) {
      try {
        const data = JSON.parse(localStorage.getItem(key));
        // Instance is considered active if heartbeat within 5 seconds
        if (now - data.heartbeat < 5000) {
          return true;
        } else {
          // Clean up stale instance
          localStorage.removeItem(key);
        }
      } catch (e) {
        localStorage.removeItem(key);
      }
    }
    return false;
  }

  // Register this instance
  function registerInstance(fingerprint) {
    const instanceId = 'FALCON_INSTANCE_' + Math.random().toString(36).substr(2, 9);
    const instanceData = {
      fingerprint: fingerprint,
      startTime: Date.now(),
      heartbeat: Date.now(),
      tabId: Math.random().toString(36).substr(2, 9)
    };
    
    localStorage.setItem(instanceId, JSON.stringify(instanceData));
    
    // Heartbeat to keep instance alive
    const heartbeatInterval = setInterval(() => {
      try {
        instanceData.heartbeat = Date.now();
        localStorage.setItem(instanceId, JSON.stringify(instanceData));
      } catch (e) {
        clearInterval(heartbeatInterval);
      }
    }, 2000);
    
    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      localStorage.removeItem(instanceId);
      clearInterval(heartbeatInterval);
    });
    
    return instanceId;
  }

  // Decode source URL
  function decodeSource(encoded) {
    try {
      return atob(encoded);
    } catch (e) {
      return null;
    }
  }

  // Clean console traces
  function cleanTraces() {
    // Override console methods temporarily
    const originalLog = console.log;
    const originalWarn = console.warn;
    const originalError = console.error;
    
    // Clear any existing logs
    if (typeof console.clear === 'function') {
      console.clear();
    }
    
    return { originalLog, originalWarn, originalError };
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // üé® UI FUNCTIONS
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

  function showMessage(message, type = 'info') {
    const colors = {
      info: '#3b82f6',
      success: '#22c55e',
      error: '#ef4444',
      warning: '#f59e0b'
    };
    
    const icons = {
      info: '‚ÑπÔ∏è',
      success: '‚úÖ',
      error: '‚ùå',
      warning: '‚ö†Ô∏è'
    };
    
    const style = `
      background: linear-gradient(135deg, ${colors[type]}, ${colors[type]}99);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      font-family: system-ui;
      font-size: 14px;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 999999;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      animation: fadeInDown 0.3s ease;
    `;
    
    const div = document.createElement('div');
    div.innerHTML = `<span style="margin-right: 8px;">${icons[type]}</span>${message}`;
    div.style.cssText = style;
    div.id = 'falcon-loader-message';
    
    // Add animation
    const styleSheet = document.createElement('style');
    styleSheet.textContent = `
      @keyframes fadeInDown {
        from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        to { opacity: 1; transform: translateX(-50%) translateY(0); }
      }
    `;
    document.head.appendChild(styleSheet);
    
    const existing = document.getElementById('falcon-loader-message');
    if (existing) existing.remove();
    
    document.body.appendChild(div);
    
    if (type !== 'error') {
      setTimeout(() => div.remove(), 3000);
    }
    
    return div;
  }

  function showLoadingUI() {
    const html = `
      <div id="falcon-loader-ui" style="
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(13, 17, 23, 0.95);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 999999;
        font-family: system-ui;
      ">
        <div style="text-align: center;">
          <div style="
            font-size: 60px;
            margin-bottom: 20px;
            animation: pulse 1s infinite;
          ">ü¶Ö</div>
          <div style="
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(135deg, #58a6ff, #1f6feb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
          ">FALCON PRO</div>
          <div style="
            color: #8b949e;
            font-size: 14px;
            margin-bottom: 25px;
          " id="loader-status">Initializing secure connection...</div>
          <div style="
            width: 200px;
            height: 4px;
            background: #30363d;
            border-radius: 2px;
            overflow: hidden;
            margin: 0 auto;
          ">
            <div id="loader-progress" style="
              width: 0%;
              height: 100%;
              background: linear-gradient(90deg, #58a6ff, #1f6feb);
              border-radius: 2px;
              transition: width 0.3s ease;
            "></div>
          </div>
        </div>
      </div>
      <style>
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.1); }
        }
      </style>
    `;
    
    const container = document.createElement('div');
    container.innerHTML = html;
    document.body.appendChild(container.firstElementChild);
  }

  function updateProgress(percent, status) {
    const progress = document.getElementById('loader-progress');
    const statusEl = document.getElementById('loader-status');
    if (progress) progress.style.width = percent + '%';
    if (statusEl) statusEl.textContent = status;
  }

  function hideLoadingUI() {
    const ui = document.getElementById('falcon-loader-ui');
    if (ui) {
      ui.style.opacity = '0';
      ui.style.transition = 'opacity 0.3s ease';
      setTimeout(() => ui.remove(), 300);
    }
  }

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // üöÄ MAIN LOADER LOGIC
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

  try {
    // Show loading UI
    showLoadingUI();
    updateProgress(10, 'Generating device fingerprint...');
    
    // Generate fingerprint
    const fingerprint = await generateFingerprint();
    updateProgress(25, 'Verifying device authorization...');
    
    // Check authorization
    if (!isDeviceAuthorized(fingerprint)) {
      hideLoadingUI();
      showMessage(`Device not authorized. Fingerprint: ${fingerprint}`, 'error');
      console.log('%cüîí FALCON PRO - Unauthorized Device', 'color: #ef4444; font-size: 16px; font-weight: bold;');
      console.log('%cYour Fingerprint: ' + fingerprint, 'color: #f59e0b; font-size: 14px;');
      console.log('%cContact admin to get authorization.', 'color: #8b949e;');
      return;
    }
    
    updateProgress(40, 'Checking for existing instances...');
    
    // Check for existing instance (unless multi-instance allowed)
    if (!isMultiInstanceAllowed(fingerprint) && isInstanceRunning()) {
      hideLoadingUI();
      showMessage('Another instance is already running on this device!', 'warning');
      console.log('%c‚ö†Ô∏è FALCON PRO - Instance Already Running', 'color: #f59e0b; font-size: 16px; font-weight: bold;');
      console.log('%cOnly one instance per device is allowed.', 'color: #8b949e;');
      return;
    }
    
    // Register this instance
    const instanceId = registerInstance(fingerprint);
    updateProgress(55, 'Establishing secure connection...');
    
    // Decode and fetch main script
    const sourceUrl = decodeSource(CONFIG.SOURCE_KEY);
    
    if (!sourceUrl || sourceUrl.includes('YOUR_USERNAME')) {
      // If no GitHub URL configured, try to load local script
      updateProgress(70, 'Loading local script...');
      
      // Check if main script is already defined
      if (typeof mainScript === 'function') {
        updateProgress(100, 'Starting FALCON PRO...');
        hideLoadingUI();
        mainScript();
        return;
      }
      
      hideLoadingUI();
      showMessage('Script source not configured. Contact admin.', 'error');
      return;
    }
    
    updateProgress(70, 'Downloading secure payload...');
    
    // Fetch script with cleaned traces
    const consoleFns = cleanTraces();
    
    const response = await fetch(sourceUrl, {
      method: 'GET',
      cache: 'no-store',
      headers: {
        'Accept': 'text/plain'
      }
    });
    
    if (!response.ok) {
      throw new Error('Failed to fetch script');
    }
    
    const scriptContent = await response.text();
    updateProgress(90, 'Initializing system...');
    
    // Execute script in isolated scope
    const executeScript = new Function(scriptContent);
    
    updateProgress(100, 'Starting FALCON PRO...');
    
    // Small delay to show 100%
    await new Promise(r => setTimeout(r, 500));
    
    hideLoadingUI();
    
    // Execute
    executeScript();
    
    // Restore console
    console.log = consoleFns.originalLog;
    console.warn = consoleFns.originalWarn;
    console.error = consoleFns.originalError;
    
    // Clean success message
    console.clear();
    console.log('%cü¶Ö FALCON PRO v' + CONFIG.VERSION, 'font-size: 20px; font-weight: bold; color: #58a6ff;');
    console.log('%cSecure session established', 'color: #22c55e;');
    
  } catch (error) {
    hideLoadingUI();
    showMessage('Failed to load: ' + error.message, 'error');
    console.error('FALCON PRO Loader Error:', error);
  }
  
})();
